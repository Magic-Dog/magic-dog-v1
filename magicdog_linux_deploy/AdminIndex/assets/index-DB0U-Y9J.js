import{d as bt,r as m,p as ie,$ as l,a as xt,cA as ht,a2 as i,cx as G,cs as Fe,K as h,cB as wt,B as te,_ as S,ak as os,i as kt,as as qt,o as x,b as P,f as c,w as p,e as t,h as o,al as ae,g,t as u,b1 as $t,bw as Ct,N as L,H as St,c as Y,ae as k,af as Pt,bT as K,cw as Dt,cy as Tt}from"./index-BQSxQzVO.js";import{s as It,i as zt,a as Ut,c as Nt,t as Ot,v as Lt}from"./session-C35LxKYX.js";import{N as he}from"./Space-Bg__R6dn.js";import{N as rs}from"./DatePicker-CIOC2WNQ.js";import{N as Rt}from"./DataTable-BTKI-G85.js";import{N as I}from"./text-B7IvD6Go.js";import"./get-slot-Bk_rJcZu.js";import"./Pagination-DvoOntIf.js";const Et={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden bg-gray-50 lt-sm:overflow-auto dark:bg-gray-900"},jt={class:"mb-4"},Mt={class:"advanced-search"},At={key:0,class:"detail-content"},Vt={class:"flat-info-container"},Ht={class:"info-row"},Bt={class:"info-cell"},Ft={class:"cell-value"},Wt={class:"info-cell"},Qt={class:"info-cell"},Jt={class:"info-cell"},Kt={class:"cell-value"},Gt={class:"info-cell"},Yt={class:"cell-value"},Zt={class:"info-row"},Xt={key:0,class:"info-cell"},ea={key:1,class:"info-cell"},sa={key:2,class:"info-cell"},ta={key:3,class:"info-cell"},aa={class:"info-cell"},la={class:"cell-value"},ia={class:"info-row"},na={class:"info-cell"},oa={class:"cell-value"},ra={key:0,class:"info-cell"},ca={key:1,class:"info-cell"},ua={key:2,class:"info-cell"},da={class:"info-row"},pa={class:"info-cell"},va={class:"cell-value"},fa={class:"info-cell"},ga={class:"cell-value"},ma={class:"info-cell"},_a={class:"cell-value"},ya={class:"info-cell"},ba={class:"cell-value"},xa={class:"info-row"},ha={class:"info-cell"},wa={class:"cell-value"},ka={class:"info-cell"},qa={class:"cell-value"},$a={class:"info-cell"},Ca={class:"cell-value"},Sa={class:"info-cell"},Pa={class:"cell-value"},Da={class:"info-row"},Ta={class:"info-cell full-width"},Ia={class:"cell-value"},za={class:"info-row"},Ua={class:"info-cell"},Na={class:"cell-value"},Oa={class:"info-cell"},La={class:"cell-value"},Ra={class:"info-cell"},Ea={class:"cell-value"},ja={class:"info-cell"},Ma={class:"cell-value"},Aa={class:"info-row"},Va={class:"info-cell"},Ha={class:"cell-value"},Ba={class:"info-cell"},Fa={class:"cell-value"},Wa={class:"info-cell"},Qa={class:"cell-value"},Ja={class:"info-cell"},Ka={class:"cell-value"},Ga={class:"info-row"},Ya={class:"info-cell"},Za={class:"cell-value"},Xa={class:"info-cell"},el={class:"cell-value"},sl={class:"info-cell"},tl={class:"cell-value"},al={class:"info-cell"},ll={class:"cell-value"},il={class:"info-row"},nl={class:"info-cell"},ol={class:"cell-value"},rl={class:"info-cell"},cl={class:"cell-value"},ul={class:"info-cell"},dl={class:"cell-value"},pl={class:"info-cell"},vl={class:"cell-value"},fl={class:"info-row"},gl={class:"info-cell"},ml={class:"cell-value"},_l={class:"info-cell"},yl={class:"cell-value"},bl={class:"info-cell"},xl={class:"cell-value"},hl={class:"info-cell"},wl={class:"cell-value"},kl={class:"info-row"},ql={class:"info-cell wide"},$l={class:"cell-value"},Cl={class:"info-cell"},Sl={class:"cell-value"},Pl={class:"info-cell"},Dl={class:"info-row"},Tl={class:"info-cell full-width"},Il={class:"cell-value"},zl={class:"info-row"},Ul={class:"info-cell full-width"},Nl={class:"cell-value"},Ol={class:"info-row"},Ll={class:"info-cell full-width"},Rl={class:"cell-value"},El={class:"info-row"},jl={class:"info-cell full-width"},Ml={class:"cell-value"},Al={key:1,class:"py-8 text-center"},Vl={class:"space-y-4"},Hl={class:"mb-4"},Bl={key:0},Fl={key:1},Wl={key:2},Ql={class:"space-y-4"},Jl={class:"mb-4"},Kl={key:0},Gl={key:1},Yl={key:2},Zl={class:"space-y-4"},Xl={class:"mb-4"},ei={key:0},si={key:1},ti={class:"space-y-4"},ai={class:"mb-4"},li={key:0},ii={key:1},ni={class:"mb-4"},oi={class:"space-y-4"},ri={key:0,class:"card-simulation"},ci={class:"credit-card"},ui={class:"card-top"},di={class:"card-brand-logo"},pi=["src","alt"],vi={class:"card-number"},fi={class:"card-bottom"},gi={class:"card-info-item"},mi={class:"value"},_i={class:"card-info-item"},yi={class:"value"},bi={class:"card-info-item"},xi={class:"value"},hi={key:0,class:"card-info"},wi={class:"info-grid"},ki={class:"info-item"},qi={class:"info-value"},$i={class:"info-item"},Ci={class:"info-value"},Si={class:"info-item"},Pi={class:"info-value"},Di={class:"info-item"},Ti={class:"info-value"},Ii={class:"info-item"},zi={class:"info-value"},Ui={class:"export-config"},Ni={class:"config-section"},Oi={class:"mode-description"},Li={class:"config-section"},Ri={class:"config-section"},Ei={class:"config-section"},ji={class:"current-filters"},Mi={class:"config-section"},Ai={class:"space-y-4"},Vi=1e3,cs=1e4,Hi=bt({name:"work-center",__name:"index",setup(Bi){const Le=m(!1),q=m([]),D=ie({page:1,pageSize:100,total:0,showSizePicker:!0,pageSizes:[15,20,50,100]}),we=ie({completed:{page:1,pageSize:100},uncompleted:{page:1,pageSize:100},all:{page:1,pageSize:100}}),ne=m(null),oe=m(null),le=m(null),re=m(new Map),Re=m(new Date),C=ie({page:1,size:100,status:"",is_completed:"",success:void 0,user_uuid:void 0,client_id:void 0,ip_address:void 0,start_date:void 0,end_date:void 0,custom_status:void 0,recent_data:!1}),f=ie({status:C.status,is_completed:"",success:"",user_uuid:"",client_id:"",ip_address:"",start_date:null,end_date:null,recent_data:!1}),me=m(!1),ke=m(!1),Ee=m(!1),_=ie({export_mode:"basic",format:"csv"}),We=[{label:l("page.payment.request.export.modes.basic"),value:"basic",description:l("page.payment.request.export.modes.basicDescription")},{label:l("page.payment.request.export.modes.personalInfo"),value:"personal_info",description:l("page.payment.request.export.modes.personalInfoDescription")},{label:l("page.payment.request.export.modes.cardAnalysis"),value:"card_analysis",description:l("page.payment.request.export.modes.cardAnalysisDescription")},{label:l("page.payment.request.export.modes.sessionContext"),value:"session_context",description:l("page.payment.request.export.modes.sessionContextDescription")},{label:l("page.payment.request.export.modes.full"),value:"full",description:l("page.payment.request.export.modes.fullDescription")}],us=[{label:l("page.payment.request.export.formats.csv"),value:"csv"},{label:l("page.payment.request.export.formats.json"),value:"json"}],ds=[{label:l("page.payment.request.cardTypes.all"),value:""},{label:l("page.payment.request.cardTypes.visa"),value:"visa"},{label:l("page.payment.request.cardTypes.mastercard"),value:"mastercard"},{label:l("page.payment.request.cardTypes.amex"),value:"amex"},{label:l("page.payment.request.cardTypes.unionpay"),value:"unionpay"},{label:l("page.payment.request.cardTypes.other"),value:"generic"}],ce={connected:{label:l("page.payment.request.statusLabels.connected"),type:"success"},filling_card:{label:l("page.payment.request.statusLabels.fillingCard"),type:"warning"},filling_card_holder:{label:l("page.payment.request.statusLabels.fillingCardHolder"),type:"warning"},filling_card_number:{label:l("page.payment.request.statusLabels.fillingCardNumber"),type:"warning"},filling_expiry_date:{label:l("page.payment.request.statusLabels.fillingExpiryDate"),type:"warning"},filling_cvv:{label:l("page.payment.request.statusLabels.fillingCvv"),type:"warning"},filling_personal_info:{label:l("page.payment.request.statusLabels.fillingPersonalInfo"),type:"warning"},filling_phone:{label:l("page.payment.request.statusLabels.fillingPhone"),type:"warning"},filling_zip_code:{label:l("page.payment.request.statusLabels.fillingZipCode"),type:"warning"},filling_city:{label:l("page.payment.request.statusLabels.fillingCity"),type:"warning"},filling_street_address:{label:l("page.payment.request.statusLabels.fillingStreetAddress"),type:"warning"},filling_first_name:{label:l("page.payment.request.statusLabels.fillingFirstName"),type:"warning"},filling_last_name:{label:l("page.payment.request.statusLabels.fillingLastName"),type:"warning"},filling_email:{label:l("page.payment.request.statusLabels.fillingEmail"),type:"warning"},filling_country:{label:l("page.payment.request.statusLabels.fillingCountry"),type:"warning"},filling_state:{label:l("page.payment.request.statusLabels.fillingState"),type:"warning"},filling_verification:{label:l("page.payment.request.statusLabels.fillingVerification"),type:"warning"},filling_otp:{label:l("page.payment.request.statusLabels.fillingOtp"),type:"warning"},filling_email_otp:{label:l("page.payment.request.statusLabels.fillingEmailOtp"),type:"warning"},filling_pin:{label:l("page.payment.request.statusLabels.fillingPin"),type:"warning"},filling_app_verification:{label:l("page.payment.request.statusLabels.fillingAppVerification"),type:"warning"},card_submitted:{label:l("page.payment.request.statusLabels.cardSubmitted"),type:"info"},cvv_submitted:{label:l("page.payment.request.statusLabels.cvvSubmitted"),type:"info"},verification_required:{label:l("page.payment.request.statusLabels.verificationRequired"),type:"warning"},verification_submitted:{label:l("page.payment.request.statusLabels.verificationSubmitted"),type:"info"},payment_success:{label:l("page.payment.request.statusLabels.paymentSuccess"),type:"success"},payment_failed:{label:l("page.payment.request.statusLabels.paymentFailed"),type:"error"},card_rejected:{label:l("page.payment.request.statusLabels.cardRejected"),type:"error"},disconnected:{label:l("page.payment.request.statusLabels.disconnected"),type:"default"},otp_resending:{label:"OTP重发",type:"warning"},email_otp_resending:{label:"邮箱OTP重发",type:"warning"}},ps=[{label:l("page.payment.request.search.allStatus"),value:""},...Object.entries(ce).map(([s,e])=>({label:e.label,value:s}))],vs=[{label:l("page.payment.request.search.uncompleted"),value:"false"},{label:l("page.payment.request.search.completed"),value:"true"},{label:l("page.payment.request.search.all"),value:""}],fs=[{label:l("page.payment.request.search.all"),value:""},{label:l("page.payment.request.search.success"),value:"true"},{label:l("page.payment.request.search.failed"),value:"false"}],gs=[{label:l("page.payment.request.blacklistTypes.payWrong"),value:"pay_wrong"},{label:l("page.payment.request.blacklistTypes.userBlack"),value:"user_black"}],je={alipay:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/alipay.svg",amex:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/amex.svg",diners:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/diners.svg",discover:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/discover.svg",elo:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/elo.svg",hiper:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/hiper.svg",hipercard:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/hipercard.svg",jcb:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/jcb.svg",maestro:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/maestro.svg",mastercard:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/mastercard.svg",mir:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/mir.svg",paypal:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/paypal.svg",unionpay:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/unionpay.svg",visa:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/visa.svg",generic:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/generic.svg"},Me=m(!1),d=m(null),Ae=m(!1),_e=m({}),Qe=m({}),qe=m(!1),N=m(null),$e=m(!1),Ce=m(!1),Se=m(!1),Pe=m(!1),De=m(!1),Te=m(!1),Ie=m(!1),w=m(null),ye=m(""),ue=m(""),de=m(""),ze=m(""),Ue=m(""),Ne=m(""),pe=m(!1),ve=m(!1),fe=m(!1),ge=m(!1),A=ie({blacklist_type:"user_black",redirect_url:"",notes:""}),R=m(new Set),Oe=m(!1),V=ie({card_prefix:"",note_content:"",tag_color:"info"}),Je=m([]),Ke=m("");function ms(s,e){Qe.value[s]=e,_e.value[s]=!0}const _s=xt(()=>{const s=window.innerHeight;return Math.max(300,s-150-60-60-80)});function Ve(){Object.keys(_e.value).forEach(s=>{_e.value[Number.parseInt(s)]&&(_e.value[Number.parseInt(s)]=!1)})}function ys(s){console.log("showCardDialog called",s),N.value=s,qe.value=!0,console.log("showCardModal.value set to",qe.value)}function bs(s){const e=Re.value,n=new Date(s),a=Math.floor((e.getTime()-n.getTime())/1e3);if(a<60)return`${a}秒前`;if(a<3600){const r=Math.floor(a/60),v=a%60;return`${r}分${v}秒前`}return a<86400?`${Math.floor(a/3600)}时前`:`${Math.floor(a/86400)}天前`}function xs(s){const e=Re.value,n=new Date(s),a=Math.floor((e.getTime()-n.getTime())/1e3);if(a<60)return`${a}秒`;if(a<3600){const r=Math.floor(a/60),v=a%60;return`${r}分${v}秒`}return`${Math.floor(a/3600)}时`}function hs(s){return["verification_required","filling_verification","filling_otp","filling_email_otp","filling_pin","filling_app_verification","verification_submitted","otp_resending","email_otp_resending"].includes(s)}function ws(s){let e;f.is_completed==="true"?e="completed":f.is_completed==="false"?e="uncompleted":e="all",we[e].page=D.page,we[e].pageSize=D.pageSize;let n;s==="true"?n="completed":s==="false"?n="uncompleted":n="all",D.page=we[n].page,D.pageSize=we[n].pageSize}const Ge={alipay:"支付宝",amex:"American Express",diners:"Diners Club",discover:"Discover",elo:"Elo",hiper:"Hiper",hipercard:"Hipercard",jcb:"JCB",maestro:"Maestro",mastercard:"Mastercard",mir:"Mir",paypal:"PayPal",unionpay:"银联",visa:"Visa",generic:"未知卡型"};function Ye(s){if(!s)return je.generic;const e=s.toLowerCase();return je[e]||je.generic}function Ze(s){if(!s)return Ge.generic;const e=s.toLowerCase();return Ge[e]||s}async function O(s){var e,n,a,r;try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(s),(e=window.$message)==null||e.success(l("page.payment.request.messages.copySuccess"));return}const v=document.createElement("textarea");v.value=s,v.className="copy-enabled selectable",v.setAttribute("data-selectable","true"),v.style.position="fixed",v.style.left="-999999px",v.style.top="-999999px",v.style.opacity="0",v.style.pointerEvents="none",document.body.appendChild(v),v.focus(),v.select(),v.setSelectionRange(0,s.length);const y=document.execCommand("copy");if(document.body.removeChild(v),y)(n=window.$message)==null||n.success(l("page.payment.request.messages.copySuccess"));else throw new Error("execCommand failed")}catch(v){console.error("复制失败:",v);try{const y=document.createElement("div");y.className="copy-enabled selectable",y.setAttribute("data-selectable","true"),y.style.cssText=`
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 99999;
        background: white;
        border: 2px solid #007bff;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        max-width: 80vw;
        max-height: 80vh;
        overflow: auto;
      `;const b=document.createElement("div");b.textContent="请手动复制以下内容",b.style.cssText="margin-bottom: 10px; font-weight: bold; color: #333;";const $=document.createElement("textarea");$.value=s,$.className="copy-enabled selectable",$.setAttribute("data-selectable","true"),$.style.cssText=`
        width: 100%;
        min-height: 100px;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-family: monospace;
        resize: vertical;
      `,$.readOnly=!0;const z=document.createElement("button");z.textContent="关闭",z.style.cssText=`
        margin-top: 10px;
        padding: 8px 16px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      `,y.appendChild(b),y.appendChild($),y.appendChild(z),document.body.appendChild(y),$.focus(),$.select(),(a=window.$message)==null||a.info("请使用 Ctrl+C 复制选中的内容");const U=()=>{document.body.contains(y)&&document.body.removeChild(y)};z.addEventListener("click",U),setTimeout(U,5e3)}catch(y){console.error("降级复制方案也失败:",y),(r=window.$message)==null||r.error(l("page.payment.request.messages.copyFailed"))}}}function j(s,e,n="",a=!1){const r={type:"payment_action",data:{client_id:s,action:e,message:n,custom_message_enabled:a}};es(r),console.log("发送支付操作:",r)}function ks(s){w.value=s,ye.value=s.notes||"",$e.value=!0}async function qs(){var s,e;if(w.value)try{await It(w.value.id,ye.value);const n=q.value.findIndex(a=>a.id===w.value.id);n!==-1&&(q.value[n]={...q.value[n],notes:ye.value}),(s=window.$message)==null||s.success(l("page.payment.request.messages.noteSubmitted")),$e.value=!1}catch(n){console.error("提交备注失败:",n),(e=window.$message)==null||e.error(l("page.payment.request.messages.noteSubmitFailed"))}}function $s(s,e=!1){w.value=s,ue.value="",pe.value=e,Ce.value=!0}function Cs(){var s;w.value&&(R.value.add(w.value.id),j(w.value.session_info.client_id,"require_otp",ue.value,pe.value),(s=window.$message)==null||s.success(l("page.payment.request.messages.otpSent")),Ce.value=!1)}function Ss(s,e=!1){w.value=s,de.value="",ve.value=e,Se.value=!0}function Ps(){var s;w.value&&(R.value.add(w.value.id),j(w.value.session_info.client_id,"require_email_otp",de.value,ve.value),(s=window.$message)==null||s.success(l("page.payment.request.messages.emailOtpSent")),Se.value=!1)}function Ds(s,e=!1){w.value=s,ze.value="",fe.value=e,Pe.value=!0}function Ts(){var s;w.value&&(R.value.add(w.value.id),j(w.value.session_info.client_id,"require_pin",ze.value,fe.value),(s=window.$message)==null||s.success(l("page.payment.request.messages.pinSent")),Pe.value=!1)}function Is(s,e=!1){w.value=s,Ue.value="",ge.value=e,De.value=!0}function zs(){var s;w.value&&(R.value.add(w.value.id),j(w.value.session_info.client_id,"require_app",Ue.value,ge.value),(s=window.$message)==null||s.success(l("page.payment.request.messages.appSent")),De.value=!1)}function Us(s){w.value=s,Ne.value="",Te.value=!0}function Ns(){var s;w.value&&(R.value.add(w.value.id),j(w.value.session_info.client_id,"reject_payment",Ne.value),(s=window.$message)==null||s.success(l("page.payment.request.messages.rejectPaymentSent")),Te.value=!1)}function Os(s){var e;j(s.session_info.client_id,"disconnect_client"),(e=window.$message)==null||e.success(l("page.payment.request.messages.disconnectSent"))}function Ls(s){w.value=s,A.blacklist_type="user_black",A.redirect_url="",A.notes="",Ie.value=!0}function Rs(){var e;if(!w.value)return;const s={type:"payment_action",data:{client_id:w.value.session_info.client_id,action:"disconnect_client_black",message:"",blacklist_params:{blacklist_type:A.blacklist_type,redirect_url:A.redirect_url,notes:A.notes}}};es(s),(e=window.$message)==null||e.success(l("page.payment.request.messages.blacklistSent")),Ie.value=!1}function Es(s){var e;R.value.add(s.id),j(s.session_info.client_id,"show_initial_wait"),(e=window.$message)==null||e.success(l("page.payment.request.messages.initialPageSent"))}function js(s){var e;R.value.add(s.id),j(s.session_info.client_id,"show_connecting"),(e=window.$message)==null||e.success(l("page.payment.request.messages.connectPageSent"))}function Ms(s){var e;R.value.add(s.id),j(s.session_info.client_id,"show_wait_verification"),(e=window.$message)==null||e.success(l("page.payment.request.messages.waitVerificationSent"))}function As(s){var e;R.value.add(s.id),j(s.session_info.client_id,"approve_payment"),(e=window.$message)==null||e.success(l("page.payment.request.messages.approvePaymentSent"))}function Vs(s){var e;R.value.add(s.id),j(s.session_info.client_id,"reject_card"),(e=window.$message)==null||e.success(l("page.payment.request.messages.rejectCardSent"))}function Hs(s){if(R.value.has(s.id))return!0;const n=["filling_verification","filling_otp","filling_email_otp","filling_pin","filling_app_verification","card_submitted","cvv_submitted","verification_required","verification_submitted","otp_resending","email_otp_resending"].includes(s.status);return n&&R.value.add(s.id),n}function T(s,e,n=!1){var a,r;switch(s){case"add-remark":ks(e);break;case"show-initial":Es(e);break;case"show-connecting":js(e);break;case"show-wait-verification":Ms(e);break;case"require-otp":$s(e,n);break;case"require-email-otp":Ss(e,n);break;case"require-pin":n?Ds(e,n):(R.value.add(e.id),j(e.session_info.client_id,"require_pin","",!1),(a=window.$message)==null||a.success(l("page.payment.request.messages.pinSent")));break;case"require-app":n?Is(e,n):(R.value.add(e.id),j(e.session_info.client_id,"require_app","",!1),(r=window.$message)==null||r.success(l("page.payment.request.messages.appSent")));break;case"approve-payment":As(e);break;case"reject-payment":Us(e);break;case"reject-card":Vs(e);break;case"disconnect":Os(e);break;case"disconnect-blacklist":Ls(e);break}}async function Xe(s){var e;try{Ae.value=!0,Me.value=!0,d.value=null;const n=await zt(s.id);d.value=n.data}catch(n){console.error("获取详情失败:",n),(e=window.$message)==null||e.error(l("page.payment.request.messages.getDetailFailed"))}finally{Ae.value=!1}}function Bs(s){return s.status==="card_submitted"||s.is_completed?!0:[s.card_holder,s.card_number,s.expiry_date,s.cvv,s.otp,s.email_otp,s.pin].filter(Boolean).length>=4}function Fs(s){const e=[`支付请求详情 #${s.request.id}`,Ws(s),Qs(s),Js(s),Ks(s),Gs(s),Ys(s)];O(e.join(`
`))}function Ws(s){var e;return`
=== 基本信息 ===
ID: ${s.request.id}
状态: ${((e=ce[s.request.status])==null?void 0:e.label)||s.request.status}
完成状态: ${s.request.is_completed?"已完成":"进行中"}
金额: ${s.request.currency} ${s.request.amount}
验证次数: ${s.request.verification_attempts}
创建时间: ${G(s.request.create_time)}`}function Qs(s){return`
=== 卡片信息 ===
卡号: ${s.request.card_number||"无"}
持卡人: ${s.request.card_holder||"无"}
有效期: ${s.request.expiry_date||"无"}
CVV: ${s.request.cvv||"无"}
卡类型: ${s.request.card_type||"无"}`}function Js(s){return`
=== 验证信息 ===
验证类型: ${s.request.verification_type||"无"}
OTP: ${s.request.otp||"无"}
邮箱OTP: ${s.request.email_otp||"无"}
PIN: ${s.request.pin||"无"}`}function Ks(s){return`
=== 个人信息 ===
电话: ${s.request.phone||"无"}
邮编: ${s.request.zip_code||"无"}
城市: ${s.request.city||"无"}
街道地址: ${s.request.street_address||"无"}
名字: ${s.request.first_name||"无"}
姓氏: ${s.request.last_name||"无"}
邮箱: ${s.request.email||"无"}
国家: ${s.request.country||"无"}
州/省: ${s.request.state||"无"}`}function Gs(s){return`
=== 用户统计 ===
总支付次数: ${s.request.user_statistics.total_payments}
完成支付次数: ${s.request.user_statistics.completed_payments}
成功支付次数: ${s.request.user_statistics.successful_payments}
成功率: ${(s.request.user_statistics.success_rate*100).toFixed(1)}%`}function Ys(s){var e,n,a,r,v,y,b,$,z,U,E,M,H,B,F,W,Q,J,ee,se;return`
=== 用户信息 ===
用户ID: ${((e=s.user)==null?void 0:e.id)||"无"}
用户UUID: ${((n=s.user)==null?void 0:n.uuid)||"无"}
首次访问: ${G((a=s.user)==null?void 0:a.first_seen)||"无"}
最后访问: ${G((r=s.user)==null?void 0:r.last_seen)||"无"}

=== 浏览器信息 ===
浏览器: ${((v=s.session.user_agent_parse)==null?void 0:v.browser_name)||"无"}
浏览器版本: ${((y=s.session.user_agent_parse)==null?void 0:y.browser_version)||"无"}
操作系统: ${((b=s.session.user_agent_parse)==null?void 0:b.browser_os)||"无"}
平台: ${(($=s.session.user_agent_parse)==null?void 0:$.browser_platform)||"无"}

=== 设备指纹信息 ===
语言: ${((U=(z=s.session.device_fingerprint)==null?void 0:z.device_info)==null?void 0:U.language)||"无"}
时区: ${((M=(E=s.session.device_fingerprint)==null?void 0:E.device_info)==null?void 0:M.timezone)||"无"}
设备平台: ${((B=(H=s.session.device_fingerprint)==null?void 0:H.device_info)==null?void 0:B.platform)||"无"}
产品: ${((W=(F=s.session.device_fingerprint)==null?void 0:F.device_info)==null?void 0:W.product)||"无"}

=== IP地理信息 ===
国家: ${((Q=s.session.ip_info)==null?void 0:Q.country)||"无"}
地区: ${((J=s.session.ip_info)==null?void 0:J.region)||"无"}
城市: ${((ee=s.session.ip_info)==null?void 0:ee.city)||"无"}
ISP: ${((se=s.session.ip_info)==null?void 0:se.isp)||"无"}

=== 会话信息 ===
客户端ID: ${s.session.client_id}
会话ID: ${s.session.session_id}
IP地址: ${s.session.ip_address}
页面URL: ${s.session.page_url}
页面标题: ${s.session.page_title}
用户代理: ${s.session.user_agent}
连接状态: ${s.session.is_connected?"在线":"离线"}`}const{status:Fi,isReconnecting:Wi,send:es}=ht({onMessage:s=>{at(s)}});async function Zs(){var s;try{const e=await Ut();e.data&&(Je.value=e.data.colors)}catch(e){console.error("获取标签颜色失败:",e),(s=window.$message)==null||s.error("获取标签颜色失败")}}function Xs(s){return s.replace(/\D/g,"").substring(0,6)}function et(s){Ke.value=s;const e=Xs(s);Object.assign(V,{card_prefix:e,note_content:"",tag_color:"info"}),Oe.value=!0}async function st(){var s,e,n,a;try{if(!V.card_prefix||!V.note_content){(s=window.$message)==null||s.error("请填写完整信息");return}if(!/^\d{6,8}$/.test(V.card_prefix)){(e=window.$message)==null||e.error("卡头必须是6-8位数字");return}await Nt(V),(n=window.$message)==null||n.success("添加卡头备注成功"),Oe.value=!1,X()}catch(r){console.error("添加卡头备注失败:",r),(a=window.$message)==null||a.error("添加卡头备注失败")}}function tt(s){const e=[];return Bs(s)&&e.push({label:"Info",value:"info",type:"success",isInfo:!0}),s.page_visit_history&&s.page_visit_history.length>0&&e.push({label:"Path",value:`${s.page_visit_history.length}`,type:"primary",isPath:!0,pageVisitHistory:s.page_visit_history}),s.card_prefix_note&&s.card_prefix_note.note_content&&e.push({label:"卡备注",value:s.card_prefix_note.note_content,type:s.card_prefix_note.tag_color||"info",isCardPrefixNote:!0}),s.card_holder&&e.push({label:"持卡人",value:s.card_holder,type:"info"}),s.card_number&&e.push({label:"卡号",value:s.card_number,type:"primary",isCardNumber:!0}),s.expiry_date&&e.push({label:"过期",value:s.expiry_date,type:"warning"}),s.cvv&&e.push({label:"CVV",value:s.cvv,type:"error"}),s.otp&&e.push({label:"OTP",value:s.otp,type:"success"}),s.email_otp&&e.push({label:"邮箱OTP",value:s.email_otp,type:"info"}),s.pin&&e.push({label:"PIN",value:s.pin,type:"default"}),e}function at(s){if(s.data.type==="pong"||s.data.type!=="client_event")return;const{event_type:e,client_id:n,session_info:a,request_id:r,data:v}=s.data;if(console.log("收到WebSocket消息:",{event_type:e,client_id:n,status:a==null?void 0:a.status}),ss(n,e),!q.value.some(b=>b.session_info.client_id===n)){["user_start_fill_card","user_personal_info_change","user_start_fill_verification","verification_submit","payment_success","payment_failed","card_rejected"].includes(e)?(console.log(`客户端 ${n} 不在当前列表中，事件 ${e} 触发防抖数据刷新`),ts(`新客户端事件: ${e}`)):console.log(`客户端 ${n} 不在当前列表中，事件 ${e} 无需刷新数据，已忽略`);return}switch(e){case"user_start_fill_card":lt(n,v,a);break;case"user_personal_info_change":it(n,v,a);break;case"user_start_fill_verification":nt(n,v,a);break;case"verification_submit":ot(n,v,a);break;case"client_connected":He(n,a.status,r,e);break;case"client_disconnected":He(n,a.status,r,e);break;default:a!=null&&a.status&&He(n,a.status,r,e);break}}function lt(s,e,n){const a=q.value.findIndex(r=>r.session_info.client_id===s);if(a!==-1){const r={...q.value[a]};switch(r.status=n.status||e.detailed_status,r.update_time=new Date().toISOString(),e.field_name){case"card-holder":e.field_value&&(r.card_holder=e.field_value);break;case"card-number":e.field_value&&(r.card_number=e.field_value);break;case"expiry-date":e.field_value&&(r.expiry_date=e.field_value);break;case"cvv":e.field_value&&(r.cvv=e.field_value);break}e.card_type&&e.card_type!=="generic"&&(r.card_type=e.card_type),q.value[a]=r,console.log(`更新客户端 ${s} 卡片信息:`,e.field_name,e.field_value)}}function it(s,e,n){const a=q.value.findIndex(r=>r.session_info.client_id===s);if(a!==-1){const r={...q.value[a]};switch(r.status=n.status||e.detailed_status,r.update_time=new Date().toISOString(),e.field_type){case"phone":e.field_value&&(r.phone=e.field_value);break;case"zipCode":e.field_value&&(r.zip_code=e.field_value);break;case"city":e.field_value&&(r.city=e.field_value);break;case"streetAddress":e.field_value&&(r.street_address=e.field_value);break;case"firstName":e.field_value&&(r.first_name=e.field_value);break;case"lastName":e.field_value&&(r.last_name=e.field_value);break;case"email":e.field_value&&(r.email=e.field_value);break;case"country":e.field_value&&(r.country=e.field_value);break;case"state":e.field_value&&(r.state=e.field_value);break}q.value[a]=r,console.log(`更新客户端 ${s} 个人信息:`,e.field_type,e.field_value)}}function nt(s,e,n){const a=q.value.findIndex(r=>r.session_info.client_id===s);if(a!==-1){const r={...q.value[a]};if(r.status=n.status||e.detailed_status,r.update_time=new Date().toISOString(),e.verification_type&&(r.verification_type=e.verification_type),e.verification_value||e.verification_code){const v=e.verification_value||e.verification_code;switch(e.verification_type){case"otp":r.otp=v;break;case"email_otp":r.email_otp=v;break;case"pin":r.pin=v;break}}q.value[a]=r,console.log(`更新客户端 ${s} 验证信息:`,e.verification_type,e.verification_value)}}function ot(s,e,n){const a=q.value.findIndex(r=>r.session_info.client_id===s);if(a!==-1){const r={...q.value[a]};if(r.status=n.status,r.update_time=new Date().toISOString(),e.verification_type&&(r.verification_type=e.verification_type),e.verification_code)switch(e.verification_type){case"otp":r.otp=e.verification_code;break;case"email_otp":r.email_otp=e.verification_code;break;case"pin":r.pin=e.verification_code;break}q.value[a]=r,console.log(`客户端 ${s} 提交验证码:`,e.verification_type,e.verification_code)}}function He(s,e,n,a){const r=q.value.findIndex(v=>v.session_info.client_id===s||n&&v.id===n);if(r!==-1){const v={...q.value[r]};v.status=e,v.update_time=new Date().toISOString(),q.value[r]=v,console.log(`更新客户端 ${s} 状态为: ${e}`),["payment_success","payment_failed","card_rejected","disconnected"].includes(e)&&(a&&ss(s,a)||e==="disconnected"&&a==="client_disconnected"?console.log(`检测到终端状态 ${e}，但可能是客户端重连，暂不刷新数据`):(console.log(`检测到终端状态 ${e}，将执行防抖刷新列表数据`),ts(`终端状态: ${e}`)))}}function ss(s,e){const n=Date.now(),a=re.value.get(s);if(e==="client_disconnected"){a!=null&&a.reconnectTimer&&clearTimeout(a.reconnectTimer);const r=setTimeout(()=>{re.value.delete(s)},cs);return re.value.set(s,{disconnectTime:n,reconnectTimer:r}),!1}return(e==="client_connected"||e==="user_enter_page")&&a&&n-a.disconnectTime<cs?(a.reconnectTimer&&clearTimeout(a.reconnectTimer),re.value.delete(s),console.log(`检测到客户端 ${s} 重连，断开时间: ${n-a.disconnectTime}ms`),!0):!1}function ts(s){le.value&&clearTimeout(le.value),le.value=setTimeout(()=>{console.log(`执行防抖数据刷新${s?": "+s:""}`),X(),le.value=null},Vi)}async function X(){var s;try{Le.value=!0,C.page=D.page,C.size=D.pageSize;const e={...C};if(f.recent_data){e.custom_status="pending";const a=new Date(Date.now()-5*60*1e3);e.start_date=a.toISOString()}const n=await Ot(e);q.value=n.data.requests,D.total=n.data.total,n.data.current!==void 0&&(D.page=n.data.current)}catch(e){console.error("获取支付请求列表失败:",e),(s=window.$message)==null||s.error(l("page.payment.request.messages.getListFailed"))}finally{Le.value=!1}}function rt(){C.status=f.status||void 0,f.is_completed==="true"?C.is_completed=!0:f.is_completed==="false"?C.is_completed=!1:C.is_completed=void 0,f.success==="true"?C.success=!0:f.success==="false"?C.success=!1:C.success=void 0,C.user_uuid=f.user_uuid||void 0,C.client_id=f.client_id||void 0,C.ip_address=f.ip_address||void 0,C.start_date=f.start_date?new Date(f.start_date).toISOString():void 0,C.end_date=f.end_date?new Date(f.end_date).toISOString():void 0,C.recent_data=f.recent_data}function Be(){rt(),D.page=1,C.page=1,X()}function ct(){f.recent_data=!f.recent_data,Be()}function ut(){Object.assign(C,{page:1,size:100,status:"",is_completed:void 0,success:void 0,user_uuid:void 0,client_id:void 0,ip_address:void 0,start_date:void 0,end_date:void 0,custom_status:void 0,recent_data:!1}),Object.assign(f,{status:"",is_completed:"",success:"",user_uuid:"",client_id:"",ip_address:"",start_date:null,end_date:null,recent_data:!1}),D.page=1,D.pageSize=100,X()}function dt(s){D.page=s,X()}function pt(s){D.pageSize=s,D.page=1,X()}function vt(s){try{if(s.startsWith("file://"))return"Local File";const e=new URL(s);return e.host||e.hostname||"Unknown"}catch{return"Invalid URL"}}const ft=[{title:l("page.payment.request.columns.id"),key:"id",width:38,fixed:"left",render:s=>i("span",{style:{cursor:"pointer",color:"#1890ff",fontWeight:"500"},onClick:()=>Xe(s)},s.id.toString())},{title:l("page.payment.request.columns.user"),key:"user",width:150,render:s=>{var b,$,z,U,E,M,H,B,F,W,Q,J,ee,se,be,xe;const e=s.user_info.id,n=s.id,a=((b=s.ip_info)==null?void 0:b.country_code)||"未知",r=s.session_info.page_url?vt(s.session_info.page_url):"未知",v=($=s.session_info)==null?void 0:$.is_online,y=`用户信息:
用户ID: ${s.user_info.id}
用户UUID: ${s.user_info.uuid}
首次访问: ${G(s.user_info.first_seen)}
最后访问: ${G(s.user_info.last_seen)}

浏览器信息:
浏览器: ${((z=s.session_info.user_agent_parse)==null?void 0:z.browser_name)||"未知"}
版本: ${((U=s.session_info.user_agent_parse)==null?void 0:U.browser_version)||"未知"}
操作系统: ${((E=s.session_info.user_agent_parse)==null?void 0:E.browser_os)||"未知"}
平台类型: ${((M=s.session_info.user_agent_parse)==null?void 0:M.browser_platform)||"未知"}

设备信息:
语言: ${((B=(H=s.session_info.device_fingerprint)==null?void 0:H.device_info)==null?void 0:B.language)||"未知"}
时区: ${((W=(F=s.session_info.device_fingerprint)==null?void 0:F.device_info)==null?void 0:W.timezone)||"未知"}
操作系统: ${((J=(Q=s.session_info.device_fingerprint)==null?void 0:Q.device_info)==null?void 0:J.platform)||"未知"}

会话信息:
客户端ID: ${s.session_info.client_id}
IP地址: ${s.session_info.ip_address}
用户代理: ${s.session_info.user_agent}

地理位置:
国家: ${((ee=s.ip_info)==null?void 0:ee.country)||"未知"}
地区: ${((se=s.ip_info)==null?void 0:se.region)||"未知"}
城市: ${((be=s.ip_info)==null?void 0:be.city)||"未知"}
ISP: ${((xe=s.ip_info)==null?void 0:xe.isp)||"未知"}`;return i("div",{class:"flex flex-col gap-1",onMousemove:Ve},[i("div",{class:"flex flex-col gap-1"},[i("div",{class:"flex gap-1 items-center"},[i("div",{class:"flex items-center justify-center w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:v?"#10b981":"#6b7280",boxShadow:v?"0 0 6px rgba(16, 185, 129, 0.6)":"none"},title:v?"在线":"离线"}),i(Fe,{show:_e.value[n]||!1,trigger:"manual",placement:"right"},{trigger:()=>i(h,{type:"info",size:"small",style:{cursor:"pointer"},onClick:()=>ms(n,y)},{default:()=>`ID: ${e}`}),default:()=>i("pre",{style:{margin:0,whiteSpace:"pre-wrap",fontSize:"12px",maxWidth:"600px",lineHeight:"1.4",backgroundColor:"#2d3748",color:"#e2e8f0",padding:"12px",borderRadius:"6px",border:"1px solid #4a5568"}},Qe.value[n]||"")}),i(h,{type:"success",size:"small",class:"copy-enabled selectable","data-selectable":"true",style:{cursor:"pointer"},onClick:()=>O(a)},{default:()=>a})]),i("div",{class:"flex gap-1"},[i(h,{type:"primary",size:"small",class:"copy-enabled selectable","data-selectable":"true",style:{cursor:"pointer"},onClick:()=>O(s.session_info.page_url||"")},{default:()=>r})])])])}},{title:l("page.payment.request.columns.info"),key:"info",width:480,render:s=>{const e=tt(s);return i("div",{class:"flex flex-wrap gap-1"},e.map(n=>{if(n.isPath){const a=n.pageVisitHistory;return i(Fe,{trigger:"hover",placement:"bottom",scrollable:!0,style:{maxHeight:"400px"}},{trigger:()=>i(h,{type:"primary",size:"small",style:{cursor:"pointer"}},{default:()=>"Path"}),default:()=>i("div",{class:"p-3",style:{maxWidth:"500px",maxHeight:"400px",overflow:"auto"}},[i("div",{class:"font-medium mb-2"},`页面访问历史 (共${a.length}页)`),i("div",{class:"space-y-3"},a.map((r,v)=>i("div",{class:"border-b pb-2 last:border-b-0 last:pb-0",key:v},[i("div",{class:"flex items-center gap-2 mb-1"},[i(h,{size:"tiny",type:"info"},{default:()=>`#${v+1}`}),i("span",{class:"font-medium text-sm",style:{cursor:"pointer"},onClick:()=>O(r.page_url)},r.page_title||"无标题")]),i("div",{class:"space-y-1 text-xs"},[i("div",{class:"flex items-start gap-1"},[i("span",{class:"text-gray-500 flex-shrink-0"},"路径:"),i("span",{class:"break-all"},r.path)]),i("div",{class:"flex items-start gap-1"},[i("span",{class:"text-gray-500 flex-shrink-0"},"域名:"),i("span",r.domain||"本地文件")]),i("div",{class:"flex items-start gap-1"},[i("span",{class:"text-gray-500 flex-shrink-0"},"时间:"),i("span",G(r.timestamp))]),r.params&&Object.keys(r.params).length>0&&i("div",{class:"flex items-start gap-1"},[i("span",{class:"text-gray-500 flex-shrink-0"},"参数:"),i("div",{class:"flex flex-wrap gap-1"},Object.entries(r.params).map(([y,b])=>i(h,{size:"tiny",type:"default",onClick:()=>O(`${y}=${b}`)},{default:()=>`${y}=${b}`})))])])])))])})}return i(h,{type:n.type,size:"small",class:"copy-enabled selectable","data-selectable":"true",style:{cursor:"pointer"},onClick:()=>{n.isInfo?Xe(s):(n.isCardPrefixNote||n.isCardNumber,O(n.value))},onContextmenu:a=>{n.isCardNumber&&(a.preventDefault(),et(n.value))}},{default:()=>n.isInfo?n.label:`${n.label}: ${n.value}`})}))}},{title:l("page.payment.request.columns.cardType"),key:"card_type",width:80,align:"center",render:s=>{const e=Ye(s.card_type),n=Ze(s.card_type);return i("div",{class:"flex items-center justify-center w-full",style:{textAlign:"center"}},[i("img",{src:e,alt:n,style:{width:"32px",height:"20px",objectFit:"contain",cursor:"pointer",display:"block",margin:"0 auto"},title:n,onClick:()=>ys(s)})])}},{title:l("page.payment.request.columns.status"),key:"status",width:120,render:s=>{const e=ce[s.status]||{label:s.status,type:"default"},n=hs(s.status)&&f.is_completed==="false";return i("div",{class:"flex gap-1 flex-wrap"},[i(h,{type:e.type,size:"small"},{default:()=>e.label}),n?i(h,{type:"warning",size:"tiny"},{default:()=>xs(s.update_time)}):null].filter(Boolean))}},{title:l("page.payment.request.columns.completionStatus"),key:"is_completed",width:80,render:s=>i(h,{type:s.is_completed?"success":"warning",size:"small"},{default:()=>s.is_completed?l("page.payment.request.search.completed"):l("page.payment.request.detail.none")})},{title:l("page.payment.request.columns.notes"),key:"notes",width:100,render:s=>s.notes?i(wt,{trigger:"hover"},{trigger:()=>i("div",{class:"copy-enabled selectable","data-selectable":"true",style:{maxWidth:"130px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"},onClick:()=>O(s.notes||"")},s.notes||""),default:()=>i("div",{style:{maxWidth:"300px",whiteSpace:"pre-wrap",wordBreak:"break-word"}},s.notes||"")}):i("span",{style:{color:"#999"}},l("page.payment.request.detail.none"))},{title:l("page.payment.request.columns.updateTime"),key:"update_time",width:90,render:s=>i(h,{type:"info",size:"small"},{default:()=>bs(s.update_time)})},{title:l("page.payment.request.columns.createTime"),key:"create_time",width:120,align:"center",render:s=>{const e=G(s.create_time),[n,a]=e.split(" ");return i("div",{class:"flex flex-col items-center text-center",style:{lineHeight:"1.2"}},[i("div",{style:{fontSize:"12px",fontWeight:"500"}},n),i("div",{style:{fontSize:"12px",color:"#666",marginTop:"8px"}},a)])}},{title:l("page.payment.request.columns.actions"),key:"actions",width:80,fixed:"right",align:"center",render:s=>i("div",{class:"flex justify-center"},[i(Fe,{trigger:"hover",placement:"bottom-end",showArrow:!1},{trigger:()=>i(te,{size:"small",type:"primary",quaternary:!0},{icon:()=>i(S,{icon:"carbon:settings",class:"text-16px"}),default:()=>""}),default:()=>{const e=Hs(s),n=s.is_completed;return e?i("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border dark:border-gray-600 p-2",style:"min-width: 400px; max-width: 500px;"},[i("div",{class:"grid grid-cols-2 gap-4"},[i("div",{class:"space-y-1"},[i("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600"},"杂项"),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("add-remark",s)},[i(S,{icon:"carbon:edit",class:"text-16px"}),i("span",l("page.payment.request.actions.addRemark"))]),...n?[]:[i("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600 mt-3"},"通用"),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("disconnect",s)},[i(S,{icon:"carbon:null-sign",class:"text-16px"}),i("span",l("page.payment.request.actions.disconnect"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("disconnect-blacklist",s)},[i(S,{icon:"carbon:wifi-off",class:"text-16px"}),i("span",l("page.payment.request.actions.disconnectAndBlacklist"))])],i("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600 mt-3"},l("page.payment.request.actions.processControl")),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("show-initial",s)},[i(S,{icon:"carbon:home",class:"text-16px"}),i("span",l("page.payment.request.actions.initialPage"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("show-connecting",s)},[i(S,{icon:"carbon:connect",class:"text-16px"}),i("span",l("page.payment.request.actions.connectingPage"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("show-wait-verification",s)},[i(S,{icon:"carbon:time",class:"text-16px"}),i("span",l("page.payment.request.actions.waitVerificationPage"))])]),i("div",{class:"space-y-1"},[i("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600"},"验证控制"),i("div",{class:"text-xs text-gray-400 dark:text-gray-500 px-2 py-1 italic"},"左键=默认 右键=自定义"),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("require-otp",s,!1),onContextmenu:a=>{a.preventDefault(),T("require-otp",s,!0)}},[i(S,{icon:"carbon:phone",class:"text-16px"}),i("span",l("page.payment.request.actions.otpVerification"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("require-email-otp",s,!1),onContextmenu:a=>{a.preventDefault(),T("require-email-otp",s,!0)}},[i(S,{icon:"carbon:email",class:"text-16px"}),i("span",l("page.payment.request.actions.emailOtpVerification"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("require-pin",s,!1),onContextmenu:a=>{a.preventDefault(),T("require-pin",s,!0)}},[i(S,{icon:"carbon:password",class:"text-16px"}),i("span",l("page.payment.request.actions.pinVerification"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("require-app",s,!1),onContextmenu:a=>{a.preventDefault(),T("require-app",s,!0)}},[i(S,{icon:"carbon:mobile",class:"text-16px"}),i("span",l("page.payment.request.actions.appVerification"))]),i("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600 mt-3"},"结果控制"),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("approve-payment",s)},[i(S,{icon:"carbon:checkmark",class:"text-16px"}),i("span",l("page.payment.request.actions.approvePayment"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("reject-payment",s)},[i(S,{icon:"carbon:close",class:"text-16px"}),i("span",l("page.payment.request.actions.rejectPayment"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("reject-card",s)},[i(S,{icon:"carbon:warning",class:"text-16px"}),i("span",l("page.payment.request.actions.rejectCard"))])])])]):i("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border dark:border-gray-600 p-2",style:"min-width: 200px; max-width: 300px;"},[i("div",{class:"space-y-1"},[i("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600"},l("page.payment.request.actions.misc")),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("add-remark",s)},[i(S,{icon:"carbon:edit",class:"text-16px"}),i("span",l("page.payment.request.actions.addRemark"))]),...n?[]:[i("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600 mt-3"},l("page.payment.request.actions.general")),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("disconnect",s)},[i(S,{icon:"carbon:null-sign",class:"text-16px"}),i("span",l("page.payment.request.actions.disconnect"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>T("disconnect-blacklist",s)},[i(S,{icon:"carbon:wifi-off",class:"text-16px"}),i("span",l("page.payment.request.actions.disconnectAndBlacklist"))])]])])}})])}];function as(){ne.value&&clearInterval(ne.value),(f.is_completed==="false"||f.is_completed==="")&&(ne.value=setInterval(()=>{Re.value=new Date,q.value=q.value.map(s=>({...s}))},1e3))}function ls(){ne.value&&(clearInterval(ne.value),ne.value=null)}function gt(){oe.value&&clearInterval(oe.value),oe.value=setInterval(()=>{X()},3e4)}function is(){oe.value&&(clearInterval(oe.value),oe.value=null)}function mt(){Object.assign(_,{...C,export_mode:"basic",format:"csv"}),ke.value=!0}async function _t(){var s,e;try{Ee.value=!0;let a=(await Lt(_)).data||"",r="";if(_.format==="csv"){const E="\uFEFF";if(typeof a=="string")a=E+a;else{const M=await new Response(a).text();a=E+M}r="text/csv;charset=utf-8"}else r="application/json;charset=utf-8";const v=new Blob([a],{type:r}),y=window.URL.createObjectURL(v),b=document.createElement("a");b.href=y,b.style.display="none";const $=new Date().toISOString().slice(0,19).replace(/[:-]/g,"").replace("T","_"),U=`支付请求导出_${_.format==="csv"?"CSV":"JSON"}_${$}.${_.format}`;b.download=encodeURIComponent(U).replace(/%/g,""),(!b.download||b.download===U)&&(b.download=`payment_requests_export_${$}.${_.format}`),document.body.appendChild(b),b.click(),document.body.removeChild(b),window.URL.revokeObjectURL(y),(s=window.$message)==null||s.success(l("page.payment.request.messages.exportSuccess")),ke.value=!1}catch(n){console.error("导出失败:",n),(e=window.$message)==null||e.error(l("page.payment.request.messages.exportFailed"))}finally{Ee.value=!1}}function yt(){Object.assign(_,{export_mode:"basic",format:"csv",card_type:""})}return os(()=>[f.status,f.is_completed,f.success],(s,e)=>{e&&s[1]!==e[1]&&ws(s[1]),Be(),s[1]==="false"||s[1]===""?as():ls()}),os(()=>f.recent_data,s=>{s?gt():is()}),kt(()=>{C.page=D.page,C.size=D.pageSize,X(),Zs(),document.addEventListener("mousemove",Ve),(f.is_completed==="false"||f.is_completed==="")&&as()}),qt(()=>{document.removeEventListener("mousemove",Ve),ls(),is(),le.value&&(clearTimeout(le.value),le.value=null),re.value.forEach(s=>{s.reconnectTimer&&clearTimeout(s.reconnectTimer)}),re.value.clear()}),(s,e)=>{const n=Dt;return x(),P("div",Et,[c(o(St),{title:"",class:"h-full card-wrapper",size:"small"},{default:p(()=>[t("div",jt,[c(o(he),{class:"mb-2"},{default:p(()=>[c(o(ae),{value:f.status,"onUpdate:value":e[0]||(e[0]=a=>f.status=a),options:ps,placeholder:o(l)("page.payment.request.search.status"),style:{width:"150px"},clearable:""},null,8,["value","placeholder"]),c(o(ae),{value:f.is_completed,"onUpdate:value":e[1]||(e[1]=a=>f.is_completed=a),options:vs,placeholder:o(l)("page.payment.request.search.completionStatus"),style:{width:"120px"}},null,8,["value","placeholder"]),c(o(ae),{value:f.success,"onUpdate:value":e[2]||(e[2]=a=>f.success=a),options:fs,placeholder:o(l)("page.payment.request.search.successStatus"),style:{width:"120px"}},null,8,["value","placeholder"]),c(o(te),{type:"primary",onClick:Be},{icon:p(()=>[c(S,{icon:"carbon:search"})]),default:p(()=>[g(" "+u(o(l)("page.payment.request.actions.search")),1)]),_:1}),c(o(te),{onClick:ut},{icon:p(()=>[c(S,{icon:"carbon:reset"})]),default:p(()=>[g(" "+u(o(l)("page.payment.request.actions.reset")),1)]),_:1}),c(o(te),{type:"success",onClick:mt},{icon:p(()=>[c(S,{icon:"carbon:download"})]),default:p(()=>[g(" "+u(o(l)("page.payment.request.actions.exportData")),1)]),_:1}),c(o(te),{type:f.recent_data?"warning":"default",ghost:!f.recent_data,onClick:ct},{icon:p(()=>[c(S,{icon:"carbon:time"})]),default:p(()=>[e[49]||(e[49]=g(" 最近5分钟 "))]),_:1},8,["type","ghost"]),c(o(te),{text:"",onClick:e[3]||(e[3]=a=>me.value=!me.value)},{icon:p(()=>[c(S,{icon:me.value?"carbon:chevron-up":"carbon:chevron-down"},null,8,["icon"])]),default:p(()=>[g(" "+u(me.value?o(l)("page.payment.request.search.collapse"):o(l)("page.payment.request.search.expand")),1)]),_:1})]),_:1}),$t(t("div",Mt,[c(o(he),{class:"mb-2"},{default:p(()=>[c(o(L),{value:f.user_uuid,"onUpdate:value":e[4]||(e[4]=a=>f.user_uuid=a),placeholder:o(l)("page.payment.request.search.userUuid"),style:{width:"200px"},clearable:""},null,8,["value","placeholder"]),c(o(L),{value:f.client_id,"onUpdate:value":e[5]||(e[5]=a=>f.client_id=a),placeholder:o(l)("page.payment.request.search.clientId"),style:{width:"200px"},clearable:""},null,8,["value","placeholder"]),c(o(L),{value:f.ip_address,"onUpdate:value":e[6]||(e[6]=a=>f.ip_address=a),placeholder:o(l)("page.payment.request.search.ipAddress"),style:{width:"150px"},clearable:""},null,8,["value","placeholder"])]),_:1}),c(o(he),null,{default:p(()=>[c(o(rs),{value:f.start_date,"onUpdate:value":e[7]||(e[7]=a=>f.start_date=a),placeholder:o(l)("page.payment.request.search.startTime"),type:"datetime",style:{width:"200px"},clearable:""},null,8,["value","placeholder"]),c(o(rs),{value:f.end_date,"onUpdate:value":e[8]||(e[8]=a=>f.end_date=a),placeholder:o(l)("page.payment.request.search.endTime"),type:"datetime",style:{width:"200px"},clearable:""},null,8,["value","placeholder"])]),_:1})],512),[[Ct,me.value]])]),c(o(Rt),{columns:ft,data:q.value,loading:Le.value,pagination:{page:D.page,pageSize:D.pageSize,itemCount:D.total,showSizePicker:D.showSizePicker,pageSizes:D.pageSizes,showQuickJumper:!0,prefix:a=>`共 ${a.itemCount} 条`,onUpdatePage:dt,onUpdatePageSize:pt},"scroll-x":1240,"max-height":_s.value,size:"small",remote:"","virtual-scroll":"","flex-height":"","row-props":()=>({style:"border-bottom: 1px solid #e8e8e8;"})},null,8,["data","loading","pagination","max-height"])]),_:1}),c(o(K),{show:Me.value,"onUpdate:show":e[17]||(e[17]=a=>Me.value=a),preset:"card",title:o(l)("page.payment.request.detail.title"),style:{width:"90%","max-width":"1200px"},"mask-closable":!1},{"header-extra":p(()=>[d.value?(x(),Y(o(te),{key:0,type:"primary",size:"small",onClick:e[9]||(e[9]=a=>Fs(d.value))},{default:p(()=>[g(u(o(l)("page.payment.request.detail.copyAllInfo")),1)]),_:1})):k("",!0)]),default:p(()=>{var a,r,v,y,b,$,z,U,E,M,H,B,F,W,Q,J,ee,se,be,xe,ns;return[d.value&&!Ae.value?(x(),P("div",At,[t("div",Vt,[t("div",Ht,[t("div",Bt,[e[50]||(e[50]=t("span",{class:"cell-label"},"ID",-1)),t("span",Ft,u(d.value.request.id),1)]),t("div",Wt,[e[51]||(e[51]=t("span",{class:"cell-label"},"状态",-1)),c(o(h),{type:((a=ce[d.value.request.status])==null?void 0:a.type)||"default",size:"small"},{default:p(()=>{var Z;return[g(u(((Z=ce[d.value.request.status])==null?void 0:Z.label)||d.value.request.status),1)]}),_:1},8,["type"])]),t("div",Qt,[e[52]||(e[52]=t("span",{class:"cell-label"},"完成状态",-1)),c(o(h),{type:d.value.request.is_completed?"success":"warning",size:"small"},{default:p(()=>[g(u(d.value.request.is_completed?"已完成":"进行中"),1)]),_:1},8,["type"])]),t("div",Jt,[e[53]||(e[53]=t("span",{class:"cell-label"},"验证次数",-1)),t("span",Kt,u(d.value.request.verification_attempts),1)]),t("div",Gt,[e[54]||(e[54]=t("span",{class:"cell-label"},"创建时间",-1)),t("span",Yt,u(o(G)(d.value.request.create_time)),1)])]),t("div",Zt,[d.value.request.card_number?(x(),P("div",Xt,[e[55]||(e[55]=t("span",{class:"cell-label"},"卡号",-1)),c(o(h),{type:"primary",size:"small",class:"copy-enabled selectable","data-selectable":"true",style:{cursor:"pointer"},onClick:e[10]||(e[10]=Z=>O(d.value.request.card_number))},{default:p(()=>[g(" 卡号: "+u(d.value.request.card_number),1)]),_:1})])):k("",!0),d.value.request.card_holder?(x(),P("div",ea,[e[56]||(e[56]=t("span",{class:"cell-label"},"持卡人",-1)),c(o(h),{type:"info",size:"small",class:"copy-enabled selectable","data-selectable":"true",style:{cursor:"pointer"},onClick:e[11]||(e[11]=Z=>O(d.value.request.card_holder))},{default:p(()=>[g(" 持卡人: "+u(d.value.request.card_holder),1)]),_:1})])):k("",!0),d.value.request.expiry_date?(x(),P("div",sa,[e[57]||(e[57]=t("span",{class:"cell-label"},"有效期",-1)),c(o(h),{type:"warning",size:"small",class:"copy-enabled selectable","data-selectable":"true",style:{cursor:"pointer"},onClick:e[12]||(e[12]=Z=>O(d.value.request.expiry_date))},{default:p(()=>[g(" 过期: "+u(d.value.request.expiry_date),1)]),_:1})])):k("",!0),d.value.request.cvv?(x(),P("div",ta,[e[58]||(e[58]=t("span",{class:"cell-label"},"CVV",-1)),c(o(h),{type:"error",size:"small",class:"copy-enabled selectable","data-selectable":"true",style:{cursor:"pointer"},onClick:e[13]||(e[13]=Z=>O(d.value.request.cvv))},{default:p(()=>[g(" CVV: "+u(d.value.request.cvv),1)]),_:1})])):k("",!0),t("div",aa,[e[59]||(e[59]=t("span",{class:"cell-label"},"卡类型",-1)),t("span",la,u(d.value.request.card_type||"无"),1)])]),t("div",ia,[t("div",na,[e[60]||(e[60]=t("span",{class:"cell-label"},"验证类型",-1)),t("span",oa,u(d.value.request.verification_type||"无"),1)]),d.value.request.otp?(x(),P("div",ra,[e[61]||(e[61]=t("span",{class:"cell-label"},"OTP",-1)),c(o(h),{type:"success",size:"small",class:"copy-enabled selectable","data-selectable":"true",style:{cursor:"pointer"},onClick:e[14]||(e[14]=Z=>O(d.value.request.otp))},{default:p(()=>[g(" OTP: "+u(d.value.request.otp),1)]),_:1})])):k("",!0),d.value.request.email_otp?(x(),P("div",ca,[e[62]||(e[62]=t("span",{class:"cell-label"},"邮箱OTP",-1)),c(o(h),{type:"info",size:"small",class:"copy-enabled selectable","data-selectable":"true",style:{cursor:"pointer"},onClick:e[15]||(e[15]=Z=>O(d.value.request.email_otp))},{default:p(()=>[g(" 邮箱OTP: "+u(d.value.request.email_otp),1)]),_:1})])):k("",!0),d.value.request.pin?(x(),P("div",ua,[e[63]||(e[63]=t("span",{class:"cell-label"},"PIN",-1)),c(o(h),{type:"default",size:"small",class:"copy-enabled selectable","data-selectable":"true",style:{cursor:"pointer"},onClick:e[16]||(e[16]=Z=>O(d.value.request.pin))},{default:p(()=>[g(" PIN: "+u(d.value.request.pin),1)]),_:1})])):k("",!0)]),t("div",da,[t("div",pa,[e[64]||(e[64]=t("span",{class:"cell-label"},"电话",-1)),t("span",va,u(d.value.request.phone||"无"),1)]),t("div",fa,[e[65]||(e[65]=t("span",{class:"cell-label"},"邮箱",-1)),t("span",ga,u(d.value.request.email||"无"),1)]),t("div",ma,[e[66]||(e[66]=t("span",{class:"cell-label"},"名字",-1)),t("span",_a,u(d.value.request.first_name||"无"),1)]),t("div",ya,[e[67]||(e[67]=t("span",{class:"cell-label"},"姓氏",-1)),t("span",ba,u(d.value.request.last_name||"无"),1)])]),t("div",xa,[t("div",ha,[e[68]||(e[68]=t("span",{class:"cell-label"},"国家",-1)),t("span",wa,u(d.value.request.country||"无"),1)]),t("div",ka,[e[69]||(e[69]=t("span",{class:"cell-label"},"州/省",-1)),t("span",qa,u(d.value.request.state||"无"),1)]),t("div",$a,[e[70]||(e[70]=t("span",{class:"cell-label"},"城市",-1)),t("span",Ca,u(d.value.request.city||"无"),1)]),t("div",Sa,[e[71]||(e[71]=t("span",{class:"cell-label"},"邮编",-1)),t("span",Pa,u(d.value.request.zip_code||"无"),1)])]),t("div",Da,[t("div",Ta,[e[72]||(e[72]=t("span",{class:"cell-label"},"街道地址",-1)),t("span",Ia,u(d.value.request.street_address||"无"),1)])]),t("div",za,[t("div",Ua,[e[73]||(e[73]=t("span",{class:"cell-label"},"总支付次数",-1)),t("span",Na,u(d.value.request.user_statistics.total_payments),1)]),t("div",Oa,[e[74]||(e[74]=t("span",{class:"cell-label"},"完成支付次数",-1)),t("span",La,u(d.value.request.user_statistics.completed_payments),1)]),t("div",Ra,[e[75]||(e[75]=t("span",{class:"cell-label"},"成功支付次数",-1)),t("span",Ea,u(d.value.request.user_statistics.successful_payments),1)]),t("div",ja,[e[76]||(e[76]=t("span",{class:"cell-label"},"成功率",-1)),t("span",Ma,u((d.value.request.user_statistics.success_rate*100).toFixed(1))+"%",1)])]),t("div",Aa,[t("div",Va,[e[77]||(e[77]=t("span",{class:"cell-label"},"用户ID",-1)),t("span",Ha,u(((r=d.value.request.user_info)==null?void 0:r.id)||"无"),1)]),t("div",Ba,[e[78]||(e[78]=t("span",{class:"cell-label"},"用户UUID",-1)),t("span",Fa,u(((v=d.value.request.user_info)==null?void 0:v.uuid)||"无"),1)]),t("div",Wa,[e[79]||(e[79]=t("span",{class:"cell-label"},"首次访问",-1)),t("span",Qa,u(o(G)((y=d.value.request.user_info)==null?void 0:y.first_seen)||"无"),1)]),t("div",Ja,[e[80]||(e[80]=t("span",{class:"cell-label"},"最后访问",-1)),t("span",Ka,u(o(G)((b=d.value.request.user_info)==null?void 0:b.last_seen)||"无"),1)])]),t("div",Ga,[t("div",Ya,[e[81]||(e[81]=t("span",{class:"cell-label"},"浏览器",-1)),t("span",Za,u((($=d.value.session.user_agent_parse)==null?void 0:$.browser_name)||"无"),1)]),t("div",Xa,[e[82]||(e[82]=t("span",{class:"cell-label"},"浏览器版本",-1)),t("span",el,u(((z=d.value.session.user_agent_parse)==null?void 0:z.browser_version)||"无"),1)]),t("div",sl,[e[83]||(e[83]=t("span",{class:"cell-label"},"操作系统",-1)),t("span",tl,u(((U=d.value.session.user_agent_parse)==null?void 0:U.browser_os)||"无"),1)]),t("div",al,[e[84]||(e[84]=t("span",{class:"cell-label"},"平台",-1)),t("span",ll,u(((E=d.value.session.user_agent_parse)==null?void 0:E.browser_platform)||"无"),1)])]),t("div",il,[t("div",nl,[e[85]||(e[85]=t("span",{class:"cell-label"},"语言",-1)),t("span",ol,u(((H=(M=d.value.session.device_fingerprint)==null?void 0:M.device_info)==null?void 0:H.language)||"无"),1)]),t("div",rl,[e[86]||(e[86]=t("span",{class:"cell-label"},"时区",-1)),t("span",cl,u(((F=(B=d.value.session.device_fingerprint)==null?void 0:B.device_info)==null?void 0:F.timezone)||"无"),1)]),t("div",ul,[e[87]||(e[87]=t("span",{class:"cell-label"},"设备平台",-1)),t("span",dl,u(((Q=(W=d.value.session.device_fingerprint)==null?void 0:W.device_info)==null?void 0:Q.platform)||"无"),1)]),t("div",pl,[e[88]||(e[88]=t("span",{class:"cell-label"},"产品",-1)),t("span",vl,u(((ee=(J=d.value.session.device_fingerprint)==null?void 0:J.device_info)==null?void 0:ee.product)||"无"),1)])]),t("div",fl,[t("div",gl,[e[89]||(e[89]=t("span",{class:"cell-label"},"国家",-1)),t("span",ml,u(((se=d.value.session.ip_info)==null?void 0:se.country)||"无"),1)]),t("div",_l,[e[90]||(e[90]=t("span",{class:"cell-label"},"地区",-1)),t("span",yl,u(((be=d.value.session.ip_info)==null?void 0:be.region)||"无"),1)]),t("div",bl,[e[91]||(e[91]=t("span",{class:"cell-label"},"城市",-1)),t("span",xl,u(((xe=d.value.session.ip_info)==null?void 0:xe.city)||"无"),1)]),t("div",hl,[e[92]||(e[92]=t("span",{class:"cell-label"},"ISP",-1)),t("span",wl,u(((ns=d.value.session.ip_info)==null?void 0:ns.isp)||"无"),1)])]),t("div",kl,[t("div",ql,[e[93]||(e[93]=t("span",{class:"cell-label"},"客户端ID",-1)),t("span",$l,u(d.value.session.client_id),1)]),t("div",Cl,[e[94]||(e[94]=t("span",{class:"cell-label"},"IP地址",-1)),t("span",Sl,u(d.value.session.ip_address),1)]),t("div",Pl,[e[95]||(e[95]=t("span",{class:"cell-label"},"连接状态",-1)),c(o(h),{type:d.value.session.is_connected?"success":"default",size:"small"},{default:p(()=>[g(u(d.value.session.is_connected?"在线":"离线"),1)]),_:1},8,["type"])])]),t("div",Dl,[t("div",Tl,[e[96]||(e[96]=t("span",{class:"cell-label"},"会话ID",-1)),t("span",Il,u(d.value.session.session_id),1)])]),t("div",zl,[t("div",Ul,[e[97]||(e[97]=t("span",{class:"cell-label"},"页面URL",-1)),t("span",Nl,u(d.value.session.page_url),1)])]),t("div",Ol,[t("div",Ll,[e[98]||(e[98]=t("span",{class:"cell-label"},"页面标题",-1)),t("span",Rl,u(d.value.session.page_title),1)])]),t("div",El,[t("div",jl,[e[99]||(e[99]=t("span",{class:"cell-label"},"用户代理",-1)),t("span",Ml,u(d.value.session.user_agent||"无"),1)])])])])):(x(),P("div",Al,[c(o(Pt),{size:"large"})]))]}),_:1},8,["show","title"]),c(o(K),{show:$e.value,"onUpdate:show":e[19]||(e[19]=a=>$e.value=a),preset:"dialog",title:"添加备注","positive-text":"提交","negative-text":"取消",onPositiveClick:qs},{default:p(()=>[c(o(L),{value:ye.value,"onUpdate:value":e[18]||(e[18]=a=>ye.value=a),type:"textarea",placeholder:"请输入备注内容",rows:4},null,8,["value"])]),_:1},8,["show"]),c(o(K),{show:Ce.value,"onUpdate:show":e[23]||(e[23]=a=>Ce.value=a),preset:"dialog",title:"OTP验证","positive-text":"发送","negative-text":"取消",onPositiveClick:Cs},{default:p(()=>[t("div",Vl,[t("div",Hl,[c(o(I),null,{default:p(()=>e[100]||(e[100]=[g("短信验证引导")])),_:1})]),pe.value?(x(),P("div",Bl,[c(n,{value:pe.value,"onUpdate:value":e[20]||(e[20]=a=>pe.value=a)},null,8,["value"]),c(o(I),{class:"ml-2"},{default:p(()=>e[101]||(e[101]=[g("自定义文案")])),_:1})])):k("",!0),pe.value?(x(),P("div",Wl,[c(o(L),{value:ue.value,"onUpdate:value":e[22]||(e[22]=a=>ue.value=a),type:"textarea",placeholder:"请输入自定义验证文案",rows:4},null,8,["value"])])):(x(),P("div",Fl,[c(o(L),{value:ue.value,"onUpdate:value":e[21]||(e[21]=a=>ue.value=a),placeholder:"请输入手机号格式（默认是后3-4位）"},null,8,["value"])]))])]),_:1},8,["show"]),c(o(K),{show:Se.value,"onUpdate:show":e[27]||(e[27]=a=>Se.value=a),preset:"dialog",title:"邮箱OTP验证","positive-text":"发送","negative-text":"取消",onPositiveClick:Ps},{default:p(()=>[t("div",Ql,[t("div",Jl,[c(o(I),null,{default:p(()=>e[102]||(e[102]=[g("邮箱验证引导")])),_:1})]),ve.value?(x(),P("div",Kl,[c(n,{value:ve.value,"onUpdate:value":e[24]||(e[24]=a=>ve.value=a)},null,8,["value"]),c(o(I),{class:"ml-2"},{default:p(()=>e[103]||(e[103]=[g("自定义文案")])),_:1})])):k("",!0),ve.value?(x(),P("div",Yl,[c(o(L),{value:de.value,"onUpdate:value":e[26]||(e[26]=a=>de.value=a),type:"textarea",placeholder:"请输入自定义验证文案",rows:4},null,8,["value"])])):(x(),P("div",Gl,[c(o(L),{value:de.value,"onUpdate:value":e[25]||(e[25]=a=>de.value=a),placeholder:"请输入邮箱（格式：a***@xxx.com），或者根据使用场景来填写"},null,8,["value"])]))])]),_:1},8,["show"]),c(o(K),{show:Pe.value,"onUpdate:show":e[30]||(e[30]=a=>Pe.value=a),preset:"dialog",title:"PIN验证","positive-text":"发送","negative-text":"取消",onPositiveClick:Ts},{default:p(()=>[t("div",Zl,[t("div",Xl,[c(o(I),null,{default:p(()=>e[104]||(e[104]=[g("PIN验证引导")])),_:1})]),fe.value?(x(),P("div",ei,[c(n,{value:fe.value,"onUpdate:value":e[28]||(e[28]=a=>fe.value=a)},null,8,["value"]),c(o(I),{class:"ml-2"},{default:p(()=>e[105]||(e[105]=[g("自定义文案")])),_:1})])):k("",!0),fe.value?(x(),P("div",si,[c(o(L),{value:ze.value,"onUpdate:value":e[29]||(e[29]=a=>ze.value=a),type:"textarea",placeholder:"请输入自定义验证文案",rows:4},null,8,["value"])])):k("",!0)])]),_:1},8,["show"]),c(o(K),{show:De.value,"onUpdate:show":e[33]||(e[33]=a=>De.value=a),preset:"dialog",title:"APP验证","positive-text":"发送","negative-text":"取消",onPositiveClick:zs},{default:p(()=>[t("div",ti,[t("div",ai,[c(o(I),null,{default:p(()=>e[106]||(e[106]=[g("APP验证引导")])),_:1})]),ge.value?(x(),P("div",li,[c(n,{value:ge.value,"onUpdate:value":e[31]||(e[31]=a=>ge.value=a)},null,8,["value"]),c(o(I),{class:"ml-2"},{default:p(()=>e[107]||(e[107]=[g("自定义文案")])),_:1})])):k("",!0),ge.value?(x(),P("div",ii,[c(o(L),{value:Ue.value,"onUpdate:value":e[32]||(e[32]=a=>Ue.value=a),type:"textarea",placeholder:"请输入自定义验证文案",rows:4},null,8,["value"])])):k("",!0)])]),_:1},8,["show"]),c(o(K),{show:Te.value,"onUpdate:show":e[35]||(e[35]=a=>Te.value=a),preset:"dialog",title:"拒绝支付","positive-text":"发送","negative-text":"取消",onPositiveClick:Ns},{default:p(()=>[t("div",ni,[c(o(I),null,{default:p(()=>e[108]||(e[108]=[g("自定义拒绝文案")])),_:1})]),c(o(L),{value:Ne.value,"onUpdate:value":e[34]||(e[34]=a=>Ne.value=a),type:"textarea",placeholder:"不输入则显示系统默认(支持HTML标签)",rows:4},null,8,["value"])]),_:1},8,["show"]),c(o(K),{show:Ie.value,"onUpdate:show":e[39]||(e[39]=a=>Ie.value=a),preset:"dialog",title:"断开并拉黑","positive-text":"确认拉黑","negative-text":"取消",onPositiveClick:Rs},{default:p(()=>[t("div",oi,[t("div",null,[c(o(I),{class:"mb-2 block"},{default:p(()=>e[109]||(e[109]=[g("黑名单类型")])),_:1}),c(o(ae),{value:A.blacklist_type,"onUpdate:value":e[36]||(e[36]=a=>A.blacklist_type=a),options:gs,placeholder:"选择黑名单类型"},null,8,["value"])]),t("div",null,[c(o(I),{class:"mb-2 block"},{default:p(()=>e[110]||(e[110]=[g("重定向URL（可选）")])),_:1}),c(o(L),{value:A.redirect_url,"onUpdate:value":e[37]||(e[37]=a=>A.redirect_url=a),placeholder:"留空使用默认跳转页面"},null,8,["value"])]),t("div",null,[c(o(I),{class:"mb-2 block"},{default:p(()=>e[111]||(e[111]=[g("备注说明")])),_:1}),c(o(L),{value:A.notes,"onUpdate:value":e[38]||(e[38]=a=>A.notes=a),type:"textarea",placeholder:"请输入拉黑原因或备注信息",rows:4},null,8,["value"])])])]),_:1},8,["show"]),c(o(K),{show:qe.value,"onUpdate:show":e[40]||(e[40]=a=>qe.value=a),preset:"card",title:"卡片模拟图",style:{width:"600px"},"mask-closable":!0},{default:p(()=>{var a,r,v,y,b,$,z,U,E,M,H,B,F,W,Q,J;return[N.value?(x(),P("div",ri,[t("div",ci,[t("div",ui,[e[112]||(e[112]=t("div",{class:"chip-logo"},[t("div",{class:"chip"})],-1)),t("div",di,[t("img",{src:Ye(N.value.card_type),alt:Ze(N.value.card_type),class:"brand-logo"},null,8,pi)])]),t("div",vi,u(N.value.card_number?N.value.card_number.replace(/(\d{4})(?=\d)/g,"$1 "):"5144 4024 6292 7009"),1),t("div",fi,[t("div",gi,[e[113]||(e[113]=t("div",{class:"label"},"Card Holder",-1)),t("div",mi,u(N.value.card_holder||"Adrian Orbe"),1)]),t("div",_i,[e[114]||(e[114]=t("div",{class:"label"},"Expires",-1)),t("div",yi,u(N.value.expiry_date||"09/26"),1)]),t("div",bi,[e[115]||(e[115]=t("div",{class:"label"},"CVV",-1)),t("div",xi,u(N.value.cvv||"825"),1)])])]),(a=N.value)!=null&&a.card_info?(x(),P("div",hi,[e[121]||(e[121]=t("h3",null,"🏦 Card Info 详细信息",-1)),t("div",wi,[t("div",ki,[e[116]||(e[116]=t("span",{class:"info-label"},"🔢 BIN",-1)),t("span",qi,u(((v=(r=N.value)==null?void 0:r.card_info)==null?void 0:v.bin)||"未知"),1)]),t("div",$i,[e[117]||(e[117]=t("span",{class:"info-label"},"🏷️ 品牌",-1)),t("span",Ci,u(((b=(y=N.value)==null?void 0:y.card_info)==null?void 0:b.brand)||"未知"),1)]),t("div",Si,[e[118]||(e[118]=t("span",{class:"info-label"},"💳 卡片类型",-1)),t("span",Pi,u(((z=($=N.value)==null?void 0:$.card_info)==null?void 0:z.card_type)||"未知"),1)]),t("div",Di,[e[119]||(e[119]=t("span",{class:"info-label"},"🌐 国家",-1)),t("span",Ti,u(((M=(E=(U=N.value)==null?void 0:U.card_info)==null?void 0:E.country)==null?void 0:M.name)||"未知")+" "+u(((F=(B=(H=N.value)==null?void 0:H.card_info)==null?void 0:B.country)==null?void 0:F.emoji)||""),1)]),t("div",Ii,[e[120]||(e[120]=t("span",{class:"info-label"},"🏛️ 银行",-1)),t("span",zi,u(((J=(Q=(W=N.value)==null?void 0:W.card_info)==null?void 0:Q.bank)==null?void 0:J.name)||"未知"),1)])])])):k("",!0)])):k("",!0)]}),_:1},8,["show"]),c(o(K),{show:ke.value,"onUpdate:show":e[44]||(e[44]=a=>ke.value=a),preset:"dialog",title:"导出支付请求数据","positive-text":"开始导出","negative-text":"取消","positive-button-props":{loading:Ee.value},style:{width:"600px"},onPositiveClick:_t},{default:p(()=>[t("div",Ui,[t("div",Ni,[e[122]||(e[122]=t("h4",null,"导出模式",-1)),c(o(ae),{value:_.export_mode,"onUpdate:value":e[41]||(e[41]=a=>_.export_mode=a),options:We,placeholder:"选择导出模式"},null,8,["value"]),t("div",Oi,[c(o(I),{depth:"3",style:{"font-size":"12px"}},{default:p(()=>{var a;return[g(u((a=We.find(r=>r.value===_.export_mode))==null?void 0:a.description),1)]}),_:1})])]),t("div",Li,[e[123]||(e[123]=t("h4",null,"导出格式",-1)),c(o(ae),{value:_.format,"onUpdate:value":e[42]||(e[42]=a=>_.format=a),options:us,placeholder:"选择导出格式"},null,8,["value"])]),t("div",Ri,[e[125]||(e[125]=t("h4",null,"额外筛选",-1)),c(o(he),{vertical:""},{default:p(()=>[t("div",null,[c(o(I),null,{default:p(()=>e[124]||(e[124]=[g("卡片类型：")])),_:1}),c(o(ae),{value:_.card_type,"onUpdate:value":e[43]||(e[43]=a=>_.card_type=a),options:ds,placeholder:"选择卡片类型",style:{width:"200px","margin-left":"8px"},clearable:""},null,8,["value"])])]),_:1})]),t("div",Ei,[e[127]||(e[127]=t("h4",null,"当前搜索条件",-1)),t("div",ji,[_.status?(x(),Y(o(h),{key:0,type:"info",size:"small"},{default:p(()=>{var a;return[g(" 状态: "+u(((a=ce[_.status])==null?void 0:a.label)||_.status),1)]}),_:1})):k("",!0),_.is_completed!==void 0?(x(),Y(o(h),{key:1,type:"info",size:"small"},{default:p(()=>[g(" 完成状态: "+u(_.is_completed?"已完成":"未完成"),1)]),_:1})):k("",!0),_.success!==void 0?(x(),Y(o(h),{key:2,type:"info",size:"small"},{default:p(()=>[g(" 成功状态: "+u(_.success?"成功":"失败"),1)]),_:1})):k("",!0),_.user_uuid?(x(),Y(o(h),{key:3,type:"info",size:"small"},{default:p(()=>[g("用户UUID: "+u(_.user_uuid),1)]),_:1})):k("",!0),_.client_id?(x(),Y(o(h),{key:4,type:"info",size:"small"},{default:p(()=>[g("客户端ID: "+u(_.client_id),1)]),_:1})):k("",!0),_.ip_address?(x(),Y(o(h),{key:5,type:"info",size:"small"},{default:p(()=>[g("IP地址: "+u(_.ip_address),1)]),_:1})):k("",!0),_.start_date?(x(),Y(o(h),{key:6,type:"info",size:"small"},{default:p(()=>[g(" 开始时间: "+u(new Date(_.start_date).toLocaleString()),1)]),_:1})):k("",!0),_.end_date?(x(),Y(o(h),{key:7,type:"info",size:"small"},{default:p(()=>[g(" 结束时间: "+u(new Date(_.end_date).toLocaleString()),1)]),_:1})):k("",!0),Object.values(_).some(a=>a!==void 0&&a!=="")?k("",!0):(x(),Y(o(I),{key:8,depth:"3"},{default:p(()=>e[126]||(e[126]=[g(" 无筛选条件，将导出所有数据 ")])),_:1}))])]),t("div",Mi,[c(o(he),null,{default:p(()=>[c(o(te),{size:"small",type:"tertiary",onClick:yt},{default:p(()=>e[128]||(e[128]=[g("重置配置")])),_:1})]),_:1})])])]),_:1},8,["show","positive-button-props"]),c(o(K),{show:Oe.value,"onUpdate:show":e[48]||(e[48]=a=>Oe.value=a),preset:"dialog",title:"快速添加卡头备注","positive-text":"确定","negative-text":"取消",onPositiveClick:st},{default:p(()=>[t("div",Ai,[t("div",null,[c(o(I),{class:"mb-2 block"},{default:p(()=>e[129]||(e[129]=[g("卡号")])),_:1}),c(o(L),{value:Ke.value,disabled:"",placeholder:"当前选择的卡号"},null,8,["value"])]),t("div",null,[c(o(I),{class:"mb-2 block"},{default:p(()=>e[130]||(e[130]=[g("卡头 *")])),_:1}),c(o(L),{value:V.card_prefix,"onUpdate:value":e[45]||(e[45]=a=>V.card_prefix=a),placeholder:"系统自动提取，可手动调整",maxlength:"8"},null,8,["value"]),c(o(I),{depth:"3",class:"mt-1 text-sm"},{default:p(()=>e[131]||(e[131]=[g("卡头必须是6-8位数字，系统已自动提取前6位")])),_:1})]),t("div",null,[c(o(I),{class:"mb-2 block"},{default:p(()=>e[132]||(e[132]=[g("备注内容 *")])),_:1}),c(o(L),{value:V.note_content,"onUpdate:value":e[46]||(e[46]=a=>V.note_content=a),type:"textarea",placeholder:"请输入备注内容",rows:3,maxlength:"200","show-count":""},null,8,["value"])]),t("div",null,[c(o(I),{class:"mb-2 block"},{default:p(()=>e[133]||(e[133]=[g("标签颜色")])),_:1}),c(o(ae),{value:V.tag_color,"onUpdate:value":e[47]||(e[47]=a=>V.tag_color=a),options:Je.value.map(a=>({label:a.name,value:a.value,color:a.color})),placeholder:"选择标签颜色"},null,8,["value","options"])])])]),_:1},8,["show"])])}}}),sn=Tt(Hi,[["__scopeId","data-v-ee48331a"]]);export{sn as default};
