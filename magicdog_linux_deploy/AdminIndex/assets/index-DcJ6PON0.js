import{_ as Ci}from"./web-site-link.vue_vue_type_script_setup_true_lang-607Cr3D8.js";import{V as yi}from"./vchart-all-DvUAL5Dt.js";import{d as ot,r as Re,c4 as Pt,a as De,i as jt,aR as pi,ak as Ft,o as Ke,b as Ne,C as tt,dJ as St,f as L,a3 as bt,ct as It,J as Ye,y as mi,w as fe,h as B,I as ht,H as fi,c as ut}from"./index-D2aSDdb8.js";import{m as Me,t as ct,n as Oe,o as _i,p as wi,q as ge,r as ce,i as O,s as it,H as Qe,u as Hi,w as Je,F as Le,x as Ti,y as Pi,z as Si,A as bi,E as Ii,J as Ri,K as Di,M as At,N as Kt,O as vt,Q as ie,R as Fi,U as Ai,V as Ki,W as Li,X as xi,Y as Mi,Z as Oi,_ as Ei,$ as gt,a0 as Ni,a1 as Bi,a2 as Wt,a3 as mt,a4 as nt,a5 as Lt,a6 as Ae,a7 as Vi,a8 as st,a9 as Ct,aa as lt,ab as Xe,ac as Ut,ad as zi,ae as xt,af as Mt,ag as Ot,ah as qt,ai as Gt,aj as Qt,ak as Jt,al as $t,am as Yt,an as Xt,ao as Zt,ap as ei,aq as ti,ar as ii,as as oi,at as ri,au as si,av as ki,aw as Ge,ax as rt,ay as Et,az as ji,aA as Wi,I as Ui,T as qi,aB as Gi,G as Qi,aC as Ji,aD as $i,aE as Yi,j as ft,aF as Xi,l as Ze,D as et}from"./index-CRBF8eDz.js";import{N as Zi}from"./Space-DZKXzBSy.js";import"./linear-scale-CDu5-9kW.js";import"./index-CKWWhdKr.js";import"./get-slot-Bk_rJcZu.js";function eo(D,e,t,i,o,r){const n=r.columnHeaderLevelCount,s=[],l=[];for(let c=0;c<t.length;c++)i.includes(t[c])||l.push(o[c]);for(let c=0;c<i.length;c++)if(!t.includes(i[c])){const u={col:D,row:n+c};s.push(u)}let d=r.getParentCellId(D,e),a=r.getRowHeaderCellAddressByCellId(d);const h=[];for(a&&h.push(a);d;)d=r.getParentCellId(a.col,a.row),d&&(a=r.getRowHeaderCellAddressByCellId(d),h.push(a));return{addCellPositions:s,removeCellPositions:l,updateCellPositions:h}}const Nt={startInTotal:0,level:0};class Ee{constructor(e,t,i,o){var r,n,s,l,d,a,h,c,u,v,g,m,y,_,S,P,f;this.colIndex=0,this._showHeader=!0,this.columnHeaderObjs=[],this.rowHeaderObjs=[],this._cornerHeaderCellFullPathIds=[],this._columnHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds_FULL=[],this._cornerHeaderCellIds=[],this._columnHeaderCellIds=[],this._rowHeaderCellIds=[],this._rowHeaderCellIds_FULL=[],this._columnWidths=[],this.columnPaths=[],this._headerObjects=[],this._headerObjectMap={},this._indicators=[],this.indicatorsAsCol=!0,this.hideIndicatorName=!1,this._showRowHeader=!0,this._showColumnHeader=!0,this._indicatorShowType="column",this.rowHierarchyTextStartAlignment=!1,this.rowDimensionKeys=[],this.colDimensionKeys=[],this.indicatorKeys=[],this.indicatorDimensionKey=Me,this._rowHeaderExtensionTree={},this._extensionRowDimensionKeys=[],this.fullRowDimensionKeys=[],this.leftRowSeriesNumberColumnCount=0,this.rightRowSeriesNumberColumnCount=0,this._useGetBodyCache=!1,this._getBodyCache=new Map,this._useHeaderPathCache=!1,this._colHeaderPathCache=new Map,this._rowHeaderPathCache=new Map,this.sharedVar=e.layoutNodeId,this._table=e,e.options.rowHierarchyType==="tree"&&(this.extensionRows=e.options.extensionRows),this.dataset=t,this._largeCellRangeCache=[],this._CellHeaderPathMap=new Map,this.rowTree=e.internalProps.rowTree,this.columnTree=e.internalProps.columnTree,this.rowsDefine=(r=e.internalProps.rows)!==null&&r!==void 0?r:[],this.columnsDefine=(n=e.internalProps.columns)!==null&&n!==void 0?n:[],this.indicatorsDefine=(s=e.internalProps.indicators)!==null&&s!==void 0?s:[],this.indicatorTitle=e.options.indicatorTitle,this.indicatorsAsCol=(l=e.options.indicatorsAsCol)===null||l===void 0||l,this.hideIndicatorName=(d=e.options.hideIndicatorName)!==null&&d!==void 0&&d,this.showRowHeader=(a=e.options.showRowHeader)===null||a===void 0||a,this.showColumnHeader=(h=e.options.showColumnHeader)===null||h===void 0||h,this.rowHeaderTitle=e.options.rowHeaderTitle,this.columnHeaderTitle=e.options.columnHeaderTitle,this.rowHierarchyType=(c=e.options.rowHierarchyType)!==null&&c!==void 0?c:"grid",this.rowExpandLevel=(u=e.options.rowExpandLevel)!==null&&u!==void 0?u:1,this.rowHierarchyIndent=(v=e.options.rowHierarchyIndent)!==null&&v!==void 0?v:20,this.rowHierarchyTextStartAlignment=e.options.rowHierarchyTextStartAlignment,this.cornerSetting=Object.assign({titleOnDimension:"column",forceShowHeader:!1},e.options.corner),t&&(this.rowTree=t.rowHeaderTree,this.columnTree=t.colHeaderTree),(g=this.indicatorsDefine)===null||g===void 0||g.forEach(C=>{typeof C=="string"?this.indicatorKeys.push(C):this.indicatorKeys.push(C.indicatorKey)}),this.columnDimensionTree=i,this.rowDimensionTree=o,this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),this.resetRowHeaderLevelCount(),this._table.isPivotChart()&&(this.hasTwoIndicatorAxes=this.indicatorsDefine.some(C=>{var T,H;if(C.chartSpec&&C.chartSpec.series&&C.chartSpec.series.length>1){const b=(H=(T=C.chartSpec.axes)!==null&&T!==void 0?T:this._table.pivotChartAxes)!==null&&H!==void 0?H:[];if(!b.length||b.every(x=>x.orient!==(this.indicatorsAsCol?"top":"right")||x.visible!==!1))return!0}return!1})),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=ct(this._rowHeaderCellFullPathIds_FULL),e.options.rowHierarchyType==="tree"&&((m=this.extensionRows)===null||m===void 0?void 0:m.length)>=1&&(this.generateExtensionRowTree(),this.extensionRows.forEach(C=>{const T=[];C.rows.forEach(H=>{typeof H=="string"?T.push(H):T.push(H.dimensionKey)}),this._extensionRowDimensionKeys.push(T),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(T)})),this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);let p,I=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr();!this.dataset||this._table.isPivotChart()||((_=(y=this.dataset.records)===null||y===void 0?void 0:y.length)!==null&&_!==void 0?_:0)!==0||this.dataset.customColTree||(I=this.columnsDefine.map(C=>typeof C=="string"?C:C.dimensionKey),this.indicatorsAsCol&&I.push(this.indicatorDimensionKey)),I=this.columnHeaderTitle?[""].concat(I):I;let w=[];if(this.rowHierarchyType==="tree"&&((S=this.extensionRows)===null||S===void 0?void 0:S.length)>=1){const C=[];C.push(this.rowDimensionKeys[0]),this._extensionRowDimensionKeys.forEach(T=>{C.push(T[0])}),w=this.extensionRows.reduce((T,H)=>T.concat(H.rows),[]),p=this.rowHeaderTitle?[""].concat(C):C}else p=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),!this.dataset||this._table.isPivotChart()||((f=(P=this.dataset.records)===null||P===void 0?void 0:P.length)!==null&&f!==void 0?f:0)!==0||this.dataset.customRowTree||(p=this.rowsDefine.map(C=>typeof C=="string"?C:C.dimensionKey),this.indicatorsAsCol||p.push(this.indicatorDimensionKey)),p=this.rowHeaderTitle?[""].concat(p):p;this.cornerHeaderObjs=this._addCornerHeaders(I,p,this.columnsDefine.concat(...this.rowsDefine,...w)),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((C,T)=>(C[T.id]=T,C),{}),this.indicatorsAsCol&&!this.hideIndicatorName?this._indicatorShowType="column":this.indicatorsAsCol||this.hideIndicatorName?this._indicatorShowType="none":this._indicatorShowType="row",this.generateCellIdsConsiderHideHeader(),this.setPagination(e.options.pagination),this._table.isPivotChart()&&(this._chartItemSpanSize=0,this._chartItemBandSize=0,this._indicators.find(C=>{var T,H,b,x,A,E,Q,J;!((T=C==null?void 0:C.style)===null||T===void 0)&&T.padding&&(this._chartPadding=C.style.padding),!((H=C.chartSpec)===null||H===void 0)&&H.barWidth&&typeof C.chartSpec.barWidth=="number"&&(this._chartItemSpanSize=(b=C.chartSpec)===null||b===void 0?void 0:b.barWidth);const U=(A=(x=C.chartSpec)===null||x===void 0?void 0:x.axes)===null||A===void 0?void 0:A.find(X=>X.type==="band");return U!=null&&U.bandSize&&(this._chartItemBandSize=U==null?void 0:U.bandSize,this._chartPaddingInner=(E=Oe(U.paddingInner)?U.paddingInner[0]:U.paddingInner)!==null&&E!==void 0?E:0,this._chartPaddingOuter=(Q=Oe(U.paddingOuter)?U.paddingOuter[0]:U.paddingOuter)!==null&&Q!==void 0?Q:0),this._chartItemSpanSize>0||((J=C.chartSpec.series)===null||J===void 0||J.find(X=>(X.barWidth&&typeof X.barWidth=="number"&&(this._chartItemSpanSize=X.barWidth),this._chartItemSpanSize>0)),!1)})),this.handleRowSeriesNumber(e.internalProps.rowSeriesNumber),this.setColumnWidths()}handleRowSeriesNumber(e){var t,i;e&&(Array.isArray(e)?this.rowSeriesNumberColumn=e.map(o=>{var r,n;return{id:"",title:o.title,define:o,cellType:(r=o.cellType)!==null&&r!==void 0?r:"text",headerType:(n=o.cellType)!==null&&n!==void 0?n:"text",width:o.width,style:o.style,format:o.format,field:o.field,icon:o.icon}}):this.rowSeriesNumberColumn=[{id:"",title:e.title,define:e,cellType:(t=e.cellType)!==null&&t!==void 0?t:"text",headerType:(i=e.cellType)!==null&&i!==void 0?i:"text",style:e.style,width:e.width,format:e.format,field:"",icon:e.icon,isChildNode:!1}],this.leftRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(o=>!0),this.rightRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(o=>!1),this.leftRowSeriesNumberColumnCount=this.leftRowSeriesNumberColumn.length,this.rightRowSeriesNumberColumnCount=this.rightRowSeriesNumberColumn.length)}_generateColHeaderIds(){var e,t,i,o,r,n,s,l;if(((e=this.columnDimensionTree.tree.children)===null||e===void 0?void 0:e.length)>=1){let d=0;if(this.dataset&&!this._table.isPivotChart()&&((i=(t=this.dataset.records)===null||t===void 0?void 0:t.length)!==null&&i!==void 0?i:0)===0&&!this.dataset.customColTree&&!this.dataset.customRowTree&&this.indicatorsAsCol&&this.columnDimensionTree.totalLevel<this.columnHeaderLevelCount){d=this.columnHeaderLevelCount-this.columnDimensionTree.totalLevel;for(let a=0;a<d;a++)this._columnHeaderCellFullPathIds.unshift([])}this._addHeaders(this._columnHeaderCellFullPathIds,d,this.columnDimensionTree.tree.children,[],this.columnHeaderObjs)}if(this.columnHeaderTitle){this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);const d=++this.sharedVar.seqId,a=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(d);this._columnHeaderCellFullPathIds.unshift(a);const h={id:d,title:typeof this.columnHeaderTitle.title=="string"?this.columnHeaderTitle.title:this.columnsDefine.reduce((c,u)=>typeof u=="string"?c:c+(c?`/${u.title}`:`${u.title}`),""),field:void 0,headerType:(r=(o=this.columnHeaderTitle)===null||o===void 0?void 0:o.headerType)!==null&&r!==void 0?r:"text",style:(n=this.columnHeaderTitle)===null||n===void 0?void 0:n.headerStyle,define:{id:d,disableHeaderHover:!!(!((s=this.columnHeaderTitle)===null||s===void 0)&&s.disableHeaderHover),disableHeaderSelect:!!(!((l=this.columnHeaderTitle)===null||l===void 0)&&l.disableHeaderSelect)}};this.columnHeaderObjs.push(h),this._headerObjects[d]=h}}_generateRowHeaderIds(){var e,t,i,o,r,n,s,l,d,a;if(((e=this.rowDimensionTree.tree.children)===null||e===void 0?void 0:e.length)>=1)if(this.rowHierarchyType==="tree")this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs);else{let h=0;if(this.dataset&&!this._table.isPivotChart()&&((i=(t=this.dataset.records)===null||t===void 0?void 0:t.length)!==null&&i!==void 0?i:0)===0&&!this.dataset.customColTree&&!this.dataset.customRowTree&&!this.indicatorsAsCol&&this.rowDimensionTree.totalLevel<this.rowHeaderLevelCount){h=this.rowHeaderLevelCount-this.rowDimensionTree.totalLevel;for(let c=0;c<h;c++)this._rowHeaderCellFullPathIds_FULL.unshift([])}this._addHeaders(this._rowHeaderCellFullPathIds_FULL,h,this.rowDimensionTree.tree.children,[],this.rowHeaderObjs)}if(this.rowHeaderTitle){this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);const h=++this.sharedVar.seqId,c=Array((r=(o=this._rowHeaderCellFullPathIds_FULL[0])===null||o===void 0?void 0:o.length)!==null&&r!==void 0?r:this.rowDimensionTree.tree.size).fill(h);this._rowHeaderCellFullPathIds_FULL.unshift(c);const u={id:h,title:typeof this.rowHeaderTitle.title=="string"?this.rowHeaderTitle.title:this.rowsDefine.reduce((v,g)=>typeof g=="string"?v:v+(v?`/${g.title}`:`${g.title}`),""),field:void 0,headerType:(s=(n=this.rowHeaderTitle)===null||n===void 0?void 0:n.headerType)!==null&&s!==void 0?s:"text",style:(l=this.rowHeaderTitle)===null||l===void 0?void 0:l.headerStyle,define:{id:h,disableHeaderHover:!!(!((d=this.rowHeaderTitle)===null||d===void 0)&&d.disableHeaderHover),disableHeaderSelect:!!(!((a=this.rowHeaderTitle)===null||a===void 0)&&a.disableHeaderSelect)}};this.rowHeaderObjs.push(u),this._headerObjects[h]=u}}_addHeaders(e,t,i,o,r){const n=this;e[t]||function(s){const l=e[s]=[];if(n.colIndex===0)return l;const d=e[s-1];for(let a=0;a<(d==null?void 0:d.length);a++)l[a]=d[a]}(t);for(let s=0;s<i.length;s++){const l=i[s];_i(l,e,r,o,t,this)}}_addHeadersForTreeMode(e,t,i,o,r,n,s,l){const d=this;e[t]||function(a){const h=e[a]=[];if(d.colIndex===0)return h;const c=e[a-1];for(let u=0;u<(c==null?void 0:c.length);u++)h[u]=c[u]}(t);for(let a=0;a<i.length;a++){const h=i[a];wi(h,e,l,o,t,r,n,s,this)}}_addCornerHeaders(e,t,i){var o,r;const n=[];if(this.cornerSetting.titleOnDimension==="all")if(this.indicatorsAsCol){let s=-1;e&&e.forEach((l,d)=>{var a,h;l===this.indicatorDimensionKey&&(s=d);const c=++this.sharedVar.seqId,u=i.find(g=>typeof g!="string"&&g.dimensionKey===l),v={id:c,title:l===this.indicatorDimensionKey?this.indicatorTitle:u?u.title:l==="axis"?"":l,field:l,style:this.cornerSetting.headerStyle,headerType:(a=this.cornerSetting.headerType)!==null&&a!==void 0?a:"text",showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,define:{showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,dimensionKey:l,id:c,value:l,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:u==null?void 0:u.cornerDropDownMenu,headerIcon:u==null?void 0:u.cornerHeaderIcon,pivotInfo:{value:(h=u==null?void 0:u.title)!==null&&h!==void 0?h:"",dimensionKey:l,isPivotCorner:!0},description:u==null?void 0:u.cornerDescription};n[c]=v,this._headerObjects[c]=v,this._cornerHeaderCellFullPathIds[d]||(this._cornerHeaderCellFullPathIds[d]=[]);for(let g=0;g<this.rowHeaderLevelCount;g++)this._cornerHeaderCellFullPathIds[d][g]=c}),t&&t.forEach((l,d)=>{var a,h;const c=++this.sharedVar.seqId,u=i.find(g=>typeof g!="string"&&g.dimensionKey===l),v={id:c,title:l===this.indicatorDimensionKey?this.indicatorTitle:u?u.title:l==="axis"?"":l,field:l,style:this.cornerSetting.headerStyle,headerType:(a=this.cornerSetting.headerType)!==null&&a!==void 0?a:"text",showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,define:{showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,dimensionKey:l,id:c,value:l,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:u==null?void 0:u.cornerDropDownMenu,headerIcon:u==null?void 0:u.cornerHeaderIcon,pivotInfo:{value:(h=u==null?void 0:u.title)!==null&&h!==void 0?h:"",dimensionKey:l,isPivotCorner:!0},description:u==null?void 0:u.cornerDescription};n[c]=v,this._headerObjects[c]=v,this._cornerHeaderCellFullPathIds[s]||(this._cornerHeaderCellFullPathIds[s]=[]),this._cornerHeaderCellFullPathIds[s][d]=c})}else{let s=-1;t&&t.forEach((l,d)=>{var a,h;l===this.indicatorDimensionKey&&(s=d);const c=++this.sharedVar.seqId,u=i.find(g=>typeof g!="string"&&g.dimensionKey===l),v={id:c,title:l===this.indicatorDimensionKey?this.indicatorTitle:u?u.title:l==="axis"?"":l,field:l,style:this.cornerSetting.headerStyle,headerType:(a=this.cornerSetting.headerType)!==null&&a!==void 0?a:"text",showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,define:{showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,dimensionKey:l,id:c,value:l,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:u==null?void 0:u.cornerDropDownMenu,headerIcon:u==null?void 0:u.cornerHeaderIcon,pivotInfo:{value:(h=u==null?void 0:u.title)!==null&&h!==void 0?h:"",dimensionKey:l,isPivotCorner:!0},description:u==null?void 0:u.cornerDescription};n[c]=v,this._headerObjects[c]=v;for(let g=0;g<this.columnHeaderLevelCount;g++)this._cornerHeaderCellFullPathIds[g]||(this._cornerHeaderCellFullPathIds[g]=[]),this._cornerHeaderCellFullPathIds[g][d]=c}),e&&e.forEach((l,d)=>{var a,h;const c=++this.sharedVar.seqId,u=i.find(g=>typeof g!="string"&&g.dimensionKey===l),v={id:c,title:l===this.indicatorDimensionKey?this.indicatorTitle:u?u.title:l==="axis"?"":l,field:l,style:this.cornerSetting.headerStyle,headerType:(a=this.cornerSetting.headerType)!==null&&a!==void 0?a:"text",showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,define:{showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,dimensionKey:l,id:c,value:l,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:u==null?void 0:u.cornerDropDownMenu,headerIcon:u==null?void 0:u.cornerHeaderIcon,pivotInfo:{value:(h=u==null?void 0:u.title)!==null&&h!==void 0?h:"",dimensionKey:l,isPivotCorner:!0},description:u==null?void 0:u.cornerDescription};n[c]=v,this._headerObjects[c]=v,this._cornerHeaderCellFullPathIds[d][s]=c})}else if(this.cornerSetting.titleOnDimension==="row"||this.cornerSetting.titleOnDimension==="column"){const s=((o=this.cornerSetting)===null||o===void 0?void 0:o.titleOnDimension)==="row"?t:e;s&&s.forEach((l,d)=>{var a,h;const c=++this.sharedVar.seqId,u=i.find(g=>typeof g!="string"&&g.dimensionKey===l),v={id:c,title:l===this.indicatorDimensionKey?this.indicatorTitle:u?u.title:l==="axis"?"":l,field:l,style:this.cornerSetting.headerStyle,headerType:(a=this.cornerSetting.headerType)!==null&&a!==void 0?a:"text",showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,define:{showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,dimensionKey:l,id:c,value:l,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:u==null?void 0:u.cornerDropDownMenu,headerIcon:u==null?void 0:u.cornerHeaderIcon,pivotInfo:{value:(h=u==null?void 0:u.title)!==null&&h!==void 0?h:"",dimensionKey:l,isPivotCorner:!0},description:u==null?void 0:u.cornerDescription};if(n[c]=v,this._headerObjects[c]=v,this.cornerSetting.titleOnDimension==="column"){this._cornerHeaderCellFullPathIds[d]||(this._cornerHeaderCellFullPathIds[d]=[]);for(let g=0;g<this.rowHeaderLevelCount;g++)this._cornerHeaderCellFullPathIds[d][g]=c}else if(this.cornerSetting.titleOnDimension==="row")for(let g=0;g<this.columnHeaderLevelCount;g++)this._cornerHeaderCellFullPathIds[g]||(this._cornerHeaderCellFullPathIds[g]=[]),this._cornerHeaderCellFullPathIds[g][d]=c})}else{const s=++this.sharedVar.seqId,l={id:s,title:"",field:"维度名称",style:this.cornerSetting.headerStyle,headerType:(r=this.cornerSetting.headerType)!==null&&r!==void 0?r:"text",define:{dimensionKey:"维度名称",id:s,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect}};n[s]=l,this._headerObjects[s]=l;for(let d=0;d<this.columnHeaderLevelCount;d++)for(let a=0;a<this.rowHeaderLevelCount;a++)this._cornerHeaderCellFullPathIds[d]||(this._cornerHeaderCellFullPathIds[d]=[]),this._cornerHeaderCellFullPathIds[d][a]=s}return n}generateExtensionRowTree(){this.extensionRows.forEach((e,t)=>{const i=this._rowHeaderCellFullPathIds_FULL;this._rowHeaderCellFullPathIds_FULL=[],i.forEach((o,r)=>{const n=o[o.length-1];let s,l;if(this.colIndex=0,typeof e.rowTree=="function"){const a=this.findFullCellIds(o);s=e.rowTree(a.map(h=>({dimensionKey:this._headerObjects[h].field,value:this._headerObjects[h].title})))}else s=ge(e.rowTree);this._rowHeaderExtensionTree[n]?(this._rowHeaderExtensionTree[n].reset(this._rowHeaderExtensionTree[n].tree.children,!0),l=this._rowHeaderExtensionTree[n]):(l=new ce(s??[],this.sharedVar,this.rowHierarchyType,void 0),this._rowHeaderExtensionTree[n]=l);const d=[];this._addHeadersForTreeMode(d,0,l.tree.children,[],l.totalLevel,!0,e.rows,this.rowHeaderObjs);for(let a=0;a<d[0].length;a++)this._rowHeaderCellFullPathIds_FULL.push(o.concat(d[0][a]))})})}setColumnWidths(){var e,t,i;const o=new Array(this.colCount).fill(void 0);if(this.leftRowSeriesNumberColumnCount&&(o[0]=this.leftRowSeriesNumberColumn[0]),this.showHeader&&this.showRowHeader)if(this.rowHeaderTitle&&(o[0+this.leftRowSeriesNumberColumnCount]={}),this.rowHierarchyType==="tree"){const r=this.rowDimensionKeys[0];if(r){const n=(e=this.rowsDefine)===null||e===void 0?void 0:e.find(s=>typeof s!="string"&&s.dimensionKey===r);n&&(o[0+(this.rowHeaderTitle?1:0)+this.leftRowSeriesNumberColumnCount]={width:n.width,minWidth:n.minWidth,maxWidth:n.maxWidth})}(t=this._extensionRowDimensionKeys)===null||t===void 0||t.forEach((n,s)=>{var l;const d=n[0];if(d){const a=(l=this.extensionRows[s].rows)===null||l===void 0?void 0:l.find(h=>typeof h!="string"&&h.dimensionKey===d);a&&(o[s+1+(this.rowHeaderTitle?1:0)+this.leftRowSeriesNumberColumnCount]={width:a.width,minWidth:a.minWidth,maxWidth:a.maxWidth})}})}else(this.rowDimensionTree.totalLevel>0?this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr():this.rowsDefine.map(r=>typeof r=="string"?r:r.dimensionKey)).forEach((r,n)=>{var s;const l=(s=this.rowsDefine)===null||s===void 0?void 0:s.find(d=>typeof d!="string"&&d.dimensionKey===r);l&&(o[n+(this.rowHeaderTitle?1:0)+this.leftRowSeriesNumberColumnCount]={width:l.width,minWidth:l.minWidth,maxWidth:l.maxWidth})});if(this.indicatorsAsCol)for(let r=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;r<this.colCount;r++){const n=this.getBody(r,this.columnHeaderLevelCount);o[r]={width:n==null?void 0:n.width,minWidth:n==null?void 0:n.minWidth,maxWidth:n==null?void 0:n.maxWidth}}else{let r,n,s,l=0;(i=this._indicators)===null||i===void 0||i.forEach((d,a)=>{var h,c;typeof d.width=="number"?l=Math.max(d.width,l):d.width==="auto"&&(s=!0),typeof d.minWidth=="number"&&(n=Math.max(d.minWidth,(h=n)!==null&&h!==void 0?h:0)),typeof d.maxWidth=="number"&&(r=Math.min(d.maxWidth,(c=r)!==null&&c!==void 0?c:Number.MAX_VALUE))}),l=l>0?l:s?"auto":void 0,o.fill({width:l,minWidth:n,maxWidth:r},this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount,this.colCount-this.rightFrozenColCount)}this._columnWidths=o}get columnWidths(){return this._columnWidths}getColumnWidthDefined(e){return this._columnWidths[e]}get showHeader(){return this._showHeader}set showHeader(e){this._showHeader=e}get showColumnHeader(){return this._showColumnHeader}set showColumnHeader(e){this._showColumnHeader=e}get showRowHeader(){return this._showRowHeader}set showRowHeader(e){this._showRowHeader=e}get columnHeaderTitle(){return this._columnHeaderTitle}set columnHeaderTitle(e){this._columnHeaderTitle=e}get rowHeaderTitle(){return this._rowHeaderTitle}set rowHeaderTitle(e){this._rowHeaderTitle=e}getHeaderFieldKey(e,t){}getCellLocation(e,t){return this.isCornerHeader(e,t)?"cornerHeader":this.isColumnHeader(e,t)?"columnHeader":this.isRowHeader(e,t)?"rowHeader":"body"}isHeader(e,t){return e>=this.leftRowSeriesNumberColumnCount&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||t>=0&&t<this.columnHeaderLevelCount||e>=this.colCount-this.rightHeaderColCount||t>=this.rowCount-this.bottomHeaderRowCount}isCornerHeader(e,t){return e>=0&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=0&&t<this.columnHeaderLevelCount}isColumnHeader(e,t){return e>=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=0&&t<this.columnHeaderLevelCount}isRowHeader(e,t){return e>=this.leftRowSeriesNumberColumnCount&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=this.columnHeaderLevelCount}isFrozen(e,t){return this.isFrozenColumn(e)||this.isRightFrozenColumn(e)||this.isBottomFrozenRow(t)||this.isFrozenRow(t)||this.isSeriesNumberInBody(e,t)||this.isSeriesNumberInHeader(e,t)}isFrozenColumn(e,t){if(O(t)){if(e>=0&&e<this.frozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.frozenColCount>0&&e>=0&&e<this.frozenColCount)return!0;return!1}isRightFrozenColumn(e,t){if(O(t)){if(e>=this.colCount-this.rightFrozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.rightFrozenColCount>0&&e>=this.colCount-this.rightFrozenColCount)return!0;return!1}isFrozenRow(e,t){if(O(t)){if(t>=0&&t<this.frozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,this.frozenRowCount>0&&t>=0&&t<this.frozenRowCount)return!0;return!1}isBottomFrozenRow(e,t){if(O(t)){if(t>=this.rowCount-this.bottomFrozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,this.bottomFrozenRowCount>0&&t>=this.rowCount-this.bottomFrozenRowCount)return!0;return!1}isLeftTopCorner(e,t){return e>=0&&e<this.frozenColCount&&t>=0&&t<this.frozenRowCount}isLeftBottomCorner(e,t){return e>=0&&e<this.frozenColCount&&t>=this.rowCount-this.bottomFrozenRowCount}isRightTopCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&t>=0&&t<this.frozenRowCount}isRightBottomCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&t>=this.rowCount-this.bottomFrozenRowCount}getColumnHeaderRange(){return{start:{col:this.rowHeaderLevelCount,row:0},end:{col:this.colCount-1,row:this.columnHeaderLevelCount-1}}}getRowHeaderRange(){return{start:{col:0,row:this.columnHeaderLevelCount},end:{col:this.rowHeaderLevelCount-1,row:this.rowCount-1}}}getCornerHeaderRange(){return{start:{col:0,row:0},end:{col:this.rowHeaderLevelCount-1,row:this.columnHeaderLevelCount-1}}}getBodyRange(){return{start:{col:this.rowHeaderLevelCount,row:this.columnHeaderLevelCount},end:{col:this.colCount-1,row:this.rowCount-1}}}resetCellIds(){}get frozenColCount(){return this._table.internalProps.frozenColCount?this.colCount>this._table.internalProps.frozenColCount?this._table.internalProps.frozenColCount:this.colCount:0}get frozenRowCount(){return this._table.internalProps.frozenRowCount?this.rowCount>=this._table.internalProps.frozenRowCount?this._table.internalProps.frozenRowCount:this.rowCount:0}get headerLevelCount(){return this.columnHeaderLevelCount}resetColumnHeaderLevelCount(){var e,t,i,o,r,n,s,l,d,a,h;if(this.showHeader&&this.showColumnHeader){if(this._table.isPivotChart()&&this.indicatorsAsCol&&!(!((t=(e=this.dataset)===null||e===void 0?void 0:e.colKeys)===null||t===void 0)&&t.length)&&((o=(i=this.columnDimensionTree)===null||i===void 0?void 0:i.tree)===null||o===void 0?void 0:o.level)===0&&!this.hasTwoIndicatorAxes)return void(this.columnHeaderLevelCount=0);let c=this.indicatorsAsCol&&this.hideIndicatorName&&this.colDimensionKeys[this.colDimensionKeys.length-1]===this.indicatorDimensionKey?this.columnDimensionTree.totalLevel-1:this.columnDimensionTree.totalLevel;return c===0&&this.dataset&&!(!((r=this.dataset.customColTree)===null||r===void 0)&&r.length)?this.cornerSetting.titleOnDimension==="row"&&this.cornerSetting.forceShowHeader?c=1:this._table.isPivotChart()||((s=(n=this.dataset.records)===null||n===void 0?void 0:n.length)!==null&&s!==void 0?s:0)!==0||this.cornerSetting.titleOnDimension!=="column"&&this.cornerSetting.titleOnDimension!=="all"||(c=(l=this.columnsDefine.length)!==null&&l!==void 0?l:0):!this.dataset||this._table.isPivotChart()||((a=(d=this.dataset.records)===null||d===void 0?void 0:d.length)!==null&&a!==void 0?a:0)!==0||this.dataset.customColTree||this.cornerSetting.titleOnDimension!=="column"&&this.cornerSetting.titleOnDimension!=="all"||(c=(h=this.columnsDefine.length)!==null&&h!==void 0?h:0,!this.hideIndicatorName&&this.indicatorsAsCol&&c++),this.columnHeaderTitle&&(c+=1),this._table.isPivotChart()&&this.indicatorsAsCol&&!this.hasTwoIndicatorAxes&&it(this.indicatorsDefine)&&(c-=1),void(this.columnHeaderLevelCount=c)}this.columnHeaderLevelCount=this.indicatorsAsCol?this.hideIndicatorName?0:1:0}resetRowHeaderLevelCount(){var e,t,i,o,r,n,s,l;if(this.showHeader&&this.showRowHeader){if(this.rowHierarchyType==="tree"){const h=(t=(e=this.extensionRows)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0;return this.rowHeaderTitle?void(this.rowHeaderLevelCount=2+h):void(this.rowHeaderLevelCount=1+h)}const d=this.rowDimensionTree.totalLevel;let a=d;return a===0&&this.dataset&&!(!((i=this.dataset.customRowTree)===null||i===void 0)&&i.length)?this.cornerSetting.titleOnDimension==="column"&&this.cornerSetting.forceShowHeader?a=1:this._table.isPivotChart()||((r=(o=this.dataset.records)===null||o===void 0?void 0:o.length)!==null&&r!==void 0?r:0)!==0||this.cornerSetting.titleOnDimension!=="row"&&this.cornerSetting.titleOnDimension!=="all"||(a=(n=this.rowsDefine.length)!==null&&n!==void 0?n:0):!this.dataset||this._table.isPivotChart()||((l=(s=this.dataset.records)===null||s===void 0?void 0:s.length)!==null&&l!==void 0?l:0)!==0||this.dataset.customRowTree||this.cornerSetting.titleOnDimension!=="row"&&this.cornerSetting.titleOnDimension!=="all"||(a=this.rowsDefine.length,this.hideIndicatorName||this.indicatorsAsCol||a++),!this.indicatorsAsCol&&this.hideIndicatorName&&this.rowDimensionKeys[this.rowDimensionKeys.length-1]===this.indicatorDimensionKey&&(a=d-1),this.rowHeaderTitle&&(a+=1),void(this.rowHeaderLevelCount=a)}this.rowHeaderLevelCount=this.indicatorsAsCol||this.hideIndicatorName?0:1}get columnHeaderLevelCount(){return this._columnHeaderLevelCount}set columnHeaderLevelCount(e){this._columnHeaderLevelCount=e}get rowHeaderLevelCount(){return this._rowHeaderLevelCount}set rowHeaderLevelCount(e){this._rowHeaderLevelCount=e}get colCount(){var e;return(this.columnDimensionTree.totalLevel>0||this._table.isPivotChart()||((e=this.dataset.records)===null||e===void 0?void 0:e.length)>0||this.dataset.records&&!Array.isArray(this.dataset.records)?this.columnDimensionTree.tree.size:0)+this.rowHeaderLevelCount+this.rightHeaderColCount+this.leftRowSeriesNumberColumnCount}get rowCount(){var e,t,i,o;return((this._table.records||this.dataset.records)&&(!Array.isArray(this._table.records)||this._table.records.length>0)&&((e=this._indicators)===null||e===void 0?void 0:e.length)>0&&!(!((t=this._rowHeaderCellIds)===null||t===void 0)&&t.length)?1:(o=(i=this._rowHeaderCellIds)===null||i===void 0?void 0:i.length)!==null&&o!==void 0?o:0)+this.columnHeaderLevelCount+this.bottomHeaderRowCount}get bodyRowSpanCount(){return this.rowDimensionTree.tree.size}get bottomFrozenRowCount(){if(!this._table.isPivotChart())return this._table.internalProps.bottomFrozenRowCount?this.rowCount-this.headerLevelCount>=this._table.internalProps.bottomFrozenRowCount?this._table.internalProps.bottomFrozenRowCount:this.rowCount-this.headerLevelCount:0;if(this.indicatorKeys.length>=1&&it(this.indicatorsDefine)){const e=this._table.pivotChartAxes.find(t=>t.orient==="bottom");return(e==null?void 0:e.visible)===!1?0:(this.indicatorsAsCol,1)}return 0}get rightFrozenColCount(){if(!this._table.isPivotChart())return this._table.internalProps.rightFrozenColCount?this.colCount-this.rowHeaderLevelCount>=this._table.internalProps.rightFrozenColCount?this._table.internalProps.rightFrozenColCount:this.colCount-this.rowHeaderLevelCount:0;const e=this._table.pivotChartAxes.find(t=>t.orient==="right");return(e==null?void 0:e.visible)===!1||this.indicatorsAsCol?0:this.hasTwoIndicatorAxes?1:0}get bodyRowCount(){return this.rowCount-this.bottomFrozenRowCount-this.headerLevelCount}get bodyColCount(){return this.colCount-this.rightFrozenColCount-this.rowHeaderLevelCount}get headerObjects(){return this._headerObjects}get columnObjects(){return this._indicators}getCellId(e,t){var i,o,r,n,s;if(t>=0&&e>=0){if(this.isSeriesNumber(e,t))return"";if(this.isCornerHeader(e,t))return(i=this._cornerHeaderCellIds[t])===null||i===void 0?void 0:i[e-this.leftRowSeriesNumberColumnCount];if(this.isColumnHeader(e,t))return(o=this._columnHeaderCellIds[t])===null||o===void 0?void 0:o[e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount];if(this.isRowHeader(e,t))return(r=this._rowHeaderCellIds[t-this.columnHeaderLevelCount])===null||r===void 0?void 0:r[e-this.leftRowSeriesNumberColumnCount];if(this.isRightFrozenColumn(e,t))return(n=this._rowHeaderCellIds[t-this.columnHeaderLevelCount])===null||n===void 0?void 0:n[this.rowHeaderLevelCount-1];if(this.isBottomFrozenRow(e,t))return(s=this._columnHeaderCellIds[this.columnHeaderLevelCount-1])===null||s===void 0?void 0:s[e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount]}}getHeader(e,t){var i;if(this.isSeriesNumberInHeader(e,t))return this.getSeriesNumberHeader(e,t);const o=this.getCellId(e,t);return(i=this._headerObjectMap[o])!==null&&i!==void 0?i:{id:void 0,field:"",headerType:"text",define:void 0}}getHeaderField(e,t){var i,o;const r=this.getCellId(e,t);return((i=this._headerObjectMap[r])===null||i===void 0?void 0:i.field)||((o=this.getBody(e,t))===null||o===void 0?void 0:o.field)}getHeaderCellAdressById(e){for(let t=0;t<this._columnHeaderCellIds.length;t++){const i=this._columnHeaderCellIds[t];for(let o=0;o<i.length;o++)if(i[o]===e)return{col:o+this._table.frozenColCount,row:t}}for(let t=0;t<this._rowHeaderCellIds.length;t++){const i=this._rowHeaderCellIds[t];for(let o=0;o<i.length;o++)if(i[o]===e)return{col:o,row:t+this._table.frozenRowCount}}for(let t=0;t<this._cornerHeaderCellIds.length;t++){const i=this._cornerHeaderCellIds[t];for(let o=0;o<i.length;o++)if(i[o]===e)return{col:o,row:t}}}getHeaderCellAddressByField(e){const t=this.headerObjects.find(i=>i&&i.field===e);return t&&this.getHeaderCellAdressById(t.id)}getBody(e,t){var i,o,r,n,s,l,d,a,h,c;const u=this.getBodyWidthCache(e,t);if(u)return u;if(this.isSeriesNumber(e,t)){const y=this.getSeriesNumberBody(e,t);return this.setBodyWidthCache(e,t,y),y}const v=this.getCellHeaderPaths(e,t);if(this.indicatorsAsCol){const y=(o=(i=v.colHeaderPaths)===null||i===void 0?void 0:i.find(S=>S.indicatorKey))===null||o===void 0?void 0:o.indicatorKey,_=O(y)&&(s=(n=(r=this._indicators)===null||r===void 0?void 0:r.find(S=>S.indicatorKey===y))!==null&&n!==void 0?n:this._indicators[0])!==null&&s!==void 0?s:{id:"",field:void 0,indicatorKey:void 0,cellType:"text",define:void 0};return this.setBodyWidthCache(e,t,_),_}const g=(d=(l=v.rowHeaderPaths)===null||l===void 0?void 0:l.find(y=>y.indicatorKey))===null||d===void 0?void 0:d.indicatorKey,m=O(g)&&(c=(h=(a=this._indicators)===null||a===void 0?void 0:a.find(y=>y.indicatorKey===g))!==null&&h!==void 0?h:this._indicators[0])!==null&&c!==void 0?c:{id:"",field:void 0,indicatorKey:void 0,cellType:"text",define:void 0};return this.setBodyWidthCache(e,t,m),m}getCellRange(e,t){var i,o;const r={start:{col:e,row:t},end:{col:e,row:t}};if(!this.isHeader(e,t)||e===-1||t===-1||this.isRightFrozenColumn(e,t)||this.isBottomFrozenRow(e,t))return r;if(this._table.isPivotChart()){if(this.isLeftBottomCorner(e,t))return{start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.frozenColCount-1,row:this.rowCount-1}};if(this.isRightTopCorner(e,t))return{start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}};if(this.isRightBottomCorner(e,t))return{start:{col:this.colCount-this.rightFrozenColCount,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}}}for(let n=0;n<this._largeCellRangeCache.length;n++){const s=this._largeCellRangeCache[n];if(e>=s.start.col&&e<=s.end.col&&t>=s.start.row&&t<=s.end.row)return s}if(this.isHeader(e,t)&&e!==-1&&t!==-1){const n=this.getCellId(e,t);for(let s=e-1;s>=0&&n===this.getCellId(s,t);s--)r.start.col=s;for(let s=e+1;s<((i=this.colCount)!==null&&i!==void 0?i:0)&&n===this.getCellId(s,t);s++)r.end.col=s;for(let s=t-1;s>=0&&n===this.getCellId(e,s);s--)r.start.row=s;for(let s=t+1;s<((o=this.rowCount)!==null&&o!==void 0?o:0)&&!(n!==this.getCellId(e,s)||this.isSeriesNumberInHeader(e,t)&&s>=this.columnHeaderLevelCount);s++)r.end.row=s}return(r.end.col-r.start.col>100||r.end.row-r.start.row>100)&&this._largeCellRangeCache.push(r),r}isCellRangeEqual(e,t,i,o){const r=this.getCellRange(e,t),n=this.getCellRange(i,o);return r.start.col===n.start.col&&r.end.col===n.end.col&&r.start.row===n.start.row&&r.end.row===n.end.row}getBodyIndexByRow(e){return e<this.columnHeaderLevelCount||e>=this.rowCount-this.bottomHeaderRowCount?-1:e-this.columnHeaderLevelCount}get bottomHeaderRowCount(){return this._table.isPivotChart()?this.bottomFrozenRowCount:0}get rightHeaderColCount(){return this._table.isPivotChart()?this.rightFrozenColCount:0}getBodyIndexByCol(e){return e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||e>=this.colCount-this.rightHeaderColCount?-1:e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount}getRecordStartRowByRecordIndex(e){return this.columnHeaderLevelCount+e}getRecordShowIndexByCell(e,t){}getCellHeaderPathsWithTreeNode(e,t){for(let s=0;s<this._largeCellRangeCache.length;s++){const l=this._largeCellRangeCache[s];if(e>=l.start.col&&e<=l.end.col&&t>=l.start.row&&t<=l.end.row)break}let i=this.getColHeaderPathCache(e,t),o=this.getRowHeaderPathCache(e,t);const r=this.getBodyIndexByCol(e),n=this.getBodyIndexByRow(t)+this.currentPageStartIndex;if(!i&&t>=0&&r>=0&&(i=this.columnDimensionTree.getTreePath(r,this.showHeader&&this.showColumnHeader?t-(this.columnHeaderTitle?1:0):this.columnDimensionTree.totalLevel),this.setColHeaderPathCache(e,t,i)),!o&&e>=0&&n>=0){if(o=[],this.rowHierarchyType==="tree"){const s=this._rowHeaderCellFullPathIds[n];let l=this.rowDimensionTree,d=0;for(;l;){const a=[];let h=s[d];for(a.push(h);;){const u=this._headerObjectMap[h];if(!(u!=null&&u.parentCellId))break;a.unshift(u.parentCellId),h=u.parentCellId}const c=l.getTreePathByCellIds(a);o.push(...c),l=this._rowHeaderExtensionTree[s[d]],d++}}else o=this.rowDimensionTree.getTreePath(n,this.showHeader&&this.showRowHeader?e-(this.rowHeaderTitle?1:0)-this.leftRowSeriesNumberColumnCount:this.rowDimensionTree.totalLevel);this.setRowHeaderPathCache(e,t,o)}return{colHeaderPaths:i,rowHeaderPaths:o,cellLocation:this.getCellLocation(e,t)}}getCellHeaderPaths(e,t){var i,o;const r=this.getCellHeaderPathsWithTreeNode(e,t),n={colHeaderPaths:[],rowHeaderPaths:[],cellLocation:r.cellLocation};return(i=r.colHeaderPaths)===null||i===void 0||i.forEach(s=>{var l,d,a;const h={};h.dimensionKey=s.dimensionKey,h.indicatorKey=s.indicatorKey,h.value=(a=(l=s.value)!==null&&l!==void 0?l:(d=this.getIndicatorInfoByIndicatorKey(s.indicatorKey))===null||d===void 0?void 0:d.title)!==null&&a!==void 0?a:"",h.virtual=s.virtual,n.colHeaderPaths.push(h)}),(o=r.rowHeaderPaths)===null||o===void 0||o.forEach(s=>{var l,d,a;if(s.dimensionKey!=="axis"){const h={};h.dimensionKey=s.dimensionKey,h.indicatorKey=s.indicatorKey,h.value=(a=(l=s.value)!==null&&l!==void 0?l:(d=this.getIndicatorInfoByIndicatorKey(s.indicatorKey))===null||d===void 0?void 0:d.title)!==null&&a!==void 0?a:"",h.virtual=s.virtual,n.rowHeaderPaths.push(h)}}),n}getIndicatorInfoByIndicatorKey(e){var t;return(t=this.indicatorsDefine)===null||t===void 0?void 0:t.find(i=>typeof i!="string"&&!!e&&i.indicatorKey===e)}findFullCellIds(e){const t=[];for(let i=0;i<e.length;i++){let o=e[i];for(t.push(o);;){const r=this._headerObjectMap[o];if(!(r!=null&&r.parentCellId))break;t.unshift(r.parentCellId),o=r.parentCellId}}return t}getHeaderDimension(e,t){var i,o,r;if(this.isHeader(e,t)){const n=this.getHeader(e,t);return(o=(i=this.rowsDefine)===null||i===void 0?void 0:i.find(s=>typeof s!="string"&&s.dimensionKey===n.field))!==null&&o!==void 0?o:(r=this.columnsDefine)===null||r===void 0?void 0:r.find(s=>typeof s!="string"&&s.dimensionKey===n.field)}}isColumnIndicatorHeader(e,t){return this._indicatorShowType==="column"&&t===this.columnHeaderLevelCount-1&&e>=this.rowHeaderLevelCount}isRowIndicatorHeader(e,t){return this._indicatorShowType==="row"&&e===this.rowHeaderLevelCount-1&&t>=this.columnHeaderLevelCount}isIndicatorHeader(e,t){return this.isColumnIndicatorHeader(e,t)||this.isRowIndicatorHeader(e,t)}toggleHierarchyState(e,t){var i,o,r,n,s,l;this.colIndex=0;const d=this._rowHeaderCellFullPathIds_FULL.slice(0),a=d.map((u,v)=>({col:e,row:v+this.columnHeaderLevelCount})),h=this.getHeader(e,t);if(h.define.hierarchyState=h.define.hierarchyState===Qe.collapse?Qe.expand:Qe.collapse,this.rowDimensionTree.reset(this.rowDimensionTree.tree.children,!0),this._rowHeaderCellFullPathIds_FULL=[],this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=[],this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs),this.rowHeaderTitle){const u=++this.sharedVar.seqId,v=Array(this.rowCount-this.columnHeaderLevelCount).fill(u);this._rowHeaderCellFullPathIds_FULL.unshift(v);const g={id:u,title:typeof this.rowHeaderTitle.title=="string"?this.rowHeaderTitle.title:this.rowsDefine.reduce((m,y)=>typeof y=="string"?m:m+(m?`/${y.title}`:`${y.title}`),""),field:void 0,headerType:(o=(i=this.rowHeaderTitle)===null||i===void 0?void 0:i.headerType)!==null&&o!==void 0?o:"text",style:(r=this.rowHeaderTitle)===null||r===void 0?void 0:r.headerStyle,define:{field:"",headerType:"text",cellType:"text",disableHeaderHover:!!(!((n=this.rowHeaderTitle)===null||n===void 0)&&n.disableHeaderHover),disableHeaderSelect:!!(!((s=this.rowHeaderTitle)===null||s===void 0)&&s.disableHeaderSelect)}};this.rowHeaderObjs.push(g),this._headerObjects[u]=g}this._rowHeaderCellFullPathIds_FULL=ct(this._rowHeaderCellFullPathIds_FULL),this.rowHierarchyType==="tree"&&((l=this.extensionRows)===null||l===void 0?void 0:l.length)>=1&&this.generateExtensionRowTree(),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((u,v)=>(u[v.id]=v,u),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0;const c=eo(e,t,d.map(u=>u[e-this.leftRowSeriesNumberColumnCount]),this._rowHeaderCellFullPathIds_FULL.map(u=>u[e-this.leftRowSeriesNumberColumnCount]),a,this);return this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination),c}isHeaderForColWidth(e,t){return this.isHeader(e,t)}getHeaderForColWidth(e,t){return this.getHeader(e,t)}getPivotCellAdress(e){var t;if(!Array.isArray(e))return;let i,o,r=this.rowTree,n=this.columnTree;for(let d=0;d<e.length;d++){const a=e[d];if((a.isPivotCorner||!O(a.value))&&d===e.length-1){if(((t=this==null?void 0:this.cornerSetting)===null||t===void 0?void 0:t.titleOnDimension)==="row"){let u=0;return this.rowHierarchyType==="grid"&&(u=this.rowDimensionKeys.indexOf(a.dimensionKey)),u===-1?void 0:{col:(this.rowHeaderTitle?u+1:u)+this.leftRowSeriesNumberColumnCount,row:0}}const c=this.colDimensionKeys.indexOf(a.dimensionKey);return c===-1?void 0:{col:0+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderTitle?c+1:c}}let h=!1;for(let c=0;c<n.length;c++){const u=n[c];if((O(a.dimensionKey)&&u.dimensionKey===a.dimensionKey||O(a.indicatorKey)&&u.indicatorKey===a.indicatorKey)&&u.value===a.value){n=u.children,o=u,h=!0;break}}if(!h)for(let c=0;c<r.length;c++){const u=r[c];if((O(a.dimensionKey)&&u.dimensionKey===a.dimensionKey||O(a.indicatorKey)&&u.indicatorKey===a.indicatorKey)&&u.value===a.value){r=u.children,i=u;break}}}let s=0,l=0;if(i){l=this.columnHeaderLevelCount;const{startInTotal:d,level:a}=i;return l+=d,s=this.rowHierarchyType==="grid"?(this.rowHeaderTitle?a+1:a)+this.leftRowSeriesNumberColumnCount:0+this.leftRowSeriesNumberColumnCount,{col:s,row:l}}if(o){s=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;const{startInTotal:d,level:a}=o;return s+=d,l=this.columnHeaderTitle?a+1:a,{col:s,row:l}}}getPivotDimensionInfo(e,t){var i;const{colHeaderPaths:o,rowHeaderPaths:r}=this.getCellHeaderPaths(e,t),n=[];return o.length?o.forEach((s,l)=>{n.push({dimensionKey:s.dimensionKey,value:s.value,isPivotCorner:!1,indicatorKey:s.indicatorKey})}):r.length?r.forEach((s,l)=>{n.push({dimensionKey:s.dimensionKey,value:s.value,isPivotCorner:!1,indicatorKey:s.indicatorKey})}):this.isCornerHeader(e,t)&&(((i=this==null?void 0:this.cornerSetting)===null||i===void 0?void 0:i.titleOnDimension)==="row"?n.push({dimensionKey:this.rowDimensionKeys[(this.rowHeaderTitle?e-1:e)-this.leftRowSeriesNumberColumnCount],isPivotCorner:!0}):n.push({dimensionKey:this.colDimensionKeys[this.columnHeaderTitle?t-1:t],isPivotCorner:!0})),n}getIndicatorKey(e,t){var i;return(i=this.getBody(e,t))===null||i===void 0?void 0:i.indicatorKey}getParentCellId(e,t){if(t!==0)return this.isColumnHeader(e,t)?this.getCellId(e,t-1):this.isRowHeader(e,t)?this.getCellId(e-1,t):void 0}getRowHeaderCellAddressByCellId(e){let t,i;if(this._rowHeaderCellIds.find((o,r)=>!!o.find((n,s)=>n===e&&(t=s,!0))&&(i=r,!0)),O(t)&&O(i))return{col:t,row:i+this.columnHeaderLevelCount}}canMoveHeaderPosition(e,t){if(this.isSeriesNumberInHeader(t.col,t.row)||this.isSeriesNumberInHeader(e.col,e.row)||this.isCornerHeader(t.col,t.row)||e.col<0||e.row<0||t.col<0||t.row<0)return!1;this.isSeriesNumberInBody(t.col,t.row)&&this.isSeriesNumberInBody(e.col,e.row)&&(e.col=e.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1,t.col=t.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1);const i=this.getCellRange(e.col,e.row);if(this.isColumnHeader(e.col,e.row))return this.getParentCellId(e.col,i.start.row)===this.getParentCellId(t.col,i.start.row);if(this.isRowHeader(e.col,e.row)){if(this.rowHierarchyType!=="tree")return this.getParentCellId(i.start.col,e.row)===this.getParentCellId(i.start.col,t.row);{const o=ge(this.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths),r=ge(this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths);if(o.pop(),r.pop(),o.length<=r.length){if(o.length===r.length)return!o.find((n,s)=>n.dimensionKey!==r[s].dimensionKey||n.value!==r[s].value);if(o.length>0){for(let n=0;n<o.length;n++)if(o[n].startInTotal!==r[n].startInTotal)return!1}return!0}}}return!1}moveHeaderPosition(e,t){if(this.canMoveHeaderPosition(e,t)&&!this.isCellRangeEqual(e.col,e.row,t.col,t.row)){const i=this.getCellRange(e.col,e.row);if(this.isColumnHeader(e.col,e.row)){const o=i.end.col-i.start.col+1;let r;const n=this.getCellRange(t.col,i.start.row);if(r=t.col>=e.col?n.end.col-o+1:n.start.col,r===i.start.col)return null;for(let l=0;l<this._columnHeaderCellFullPathIds.length;l++){const d=this._columnHeaderCellFullPathIds[l].splice(i.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,o);d.unshift(r-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnHeaderCellFullPathIds[l],d)}const s=this._columnWidths.splice(i.start.col-this.leftRowSeriesNumberColumnCount,o);return s.unshift(r-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnWidths,s),this.columnDimensionTree.movePosition(this.getCellHeaderPathsWithTreeNode(e.col,e.row).colHeaderPaths.length-1,i.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,n.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount),this.columnDimensionTree.reset(this.columnDimensionTree.tree.children,!0),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:i.start.col,targetIndex:r,sourceSize:o,targetSize:n.end.col-n.start.col+1,moveType:"column"}}if(this.isRowHeader(e.col,e.row)){let o;const r=this.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths,n=this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths,s=r[r.length-1],l=n[r.length-1],d=s.size;if(o=t.row>=e.row?l.startInTotal+l.size-d:l.startInTotal,o===i.start.row-this.columnHeaderLevelCount)return null;const a=this._rowHeaderCellIds.splice(i.start.row-this.columnHeaderLevelCount,d);a.unshift(o-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellIds,a);const h=this._rowHeaderCellFullPathIds.splice(i.start.row-this.columnHeaderLevelCount,d);h.unshift(o-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds,h);const c=this._rowHeaderCellIds_FULL.splice(i.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,d);c.unshift(o,0),Array.prototype.splice.apply(this._rowHeaderCellIds_FULL,c);const u=this._rowHeaderCellFullPathIds_FULL.splice(i.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,d);return u.unshift(o,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds_FULL,u),this.rowDimensionTree.movePosition(r.length-1,i.start.row-this.columnHeaderLevelCount,o+(t.row>e.row?s.size-1:0)),this.rowDimensionTree.reset(this.rowDimensionTree.tree.children,!0),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:i.start.row,targetIndex:o+this.columnHeaderLevelCount,sourceSize:d,targetSize:l.size,moveType:"row"}}}return null}getCellAdressByHeaderPath(e){var t,i,o,r,n,s;let l,d,a=!1,h=!1;if(Array.isArray(e)){if(e.length>this.rowDimensionKeys.length+this.colDimensionKeys.length)return;l=e.filter(f=>this.colDimensionKeys.indexOf(f.dimensionKey)>=0||this.colDimensionKeys.indexOf(this.indicatorDimensionKey)>=0&&f.indicatorKey),d=e.filter(f=>this.rowDimensionKeys.indexOf(f.dimensionKey)>=0||this.rowDimensionKeys.indexOf(this.indicatorDimensionKey)>=0&&f.indicatorKey)}else l=e.colHeaderPaths,d=e.rowHeaderPaths,(e==null?void 0:e.cellLocation)==="body"&&this._table.isPivotTable()&&(h=!0);if(!Array.isArray(l)&&!Array.isArray(d))return;if(l==null||l.sort((f,p)=>{var I,w;return this.colDimensionKeys.indexOf((I=f.dimensionKey)!==null&&I!==void 0?I:this.indicatorDimensionKey)-this.colDimensionKeys.indexOf((w=p.dimensionKey)!==null&&w!==void 0?w:this.indicatorDimensionKey)}),d==null||d.sort((f,p)=>{var I,w;return this.fullRowDimensionKeys.indexOf((I=f.dimensionKey)!==null&&I!==void 0?I:this.indicatorDimensionKey)-this.fullRowDimensionKeys.indexOf((w=p.dimensionKey)!==null&&w!==void 0?w:this.indicatorDimensionKey)}),l==null||l.forEach(f=>{f.isPivotCorner&&(a=!0)}),d==null||d.forEach(f=>{f.isPivotCorner&&(a=!0)}),a){if(this.cornerSetting.titleOnDimension==="all"&&this.indicatorsAsCol&&l.length===0){for(let f=0;f<this.rowDimensionKeys.length;f++)if(((t=d[0])===null||t===void 0?void 0:t.dimensionKey)===this.rowDimensionKeys[f])return{col:f+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderLevelCount-1}}else if(this.cornerSetting.titleOnDimension!=="all"||this.indicatorsAsCol||d.length!==0){if(this.cornerSetting.titleOnDimension==="row"||this.cornerSetting.titleOnDimension==="all"&&!this.indicatorsAsCol){for(let f=0;f<this.rowDimensionKeys.length;f++)if(((o=d[0])===null||o===void 0?void 0:o.dimensionKey)===this.rowDimensionKeys[f])return{col:f+this.leftRowSeriesNumberColumnCount,row:0}}else for(let f=0;f<this.colDimensionKeys.length;f++)if(((r=l[0])===null||r===void 0?void 0:r.dimensionKey)===this.colDimensionKeys[f])return{col:0,row:f}}else for(let f=0;f<this.colDimensionKeys.length;f++)if(((i=l[0])===null||i===void 0?void 0:i.dimensionKey)===this.colDimensionKeys[f])return{col:this.rowHeaderLevelCount-1,row:f}}let c,u,v,g,m=!1;(l==null?void 0:l.length)>=1&&(d==null?void 0:d.length)>=1&&(m=!0);let y,_,S=this.rowTree,P=this.columnTree;if(l)for(let f=0;f<l.length;f++){const p=l[f];for(let I=0;I<P.length;I++){const w=P[I];if(!O(p.indicatorKey)&&w.dimensionKey===p.dimensionKey&&w.value===p.value||O(p.indicatorKey)&&w.indicatorKey===p.indicatorKey){P=w.children,m&&!P?_=w:m||(_=w);break}}}if((d==null?void 0:d.length)>=1)if(this.rowHierarchyType==="tree"){const f=d[d.length-1],p=this.headerObjects.filter(w=>((w==null?void 0:w.field)===f.dimensionKey||(w==null?void 0:w.field)===f.indicatorKey)&&(w==null?void 0:w.title)===f.value).map(w=>w.id),I=this._rowHeaderCellIds.filter(w=>p.indexOf(w[w.length-1])>=0).find(w=>{const C=this.findFullCellIds(w);return C.length===d.length&&C.every(T=>{const H=this._headerObjectMap[T];return d.find(b=>b.dimensionKey===H.field&&b.value===H.title)})});u=this._rowHeaderCellIds.indexOf(I)+this.columnHeaderLevelCount}else for(let f=0;f<d.length;f++){const p=d[f];for(let I=0;I<S.length;I++){const w=S[I];if(!O(p.indicatorKey)&&w.dimensionKey===p.dimensionKey&&w.value===p.value||O(p.indicatorKey)&&w.indicatorKey===p.indicatorKey&&(!O(p.value)||w.value===p.value)){S=w.children,(!m||S&&!S.some(C=>C.dimensionKey==="axis"))&&m||(y=w);break}}}if(h||!m||(y||O(u))&&_){if(y||h){u=this.columnHeaderLevelCount;const{startInTotal:f,level:p}=(n=y)!==null&&n!==void 0?n:Nt;u+=f??0,v=this.rowHierarchyType==="grid"?(this.rowHeaderTitle?p+1:p)+this.leftRowSeriesNumberColumnCount:0}if(_||h){c=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;const{startInTotal:f,level:p}=(s=_)!==null&&s!==void 0?s:Nt;c+=f??0,g=this.columnHeaderTitle?p+1:p}return O(c)||O(u)?{col:c??v,row:u??g}:void 0}}setChartInstance(e,t,i){var o,r,n,s;const l=this.getCellHeaderPaths(e,t);let d;if(this.indicatorsAsCol){const a=(o=l.colHeaderPaths.find(h=>h.indicatorKey))===null||o===void 0?void 0:o.indicatorKey;d=(r=this._indicators)===null||r===void 0?void 0:r.find(h=>h.indicatorKey===a)}else{const a=(n=l.rowHeaderPaths.find(h=>h.indicatorKey))===null||n===void 0?void 0:n.indicatorKey;d=(s=this._indicators)===null||s===void 0?void 0:s.find(h=>h.indicatorKey===a)}typeof(d==null?void 0:d.chartSpec)!="function"&&d&&(d.chartInstance=i)}getChartInstance(e,t){var i,o,r,n;const s=this.getCellHeaderPaths(e,t);let l;if(this.indicatorsAsCol){const d=(i=s.colHeaderPaths.find(a=>a.indicatorKey))===null||i===void 0?void 0:i.indicatorKey;l=(o=this._indicators)===null||o===void 0?void 0:o.find(a=>a.indicatorKey===d)}else{const d=(r=s.rowHeaderPaths.find(a=>a.indicatorKey))===null||r===void 0?void 0:r.indicatorKey;l=(n=this._indicators)===null||n===void 0?void 0:n.find(a=>a.indicatorKey===d)}return l==null?void 0:l.chartInstance}checkHasChart(){return Hi(this)}getDimension(e,t){var i,o;return t==="column"?(i=this.columnsDefine)===null||i===void 0?void 0:i.find(r=>typeof r!="string"&&r.dimensionKey===e):t==="row"?(o=this.rowsDefine)===null||o===void 0?void 0:o.find(r=>typeof r!="string"&&r.dimensionKey===e):void 0}getAxisConfigInPivotChart(e,t){if((this.isFrozenColumn(e,t)||this.isRightFrozenColumn(e,t))&&Je(e,t,"row",this)||(this.isFrozenRow(e,t)||this.isBottomFrozenRow(e,t))&&Je(e,t,"col",this))return Le.getFunction("getAxisConfigInPivotChart")(e,t,this)}isEmpty(e,t){return!!this._table.isPivotChart()&&(!!this.isLeftBottomCorner(e,t)||!!this.isRightBottomCorner(e,t)||!!this.isRightTopCorner(e,t))}isAxisCell(e,t){return this._table.isPivotChart()?!!(this.indicatorKeys.length>=1&&it(this.indicatorsDefine)&&(this.isBottomFrozenRow(e,t)&&Je(e,t,"col",this)||this.isRightFrozenColumn(e,t)&&Je(e,t,"row",this)||this.isRowHeader(e,t)&&e===this.rowHeaderLevelCount-1&&Je(e,t,"row",this)||this.hasTwoIndicatorAxes&&this.indicatorsAsCol&&t===this.columnHeaderLevelCount-1&&Je(e,t,"col",this))):!1}getChartAxes(e,t){if(Ti(e,t,this)||this.isAxisCell(e,t))return Pi(e,t,this)}getRawChartSpec(e,t){return Si(e,t,this)}getChartSpec(e,t){return bi(e,t,this)}isShareChartSpec(e,t){return Ii(e,t,this)}getChartDataId(e,t){return Ri(e,t,this)}isNoChartDataRenderNothing(e,t){return Di(e,t,this)}setPagination(e){var t,i,o,r,n,s,l;if(this.clearCellRangeMap(),this._table.internalProps.useOneRowHeightFillAll=!1,this.pagination=e,this.rowHierarchyType==="grid"&&O((t=this.pagination)===null||t===void 0?void 0:t.perPageCount)&&O((i=this.pagination)===null||i===void 0?void 0:i.currentPage)){this.indicatorsAsCol===!1&&(this.pagination.perPageCount=Math.ceil(this.pagination.perPageCount/this.indicatorKeys.length)*this.indicatorKeys.length);const{perPageCount:d,currentPage:a}=this.pagination;this.currentPageStartIndex=d*(a||0),this.currentPageEndIndex=this.currentPageStartIndex+d,this._rowHeaderCellIds=(o=this._rowHeaderCellIds_FULL)===null||o===void 0?void 0:o.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=(r=this._rowHeaderCellFullPathIds_FULL)===null||r===void 0?void 0:r.slice(this.currentPageStartIndex,this.currentPageEndIndex)}else this.currentPageStartIndex=0,this.currentPageEndIndex=this._rowHeaderCellIds_FULL.length,this._rowHeaderCellIds=(n=this._rowHeaderCellIds_FULL)===null||n===void 0?void 0:n.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=(s=this._rowHeaderCellFullPathIds_FULL)===null||s===void 0?void 0:s.slice(this.currentPageStartIndex,this.currentPageEndIndex);this.pagination&&(this.pagination.totalCount=(l=this._rowHeaderCellIds_FULL)===null||l===void 0?void 0:l.length)}release(){var e;const t=this._table._getActiveChartInstance();t==null||t.release(),(e=this._indicators)===null||e===void 0||e.forEach(i=>{var o;(o=i.chartInstance)===null||o===void 0||o.release()})}getHeadNode(e,t){var i,o,r;let n;const s=this.getCellHeaderPaths(e,t);return s.rowHeaderPaths&&((o=(i=s.rowHeaderPaths)===null||i===void 0?void 0:i.length)!==null&&o!==void 0?o:0)>0?n=(r=s.rowHeaderPaths)===null||r===void 0?void 0:r.slice(0,s.rowHeaderPaths.length):s.colHeaderPaths&&s.colHeaderPaths.length>0&&(n=s.colHeaderPaths.slice(0,s.colHeaderPaths.length)),this.getHeadNodeByRowOrColDimensions(n,e,t)}getHeadNodeByRowOrColDimensions(e,t,i){var o;if(!Array.isArray(e))return;let r,n,s=this.rowTree,l=this.columnTree;if(O(i)&&O(t)&&this.rowHierarchyType==="tree"&&this.extensionRows&&t>=1+this.leftRowSeriesNumberColumnCount){const d=this.getCellId(t-1,i);s=this._rowHeaderExtensionTree[d].tree.children}for(let d=0;d<e.length;d++){const a=e[d];if((a.isPivotCorner||!O(a.value))&&d===e.length-1)return;let h=!1;for(let c=0;c<l.length;c++){const u=l[c];if(O(a.dimensionKey)&&u.dimensionKey===a.dimensionKey&&u.value===a.value||O(a.indicatorKey)&&u.indicatorKey===a.indicatorKey&&(u.value===a.value||!O(a.value)||!O(u.value))){l=u.children,n=u,h=!0;break}}if(!h)for(let c=0;(o=c<(s==null?void 0:s.length))!==null&&o!==void 0&&o;c++){const u=s[c];if(O(a.dimensionKey)&&u.dimensionKey===a.dimensionKey&&u.value===a.value||O(a.indicatorKey)&&u.indicatorKey===a.indicatorKey&&(u.value===a.value||!O(a.value)||!O(u.value))){s=u.children,r=u;break}}}return r||n||void 0}clearCellRangeMap(){this._largeCellRangeCache.length=0,this._CellHeaderPathMap=new Map}getDimensionKeyInChartSpec(e,t){var i,o,r,n,s,l;let d;if(this.indicatorsAsCol===!1)for(let a=0;a<this.indicatorsDefine.length;a++){const h=this.indicatorsDefine[a].chartSpec;if(h&&(d=(i=h.xField)!==null&&i!==void 0?i:(r=(o=h==null?void 0:h.series)===null||o===void 0?void 0:o[0])===null||r===void 0?void 0:r.xField,d))return d}else for(let a=0;a<this.indicatorsDefine.length;a++){const h=this.indicatorsDefine[a].chartSpec;if(h&&(d=(n=h.yField)!==null&&n!==void 0?n:(l=(s=h==null?void 0:h.series)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.yField,d))return d}return null}_generateChartState(){return{vtable_selected:{filter:e=>{var t;return this._table._selectedDataItemsInChart.length>=1?!!this._table._selectedDataItemsInChart.find(i=>{for(const o in i)if(typeof i[o]!="object"&&i[o]!==e[o])return!1;return!0}):!((t=this._table._selectedDimensionInChart)===null||t===void 0)&&t.length?!!this._table._selectedDimensionInChart.every(i=>typeof i.value=="object"||e[i.key]===i.value):!1}},vtable_selected_reverse:{filter:e=>{var t;return this._table._selectedDataItemsInChart.length>=1?!this._table._selectedDataItemsInChart.find(i=>{for(const o in i)if(typeof i[o]!="object"&&i[o]!==e[o])return!1;return!0}):!((t=this._table._selectedDimensionInChart)===null||t===void 0)&&t.length?!this._table._selectedDimensionInChart.every(i=>typeof i.value=="object"||e[i.key]===i.value):!1}}}}updateDataStateToChartInstance(e){var t;if(((t=e==null?void 0:e.getSpec().select)===null||t===void 0?void 0:t.enable)!==!1){e||(e=this._table._getActiveChartInstance());const i=this._generateChartState();this._indicators.forEach(o=>{var r;const n=o.chartInstance;((r=o.chartSpec.select)===null||r===void 0?void 0:r.enable)!==!1&&n.updateState(i)}),e==null||e.updateState(i)}}updateDataStateToActiveChartInstance(e){var t;if(((t=e==null?void 0:e.getSpec().select)===null||t===void 0?void 0:t.enable)!==!1){e||(e=this._table._getActiveChartInstance());const i=this._generateChartState();e==null||e.updateState(i)}}getIndicatorKeyInChartSpec(e,t){const i=this.getRawChartSpec(e,t),o=[];if(i){if(i.series||i.xField||i.yField)return this.indicatorsAsCol===!1?i.series?i.series.forEach(r=>{const n=r.yField;o.push(n)}):o.push(i.yField):i.series?i.series.forEach(r=>{const n=r.xField;o.push(n)}):o.push(i.xField),o;if(i.valueField&&o.push(i.valueField),o.length>=1)return o}return null}getOptimunHeightForChart(e){var t,i,o,r,n;const s=this.getCellHeaderPaths(this.rowHeaderLevelCount,e).rowHeaderPaths;let l,d;for(const h in this.dataset.collectValuesBy)if(this.dataset.collectValuesBy[h].type==="yField"&&!this.dataset.collectValuesBy[h].range){l=(t=this.dataset.collectedValues[h])===null||t===void 0?void 0:t[s.map(c=>c.value).join(this.dataset.stringJoinChar)];break}if(this._chartItemBandSize)d=Bt((i=l==null?void 0:l.length)!==null&&i!==void 0?i:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter);else{const h=this._chartItemSpanSize||25;d=((o=l==null?void 0:l.length)!==null&&o!==void 0?o:0)*(h+h/3)}const a=At((n=(r=this._chartPadding)!==null&&r!==void 0?r:this._table.theme.bodyStyle.padding)!==null&&n!==void 0?n:0);return d+a[0]+a[2]}getOptimunWidthForChart(e){var t,i,o,r,n;const s=this.getCellHeaderPaths(e,this.columnHeaderLevelCount).colHeaderPaths;let l,d;for(const h in this.dataset.collectValuesBy)if(this.dataset.collectValuesBy[h].type==="xField"&&!this.dataset.collectValuesBy[h].range){l=(t=this.dataset.collectedValues[h])===null||t===void 0?void 0:t[s.map(c=>c.value).join(this.dataset.stringJoinChar)];break}if(this._chartItemBandSize)d=Bt((i=l==null?void 0:l.length)!==null&&i!==void 0?i:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter);else{const h=this._chartItemSpanSize||25;d=((o=l==null?void 0:l.length)!==null&&o!==void 0?o:0)*(h+h/3)}const a=At((n=(r=this._chartPadding)!==null&&r!==void 0?r:this._table.theme.bodyStyle.padding)!==null&&n!==void 0?n:0);return d+a[1]+a[3]}get leftAxesCount(){if(!this._table.isPivotChart())return 0;const e=this._table.pivotChartAxes.find(t=>t.orient==="left");return(e==null?void 0:e.visible)===!1?0:(this.indicatorsAsCol,1)}get topAxesCount(){if(!this._table.isPivotChart())return 0;const e=this._table.pivotChartAxes.find(t=>t.orient==="top");return(e==null?void 0:e.visible)===!1?0:this.indicatorsAsCol&&this.hasTwoIndicatorAxes?1:0}get rightAxesCount(){return this.rightFrozenColCount}get bottomAxesCount(){return this.bottomFrozenRowCount}getColKeysPath(e,t){const i=this.getCellHeaderPaths(e,t),o=[];return i.colHeaderPaths.length&&i.colHeaderPaths.forEach(r=>{r.dimensionKey&&o.push(r.value)}),o==null?void 0:o.join(this.dataset.stringJoinChar)}getRowKeysPath(e,t){const i=this.getCellHeaderPaths(e,t),o=[];return i.rowHeaderPaths.length&&i.rowHeaderPaths.forEach(r=>{r.dimensionKey&&o.push(r.value)}),o==null?void 0:o.join(this.dataset.stringJoinChar)}getIndicatorInfo(e,t=""){var i;return(i=this.indicatorsDefine)===null||i===void 0?void 0:i.find(o=>typeof o!="string"&&(e?o.indicatorKey===e:!!t&&o.title===t))}getLayoutColumnTree(){const e=[],t=this.columnDimensionTree.tree.children;return Kt(e,t),e}getLayoutRowTree(){const e=[],t=this.rowDimensionTree.tree.children;return Kt(e,t),e}getLayoutColumnTreeCount(){const e=this.columnDimensionTree.tree.children;return vt(e,this.rowHierarchyType==="tree")}getLayoutRowTreeCount(){var e;const t=this.rowDimensionTree.tree.children;let i=vt(t,this.rowHierarchyType==="tree");return(e=this.extensionRows)===null||e===void 0||e.forEach(o=>{if(typeof o.rowTree!="function"){const r=vt(o.rowTree,!0);i*=r}}),i}resetHeaderTree(){var e,t,i;this.colIndex=0,this._rowHeaderCellFullPathIds_FULL=[],this._columnHeaderCellFullPathIds=[],this._columnHeaderCellIds=[];const o=this.dataset;this.rowTree=o.rowHeaderTree,this.columnTree=o.colHeaderTree;const r=this.rowDimensionTree.tree.children;(e=this.rowTree)===null||e===void 0||e.forEach((n,s)=>{const l=r.find(d=>d.dimensionKey===n.dimensionKey&&d.value===n.value);l&&this._table._syncHierarchyState(l,n)}),this.columnDimensionTree=new ce((t=this.columnTree)!==null&&t!==void 0?t:[],this.sharedVar),this.rowDimensionTree=new ce((i=this.rowTree)!==null&&i!==void 0?i:[],this.sharedVar,this.rowHierarchyType,this.rowHierarchyType==="tree"?this.rowExpandLevel:void 0),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=ct(this._rowHeaderCellFullPathIds_FULL),this._headerObjectMap=this._headerObjects.reduce((n,s)=>(n[s.id]=s,n),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination)}isSeriesNumberInHeader(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&t>=0&&e<this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount||this.rightRowSeriesNumberColumnCount>0&&t>=0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t<this.headerLevelCount}isSeriesNumberInBody(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&t>=this.headerLevelCount||this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t>=this.headerLevelCount}isSeriesNumber(e,t){return!!(O(e)&&O(t)&&(this.leftRowSeriesNumberColumnCount>0&&e>=0&&t>=0&&e<this.leftRowSeriesNumberColumnCount||this.rightRowSeriesNumberColumnCount>0&&t>=0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount))}getSeriesNumberHeader(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount?Object.assign({},this.leftRowSeriesNumberColumn[e],{style:this._table.internalProps.rowSeriesNumber.headerStyle}):this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t<this.headerLevelCount&&t<this.headerLevelCount?this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}getSeriesNumberBody(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&t>=this.headerLevelCount?this.leftRowSeriesNumberColumn[e]:this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t>=this.headerLevelCount?this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}changeTreeNodeTitle(e,t,i){this.getHeadNode(e,t).value=i;const o=this.getCellId(e,t);this._headerObjectMap[o].title=i}changeCornerTitle(e,t,i){if(this.isCornerHeader(e,t)){const o=this.getCellId(e,t);this._headerObjectMap[o].title=i}}generateCellIdsConsiderHideHeader(){if(this._columnHeaderCellIds=this._columnHeaderCellFullPathIds.slice(),!this.showColumnHeader)if(this.indicatorsAsCol&&!this.hideIndicatorName){const e=this.colDimensionKeys.indexOf(Me),t=this._columnHeaderCellIds.splice(e,1);this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length),this._columnHeaderCellIds.push(t[0])}else this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length);if(this._rowHeaderCellIds_FULL=this._rowHeaderCellFullPathIds_FULL.slice(),!this.showRowHeader)if(this.indicatorsAsCol||this.hideIndicatorName)this._rowHeaderCellIds_FULL.forEach((e,t)=>{const i=e.slice();i.splice(0,i.length),this._rowHeaderCellIds_FULL[t]=i});else{const e=this.rowDimensionKeys.indexOf(Me);this._rowHeaderCellIds_FULL.forEach((t,i)=>{const o=t.slice(),r=o.splice(e,1);o.splice(0,o.length),o.push(r[0]),this._rowHeaderCellIds_FULL[i]=o})}if(this._rowHeaderCellIds=this._rowHeaderCellIds_FULL.slice(),this._cornerHeaderCellIds=this._cornerHeaderCellFullPathIds.slice(),this.rowHeaderLevelCount===0||this.columnHeaderLevelCount===0)this._cornerHeaderCellIds=[];else if(this.cornerSetting.titleOnDimension!=="row"||this.showRowHeader){if(this.cornerSetting.titleOnDimension==="column"&&!this.showColumnHeader)if(this.indicatorsAsCol&&!this.hideIndicatorName){const e=this.colDimensionKeys.indexOf(Me),t=this._cornerHeaderCellIds.splice(e,1);this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length),this._cornerHeaderCellIds.push(t[0])}else this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length)}else if(this.indicatorsAsCol||this.hideIndicatorName)this._cornerHeaderCellIds.forEach((e,t)=>{const i=e.slice();i.splice(0,i.length),this._cornerHeaderCellIds[t]=i});else{const e=this.rowDimensionKeys.indexOf(Me);this._cornerHeaderCellIds.forEach((t,i)=>{const o=t.slice(),r=o.splice(e,1);o.splice(0,o.length),o.push(r[0]),this._cornerHeaderCellIds[i]=o})}}enableUseGetBodyCache(){this._useGetBodyCache=!0,this._getBodyCache.clear()}disableUseGetBodyCache(){this._useGetBodyCache=!1,this._getBodyCache.clear()}enableUseHeaderPathCache(){this._useHeaderPathCache=!0,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()}disableUseHeaderPathCache(){this._useHeaderPathCache=!1,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()}getBodyWidthCache(e,t){if(this._useGetBodyCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t))return this.indicatorsAsCol&&this._getBodyCache.has(e)?this._getBodyCache.get(e):!this.indicatorsAsCol&&this._getBodyCache.has(t)?this._getBodyCache.get(t):void 0}setBodyWidthCache(e,t,i){!this._useGetBodyCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||(this.indicatorsAsCol?this._getBodyCache.set(e,i):this._getBodyCache.set(t,i))}getColHeaderPathCache(e,t){if(this._useHeaderPathCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t)&&this._colHeaderPathCache.has(e))return this._colHeaderPathCache.get(e)}setColHeaderPathCache(e,t,i){!this._useHeaderPathCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||this._colHeaderPathCache.set(e,i)}getRowHeaderPathCache(e,t){if(this._useHeaderPathCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t)&&this._rowHeaderPathCache.has(t))return this._rowHeaderPathCache.get(t)}setRowHeaderPathCache(e,t,i){!this._useHeaderPathCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||this._rowHeaderPathCache.set(t,i)}}function Bt(D,e,t,i){t===1&&(t=0);const o=to(D,t,i),r=e/(1-t);return Math.ceil(o*r)}function to(D,e,t){let i;return i=D===1?D+2*t:D-e+2*t,D?i>0?i:1:0}class yt{constructor(e,t){this.tree={},this.beforeChangedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.stringJoinChar="\0",this.rowsIsTotal=[],this.colsIsTotal=[],this.dataConfig=e,t&&(this.records=t,typeof window<"u"&&window.performance.now(),this.setRecords(t),typeof window<"u"&&window.performance.now())}changeDataConfig(e){this.dataConfig=e}setRecords(e){this.processRecords()}processRecords(){for(let e=0,t=this.records.length;e<t;e++){const i=this.records[e];this.processRecord(i)}}processRecord(e){var t;const i=[],o=[];for(let r=0,n=this.dataConfig.rows.length;r<n;r++){const s=this.dataConfig.rows[r];e[s]!==void 0&&s!==this.dataConfig.indicatorDimensionKey&&o.push(e[s])}for(let r=0,n=this.dataConfig.columns.length;r<n;r++){const s=this.dataConfig.columns[r];e[s]!==void 0&&s!==this.dataConfig.indicatorDimensionKey&&i.push(e[s])}(t=this.dataConfig.indicators)===null||t===void 0||t.forEach(r=>{const n=e[r];n!==void 0&&(this.dataConfig.indicatorsAsCol?i.push(r):o.push(r));const s=o.join(this.stringJoinChar),l=i.join(this.stringJoinChar);o.length!==0&&(this.rowFlatKeys[s]||(this.rowFlatKeys[s]=1)),i.length!==0&&(this.colFlatKeys[l]||(this.colFlatKeys[l]=1)),i.length===0&&o.length===0||(this.tree[s]||(this.tree[s]={}),n!==void 0&&(this.tree[s][l]={value:n,record:e},this.dataConfig.indicatorsAsCol?i.pop():o.pop()))})}getTreeNode(e=[],t=[],i,o=!0){var r,n,s,l;let d,a;if(typeof e=="string")d=e;else{let h=!1;e.map((c,u)=>{c===i&&(e.splice(u,1),h=!0)}),h&&e.push(i),d=e.join(this.stringJoinChar)}if(typeof t=="string")a=t;else{let h=!1;t.map((c,u)=>{c===i&&(t.splice(u,1),h=!0)}),h&&t.push(i),a=t.join(this.stringJoinChar)}return o?(s=(n=(r=this.tree)===null||r===void 0?void 0:r[d])===null||n===void 0?void 0:n[a])!==null&&s!==void 0?s:void 0:O((l=this.beforeChangedTree[d])===null||l===void 0?void 0:l[a])?{value:this.beforeChangedTree[d][a].value,record:this.beforeChangedTree[d][a].record}:void 0}changeTreeNodeValue(e=[],t=[],i,o){var r,n,s,l,d,a,h;let c,u;if(typeof e=="string")c=e;else{let m=!1;e.map((y,_)=>{y===i&&(e.splice(_,1),m=!0)}),m&&e.push(i),c=e.join(this.stringJoinChar)}if(typeof t=="string")u=t;else{let m=!1;t.map((y,_)=>{y===i&&(t.splice(_,1),m=!0)}),m&&t.push(i),u=t.join(this.stringJoinChar)}const v=(n=(r=this.tree[c])===null||r===void 0?void 0:r[u])===null||n===void 0?void 0:n.value,g=Object.assign({},(l=(s=this.tree[c])===null||s===void 0?void 0:s[u])===null||l===void 0?void 0:l.record);!((a=(d=this.tree[c])===null||d===void 0?void 0:d[u])===null||a===void 0)&&a.record?(this.tree[c][u].record[i]=o,this.tree[c][u].value=o):(this.tree[c]||(this.tree[c]={}),this.tree[c][u]={record:this._buildRecord(e,t,i,o),value:o}),!((h=this.beforeChangedTree[c])===null||h===void 0)&&h[u]||(this.beforeChangedTree[c]={},this.beforeChangedTree[c][u]={record:void 0,value:void 0},this.beforeChangedTree[c][u].record=g,this.beforeChangedTree[c][u].value=v)}_buildRecord(e=[],t=[],i,o){const r={},n=this.dataConfig.rows,s=this.dataConfig.columns;return n.forEach((l,d)=>{l!==this.dataConfig.indicatorDimensionKey&&(r[l]=e[d])}),s.forEach((l,d)=>{l!==this.dataConfig.indicatorDimensionKey&&(r[l]=t[d])}),r[i]=o,this.records.push(r),r}addRecords(e){for(let t=0,i=e.length;t<i;t++){const o=e[t];this.processRecord(o)}this.records.push(e)}changeRecordFieldValue(e,t,i){let o=!1;for(let r=0;r<this.dataConfig.indicators.length;r++)this.dataConfig.indicators[r]===e&&(o=!0);if(!o){for(let r=0,n=this.records.length;r<n;r++){const s=this.records[r];s[e]===t&&(s[e]=i)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}}function Vt(D,e){let t="";for(let i=0;i<D.length;i++)t+=D[i],i!==D.length-1&&(t+=e);return t}class at{constructor(e,t,i,o,r,n,s,l,d,a,h,c,u){var v,g,m,y,_,S,P,f,p,I,w,C,T,H,b,x,A,E,Q,J,U,X,se,ne,le,ae,de,he,ue,Ce,_e,we,He,Te,Pe,Se,be,ee;this.tree={},this.changedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.colKeys_normal=[],this.rowKeys_normal=[],this.rowOrder="key_a_to_z",this.colOrder="key_a_to_z",this.sorted=!1,this.indicatorStatistics=[],this.aggregators={},this.stringJoinChar="\0",this.rowsIsTotal=[],this.colsIsTotal=[],this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.registerAggregators(),this.dataConfig=e,this.filterRules=(v=this.dataConfig)===null||v===void 0?void 0:v.filterRules,this.rowHierarchyType=l??"grid",this.sortRules=(g=this.dataConfig)===null||g===void 0?void 0:g.sortRules,this.aggregationRules=(m=this.dataConfig)===null||m===void 0?void 0:m.aggregationRules,this.derivedFieldRules=(y=this.dataConfig)===null||y===void 0?void 0:y.derivedFieldRules,this.mappingRules=(_=this.dataConfig)===null||_===void 0?void 0:_.mappingRules,this.calculatedFieldRules=(S=this.dataConfig)===null||S===void 0?void 0:S.calculatedFieldRules,this.calculatedFiledKeys=(f=(P=this.calculatedFieldRules)===null||P===void 0?void 0:P.map(j=>j.key))!==null&&f!==void 0?f:[],this.calculatedFieldDependIndicatorKeys=(I=(p=this.calculatedFieldRules)===null||p===void 0?void 0:p.reduce((j,q)=>{for(let G=0;G<q.dependIndicatorKeys.length;G++)j.indexOf(q.dependIndicatorKeys[G])===-1&&j.push(q.dependIndicatorKeys[G]);return j},[]))!==null&&I!==void 0?I:[],this.totals=(w=this.dataConfig)===null||w===void 0?void 0:w.totals,this.rows=t,this.columns=i,this.indicatorKeys=o,this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys=[...o];for(let j=0;j<this.calculatedFieldDependIndicatorKeys.length;j++)this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.indexOf(this.calculatedFieldDependIndicatorKeys[j])===-1&&this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.push(this.calculatedFieldDependIndicatorKeys[j]);if(this.indicatorsAsCol=n,this.indicators=r,this.customColTree=d,this.customRowTree=a,this.hasExtensionRowTree=c,this.parseCustomTreeToMatchRecords=u,this.parseCustomTreeToMatchRecords&&(this.customColTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customColTree,"col"),this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,"row"))),this.colGrandTotalLabel=(H=(T=(C=this.totals)===null||C===void 0?void 0:C.column)===null||T===void 0?void 0:T.grandTotalLabel)!==null&&H!==void 0?H:"总计",this.colSubTotalLabel=(A=(x=(b=this.totals)===null||b===void 0?void 0:b.column)===null||x===void 0?void 0:x.subTotalLabel)!==null&&A!==void 0?A:"小计",this.rowGrandTotalLabel=(J=(Q=(E=this.totals)===null||E===void 0?void 0:E.row)===null||Q===void 0?void 0:Q.grandTotalLabel)!==null&&J!==void 0?J:"总计",this.rowSubTotalLabel=(se=(X=(U=this.totals)===null||U===void 0?void 0:U.row)===null||X===void 0?void 0:X.subTotalLabel)!==null&&se!==void 0?se:"小计",this.collectValuesBy=(ne=this.dataConfig)===null||ne===void 0?void 0:ne.collectValuesBy,this.needSplitPositiveAndNegative=h!=null&&h,this.rowsIsTotal=new Array((ae=(le=this.rows)===null||le===void 0?void 0:le.length)!==null&&ae!==void 0?ae:0).fill(!1),this.colsIsTotal=new Array((he=(de=this.columns)===null||de===void 0?void 0:de.length)!==null&&he!==void 0?he:0).fill(!1),((ue=this.totals)===null||ue===void 0?void 0:ue.row)&&this.totals.row.showSubTotals!==!1&&this.totals.row.subTotalsDimensions)for(let j=0,q=(He=(we=(_e=(Ce=this.totals)===null||Ce===void 0?void 0:Ce.row)===null||_e===void 0?void 0:_e.subTotalsDimensions)===null||we===void 0?void 0:we.length)!==null&&He!==void 0?He:0;j<q;j++){const G=this.totals.row.subTotalsDimensions[j],ve=this.rows.indexOf(G);this.rowsIsTotal[ve]=!0}if(!((Te=this.totals)===null||Te===void 0)&&Te.column&&this.totals.column.showSubTotals!==!1&&this.totals.column.subTotalsDimensions)for(let j=0,q=(ee=(be=(Se=(Pe=this.totals)===null||Pe===void 0?void 0:Pe.column)===null||Se===void 0?void 0:Se.subTotalsDimensions)===null||be===void 0?void 0:be.length)!==null&&ee!==void 0?ee:0;j<q;j++){const G=this.totals.column.subTotalsDimensions[j],ve=this.columns.indexOf(G);this.colsIsTotal[ve]=!0}this.setRecords(s)}setRecords(e){var t,i,o,r,n,s,l,d,a,h,c,u,v,g,m,y,_,S,P;this.records=e,this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.tree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.rowsHasValue=[],this.columnsHasValue=[],e&&(this.records=e,typeof window<"u"&&window.performance.now(),this.processRecords(),this.processCollectedValuesWithSumBy(),this.generateCollectedValuesSortRule(),this.processCollectedValuesWithSortBy(),typeof window<"u"&&window.performance.now(),typeof window<"u"&&window.performance.now(),this.totalStatistics(),typeof window<"u"&&window.performance.now(),this.rowKeys_normal=this.rowKeys.slice(),this.colKeys_normal=this.colKeys.slice(),typeof window<"u"&&window.performance.now(),this.sortKeys(),typeof window<"u"&&window.performance.now(),typeof window<"u"&&window.performance.now(),this.customRowTree?this.rowHeaderTree=this.customRowTree:this.rowHierarchyType==="tree"?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((f,p)=>this.rowsHasValue[p]),this.indicatorsAsCol?void 0:this.indicators,((i=(t=this.totals)===null||t===void 0?void 0:t.row)===null||i===void 0?void 0:i.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((f,p)=>this.rowsHasValue[p]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,((r=(o=this.totals)===null||o===void 0?void 0:o.row)===null||r===void 0?void 0:r.showGrandTotals)||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel,this.rowSubTotalLabel,(l=(s=(n=this.totals)===null||n===void 0?void 0:n.row)===null||s===void 0?void 0:s.showGrandTotalsOnTop)!==null&&l!==void 0&&l,(h=(a=(d=this.totals)===null||d===void 0?void 0:d.row)===null||a===void 0?void 0:a.showSubTotalsOnTop)!==null&&h!==void 0&&h),this.customColTree?this.colHeaderTree=this.customColTree:this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((f,p)=>this.columnsHasValue[p]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,((u=(c=this.totals)===null||c===void 0?void 0:c.column)===null||u===void 0?void 0:u.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0,this.colGrandTotalLabel,this.colSubTotalLabel,(m=(g=(v=this.totals)===null||v===void 0?void 0:v.column)===null||g===void 0?void 0:g.showGrandTotalsOnLeft)!==null&&m!==void 0&&m,(S=(_=(y=this.totals)===null||y===void 0?void 0:y.column)===null||_===void 0?void 0:_.showSubTotalsOnLeft)!==null&&S!==void 0&&S),typeof window<"u"&&window.performance.now(),!((P=this.dataConfig)===null||P===void 0)&&P.isPivotChart&&this.cacheDeminsionCollectedValues())}registerAggregator(e,t){this.aggregators[e]=t}registerAggregators(){this.registerAggregator(ie.RECORD,Fi),this.registerAggregator(ie.SUM,Ai),this.registerAggregator(ie.COUNT,Ki),this.registerAggregator(ie.MAX,Li),this.registerAggregator(ie.MIN,xi),this.registerAggregator(ie.AVG,Mi),this.registerAggregator(ie.NONE,Oi),this.registerAggregator(ie.RECALCULATE,Ei)}processCollectedValuesWithSumBy(){var e,t,i,o,r,n;for(const s in this.collectedValues)if(!((t=(e=this.collectValuesBy)===null||e===void 0?void 0:e[s])===null||t===void 0)&&t.sumBy)for(const l in this.collectedValues[s]){let d;((i=this.collectValuesBy[s])===null||i===void 0?void 0:i.extendRange)==="sum"?(d=Object.values(this.collectedValues[s][l]).reduce((u,v)=>u+v.value(),0),d+=Math.round(d/20)):(d=Object.values(this.collectedValues[s][l]).reduce((u,v)=>v.value()>u?v.value():u,Number.MIN_SAFE_INTEGER),((o=this.collectValuesBy[s])===null||o===void 0?void 0:o.extendRange)==="max"?d+=Math.round(d/20):typeof((r=this.collectValuesBy[s])===null||r===void 0?void 0:r.extendRange)=="number"&&(d=Math.max(d,(n=this.collectValuesBy[s])===null||n===void 0?void 0:n.extendRange)));const a=Object.values(this.collectedValues[s][l]).reduce((u,v)=>v.value()<u?v.value():u,Number.MAX_SAFE_INTEGER);let h,c;this.needSplitPositiveAndNegative&&(h=Object.values(this.collectedValues[s][l]).reduce((u,v)=>v.positiveValue()>u?v.positiveValue():u,Number.MIN_SAFE_INTEGER),c=Object.values(this.collectedValues[s][l]).reduce((u,v)=>v.negativeValue()<u?v.negativeValue():u,Number.MAX_SAFE_INTEGER)),this.collectedValues[s][l]={},this.collectedValues[s][l].max=d,this.collectedValues[s][l].min=a,this.needSplitPositiveAndNegative&&(this.collectedValues[s][l].positiveMax=h,this.collectedValues[s][l].negativeMin=c)}}processCollectedValuesWithSortBy(){var e,t;const i=this;for(const o in this.collectedValues)if(!((t=(e=this.collectValuesBy)===null||e===void 0?void 0:e[o])===null||t===void 0)&&t.sortBy)for(const r in this.collectedValues[o])this.collectedValues[o][r]=this.collectedValues[o][r].sort((n,s)=>{var l,d,a,h;return((d=(l=i.collectValuesBy[o].sortBy)===null||l===void 0?void 0:l.indexOf(n))!==null&&d!==void 0?d:-1)-((h=(a=i.collectValuesBy[o].sortBy)===null||a===void 0?void 0:a.indexOf(s))!==null&&h!==void 0?h:-1)})}generateCollectedValuesSortRule(){for(const e in this.collectedValues)if(this.collectValuesBy&&this.collectValuesBy[e]&&!this.collectValuesBy[e].sortBy){let t=[];for(const i in this.collectedValues[e])Array.isArray(this.collectedValues[e][i])&&(t.push(...this.collectedValues[e][i]),t=Array.from(new Set(t)));t.length>0&&(this.collectValuesBy[e].sortBy=t)}}processRecords(){var e,t;let i=!1;if(((t=(e=this.filterRules)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0)>=1&&(i=!0),Array.isArray(this.records)){this.filteredRecords||(this.filteredRecords=[]);for(let o=0,r=this.records.length;o<r;o++){const n=this.records[o];i&&!this.filterRecord(n)||(this.filteredRecords.push(n),this.processRecord(n))}}else{this.filteredRecords||(this.filteredRecords={});for(const o in this.records)for(let r=0,n=this.records[o].length;r<n;r++){const s=this.records[o][r];i&&!this.filterRecord(s)||(this.filteredRecords[o]||(this.filteredRecords[o]=[]),this.filteredRecords[o].push(s),this.processRecord(s,o))}}this.rowFlatKeys={},this.colFlatKeys={}}filterRecord(e){var t,i;let o=!0;if(this.filterRules)for(let r=0;r<this.filterRules.length;r++){const n=this.filterRules[r];if(n.filterKey){const s=e[n.filterKey];if(((t=n.filteredValues)===null||t===void 0?void 0:t.indexOf(s))===-1){o=!1;break}}else if(!(!((i=n.filterFunc)===null||i===void 0)&&i.call(n,e))){o=!1;break}}return o}processRecord(e,t){var i,o,r,n,s,l,d,a,h,c,u,v,g,m,y,_,S,P,f,p,I,w,C,T,H,b,x,A,E,Q,J,U,X,se,ne,le,ae,de,he,ue,Ce,_e,we,He,Te,Pe,Se,be,ee,j,q,G,ve,ye,me,oe,pe,Ie,Be,Ve,ze,ke,je,We,Ue;(i=this.derivedFieldRules)===null||i===void 0||i.forEach((R,K)=>{R.fieldName&&R.derivedFunc&&(e[R.fieldName]=R.derivedFunc(e))});for(const R in this.collectValuesBy)if(O(e[R])){this.collectedValues[R]||(this.collectedValues[R]={});const K=this.collectValuesBy[R].by.map(z=>e[z]).join(this.stringJoinChar);if(this.collectedValues[R][K]||(this.collectValuesBy[R].sumBy?this.collectedValues[R][K]={}:this.collectValuesBy[R].range?this.collectedValues[R][K]={min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER}:this.collectedValues[R][K]=[]),this.collectValuesBy[R].sumBy){const z=this.collectValuesBy[R].sumBy.map(W=>e[W]).join(this.stringJoinChar);this.collectedValues[R][K][z]||(this.collectedValues[R][K][z]=new this.aggregators[ie.SUM]({key:R,dimension:R,isRecord:void 0,needSplitPositiveAndNegative:this.needSplitPositiveAndNegative})),this.collectedValues[R][K][z].push(e)}else if(this.collectValuesBy[R].range){const z=this.collectedValues[R][K],W=Math.max(e[R],z.max),$=Math.min(e[R],z.min);isNaN(W)||(z.max=W,z.min=$)}else{const z=this.collectedValues[R][K];z.indexOf(e[R])===-1&&z.push(e[R])}}let xe=!1;const qe=[],re=[];if(!this.parseCustomTreeToMatchRecords||!((o=this.dataConfig)===null||o===void 0)&&o.isPivotChart||!(!((r=this.customRowTree)===null||r===void 0)&&r.length)||t||this.hasExtensionRowTree){const R=[];re.push({rowKey:R,indicatorKey:t});for(let K=0,z=this.rows.length;K<z;K++){const W=this.rows[K];if(W in e)this.rowsHasValue[K]=!0,R.push(e[W]);else if(W!==Me){if(!((l=(s=(n=this.dataConfig)===null||n===void 0?void 0:n.totals)===null||s===void 0?void 0:s.row)===null||l===void 0)&&l.showGrandTotals&&K===0&&!this.rows.find($=>$ in e)){R.push(this.rowGrandTotalLabel),xe=!0;break}if(!((h=(a=(d=this.dataConfig)===null||d===void 0?void 0:d.totals)===null||a===void 0?void 0:a.row)===null||h===void 0)&&h.subTotalsDimensions&&((v=(u=(c=this.dataConfig)===null||c===void 0?void 0:c.totals)===null||u===void 0?void 0:u.row)===null||v===void 0?void 0:v.subTotalsDimensions.indexOf(this.rows[K-1]))>=0){this.rowHierarchyType==="grid"&&R.push(this.rowSubTotalLabel),xe=!0;break}}}}else{const R=this.getFieldMatchRowDimensionPaths(e);if(R.length>0)for(let K=0,z=R.length;K<z;K++){const W=R[K],$=[];let k;for(let M=0,Y=W.length;M<Y;M++)O(W[M].indicatorKey)?k=W[M].indicatorKey:$.push(W[M].value);re.push({rowKey:$,indicatorKey:k})}}if(!this.parseCustomTreeToMatchRecords||!((g=this.dataConfig)===null||g===void 0)&&g.isPivotChart||!(!((m=this.customColTree)===null||m===void 0)&&m.length)||t||this.hasExtensionRowTree){const R=[];qe.push({colKey:R,indicatorKey:t});for(let K=0,z=this.columns.length;K<z;K++){const W=this.columns[K];if(W in e)this.columnsHasValue[K]=!0,R.push(e[W]);else if(W!==Me){if(!((S=(_=(y=this.dataConfig)===null||y===void 0?void 0:y.totals)===null||_===void 0?void 0:_.column)===null||S===void 0)&&S.showGrandTotals&&K===0&&!this.columns.find($=>$ in e)){R.push(this.colGrandTotalLabel),xe=!0;break}if(!((p=(f=(P=this.dataConfig)===null||P===void 0?void 0:P.totals)===null||f===void 0?void 0:f.column)===null||p===void 0)&&p.subTotalsDimensions&&((C=(w=(I=this.dataConfig)===null||I===void 0?void 0:I.totals)===null||w===void 0?void 0:w.column)===null||C===void 0?void 0:C.subTotalsDimensions.indexOf(this.columns[K-1]))>=0){R.push(this.colSubTotalLabel),xe=!0;break}}}}else{const R=this.getFieldMatchColDimensionPaths(e);if(R.length>0)for(let K=0,z=R.length;K<z;K++){const W=R[K],$=[];let k;for(let M=0,Y=W.length;M<Y;M++)O(W[M].indicatorKey)?k=W[M].indicatorKey:$.push(W[M].value);qe.push({colKey:$,indicatorKey:k})}}for(let R=0;R<re.length;R++){const K=re[R].rowKey;let z;this.indicatorsAsCol||(z=re[R].indicatorKey);for(let W=0;W<qe.length;W++){const $=qe[W].colKey;this.indicatorsAsCol&&(z=qe[W].indicatorKey);const k=K.join(this.stringJoinChar),M=$.join(this.stringJoinChar);if(xe){this.totalRecordsTree[k]||(this.totalRecordsTree[k]={}),this.totalRecordsTree[k][M]||(this.totalRecordsTree[k][M]=[]);const F=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let V=0;V<F.length;V++)if(this.calculatedFiledKeys.indexOf(F[V])>=0){const te=(T=this.calculatedFieldRules)===null||T===void 0?void 0:T.find(Fe=>Fe.key===F[V]);!((b=(H=this.totalRecordsTree[k])===null||H===void 0?void 0:H[M])===null||b===void 0)&&b[V]||(this.totalRecordsTree[k][M][V]=new this.aggregators[ie.RECALCULATE]({key:F[V],dimension:F[V],isRecord:!0,formatFun:(A=(x=this.indicators)===null||x===void 0?void 0:x.find(Fe=>typeof Fe!="string"&&Fe.indicatorKey===F[V]))===null||A===void 0?void 0:A.format,calculateFun:te==null?void 0:te.calculateFun,dependAggregators:this.totalRecordsTree[k][M],dependIndicatorKeys:te==null?void 0:te.dependIndicatorKeys})),F[V]in e&&((Q=(E=this.totalRecordsTree[k])===null||E===void 0?void 0:E[M])===null||Q===void 0||Q[V].push(e))}else{const te=this.getAggregatorRule(F[V]);!((U=(J=this.totalRecordsTree[k])===null||J===void 0?void 0:J[M])===null||U===void 0)&&U[V]||(this.totalRecordsTree[k][M][V]=new this.aggregators[(X=te==null?void 0:te.aggregationType)!==null&&X!==void 0?X:ie.SUM]({key:F[V],dimension:(se=te==null?void 0:te.field)!==null&&se!==void 0?se:F[V],formatFun:(ne=te==null?void 0:te.formatFun)!==null&&ne!==void 0?ne:(ae=(le=this.indicators)===null||le===void 0?void 0:le.find(Fe=>typeof Fe!="string"&&Fe.indicatorKey===F[V]))===null||ae===void 0?void 0:ae.format})),F[V]in e&&((he=(de=this.totalRecordsTree[k])===null||de===void 0?void 0:de[M])===null||he===void 0||he[V].push(e))}return}K.length!==0&&(this.rowFlatKeys[k]||(this.rowKeys.push(K),this.rowFlatKeys[k]=1)),$.length!==0&&(this.colFlatKeys[M]||(this.colKeys.push($),this.colFlatKeys[M]=1)),this.tree[k]||(this.tree[k]={}),!((ue=this.tree[k])===null||ue===void 0)&&ue[M]||(this.tree[k][M]=[]);const Y=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let F=0;F<Y.length;F++)if(this.calculatedFiledKeys.indexOf(Y[F])>=0){const V=(Ce=this.calculatedFieldRules)===null||Ce===void 0?void 0:Ce.find(te=>te.key===Y[F]);!((we=(_e=this.tree[k])===null||_e===void 0?void 0:_e[M])===null||we===void 0)&&we[F]||(this.tree[k][M][F]=new this.aggregators[ie.RECALCULATE]({key:Y[F],dimension:Y[F],isRecord:!0,formatFun:(Te=(He=this.indicators)===null||He===void 0?void 0:He.find(te=>typeof te!="string"&&te.indicatorKey===Y[F]))===null||Te===void 0?void 0:Te.format,calculateFun:V==null?void 0:V.calculateFun,dependAggregators:this.tree[k][M],dependIndicatorKeys:V==null?void 0:V.dependIndicatorKeys})),(Se=(Pe=this.tree[k])===null||Pe===void 0?void 0:Pe[M])===null||Se===void 0||Se[F].push(e)}else{const V=this.getAggregatorRule(Y[F]);let te=!1;z?t===z?Y[F]===z&&(te=!0):Y[F]===z&&Y[F]in e&&(te=!0):V!=null&&V.field?typeof(V==null?void 0:V.field)=="string"?(V==null?void 0:V.field)in e&&(te=!0):V!=null&&V.field.find(Fe=>Fe in e)&&(te=!0):Y[F]in e&&(te=!0),!(!((ee=(be=this.tree[k])===null||be===void 0?void 0:be[M])===null||ee===void 0)&&ee[F])&&te&&(this.tree[k][M][F]=new this.aggregators[(j=V==null?void 0:V.aggregationType)!==null&&j!==void 0?j:ie.SUM]({key:Y[F],dimension:(q=V==null?void 0:V.field)!==null&&q!==void 0?q:Y[F],formatFun:(G=V==null?void 0:V.formatFun)!==null&&G!==void 0?G:(ye=(ve=this.indicators)===null||ve===void 0?void 0:ve.find(Fe=>typeof Fe!="string"&&Fe.indicatorKey===Y[F]))===null||ye===void 0?void 0:ye.format})),te&&((oe=(me=this.tree[k])===null||me===void 0?void 0:me[M])===null||oe===void 0||oe[F].push(e))}if(this.mappingRules)for(let F=0;F<this.indicatorKeys.length;F++){if(!this.indicatorStatistics[F]){const V=this.getAggregatorRule(this.indicatorKeys[F]);this.indicatorStatistics[F]={max:new this.aggregators[ie.MAX]({key:this.indicatorKeys[F],dimension:this.indicatorKeys[F]}),min:new this.aggregators[ie.MIN]({key:this.indicatorKeys[F],dimension:this.indicatorKeys[F]}),total:new this.aggregators[(pe=V==null?void 0:V.aggregationType)!==null&&pe!==void 0?pe:ie.SUM]({key:this.indicatorKeys[F],dimension:(Ie=V==null?void 0:V.field)!==null&&Ie!==void 0?Ie:this.indicatorKeys[F],formatFun:(Be=V==null?void 0:V.formatFun)!==null&&Be!==void 0?Be:(ze=(Ve=this.indicators)===null||Ve===void 0?void 0:Ve.find(te=>typeof te!="string"&&te.indicatorKey===this.indicatorKeys[F]))===null||ze===void 0?void 0:ze.format})}}this.indicatorStatistics[F].max.push((je=(ke=this.tree[k])===null||ke===void 0?void 0:ke[M])===null||je===void 0?void 0:je[F].value()),this.indicatorStatistics[F].min.push((Ue=(We=this.tree[k])===null||We===void 0?void 0:We[M])===null||Ue===void 0?void 0:Ue[F].value()),this.indicatorStatistics[F].total.push(e)}}}}updateSortRules(e){var t,i,o,r,n,s,l,d,a,h,c,u,v,g,m,y,_,S;this.sorted=!1,this.sortRules=e,this.sortKeys(),this.customRowTree||(this.rowHierarchyType==="tree"?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((P,f)=>this.rowsHasValue[f]),this.indicatorsAsCol?void 0:this.indicators,((i=(t=this.totals)===null||t===void 0?void 0:t.row)===null||i===void 0?void 0:i.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((P,f)=>this.rowsHasValue[f]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,((r=(o=this.totals)===null||o===void 0?void 0:o.row)===null||r===void 0?void 0:r.showGrandTotals)||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel,this.rowSubTotalLabel,(l=(s=(n=this.totals)===null||n===void 0?void 0:n.row)===null||s===void 0?void 0:s.showGrandTotalsOnTop)!==null&&l!==void 0&&l,(h=(a=(d=this.totals)===null||d===void 0?void 0:d.row)===null||a===void 0?void 0:a.showSubTotalsOnTop)!==null&&h!==void 0&&h)),this.customColTree||(this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((P,f)=>this.columnsHasValue[f]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,((u=(c=this.totals)===null||c===void 0?void 0:c.column)===null||u===void 0?void 0:u.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0,this.colGrandTotalLabel,this.colSubTotalLabel,(m=(g=(v=this.totals)===null||v===void 0?void 0:v.column)===null||g===void 0?void 0:g.showGrandTotalsOnLeft)!==null&&m!==void 0&&m,(S=(_=(y=this.totals)===null||y===void 0?void 0:y.column)===null||_===void 0?void 0:_.showSubTotalsOnLeft)!==null&&S!==void 0&&S))}updateFilterRules(e,t=!1){var i,o;if(this.filterRules=e,this.filteredRecords=void 0,t)this.tree={};else for(const r in this.tree)for(const n in this.tree[r])for(let s=0;s<this.tree[r][n].length;s++)(i=this.tree[r][n][s])===null||i===void 0||i.reset();this.collectedValues={},this.processRecords(),this.processCollectedValuesWithSumBy(),this.processCollectedValuesWithSortBy(),this.totalStatistics(),!((o=this.dataConfig)===null||o===void 0)&&o.isPivotChart&&this.cacheDeminsionCollectedValues()}getAggregatorRule(e){var t;return(t=this.aggregationRules)===null||t===void 0?void 0:t.find((i,o)=>e===i.indicatorKey)}getAggregator(e=[],t=[],i,o=!0,r){var n,s,l,d;const a=this.indicatorKeys.indexOf(i);let h,c;typeof e=="string"?h=e:(r&&r.position!=="row"||e.map((v,g)=>{v!==i||O(r==null?void 0:r.index)&&g!==r.index||e.splice(g,1)}),h=Vt(e,this.stringJoinChar)),typeof t=="string"?c=t:(r&&r.position!=="col"||t.map((v,g)=>{v!==i||O(r==null?void 0:r.index)&&g!==r.index||t.splice(g,1)}),c=Vt(t,this.stringJoinChar));const u=(s=(n=this.tree[h])===null||n===void 0?void 0:n[c])===null||s===void 0?void 0:s[a];if(o&&O((d=(l=this.changedTree[h])===null||l===void 0?void 0:l[c])===null||d===void 0?void 0:d[a])){const v=this.changedTree[h][c][a];return u?{value:()=>v,formatValue:u.formatValue,formatFun:u.formatFun,records:u.records,className:"",recalculate(){},push(){},deleteRecord(){},updateRecord(){},clearCacheValue(){},reset(){}}:{value:()=>v,className:"",push(){},deleteRecord(){},updateRecord(){},recalculate(){},formatValue:()=>v,clearCacheValue(){},reset(){}}}return u||{className:"",push(){},deleteRecord(){},updateRecord(){},recalculate(){},value:()=>null,clearCacheValue(){},reset(){}}}sortKeys(){if(this.colKeys=this.colKeys_normal.slice(),this.rowKeys=this.rowKeys_normal.slice(),!this.sorted){this.sorted=!0,this.rowKeys.sort(this.arrSort(this.rows,!0));const e=this.arrSort(this.columns,!1);this.colKeys.sort(e)}}arrSort(e,t){let i;const o=this,r=(function(n){const s=[];for(let l=0,d=e.length;l<d;l++)if(i=e[l],o.sortRules)for(let a=0,h=o.sortRules.length;a<h;a++)o.sortRules[a].sortField===i&&s.push({field:i,fieldIndex:l,sortRule:o.sortRules[a],func:o.getSort(o.sortRules[a],t)});return s}).call(this);return function(n,s){var l,d,a,h;let c,u;for(let v=0;v<r.length;v++){if(u=r[v],(l=u.sortRule)===null||l===void 0?void 0:l.sortByIndicator){let g=n,m=s;u.fieldIndex<e.length-1&&(g=n.slice(0,u.fieldIndex+1),o.rowHierarchyType==="grid"&&t?g.push(o.rowSubTotalLabel):t||g.push(o.colSubTotalLabel),m=s.slice(0,u.fieldIndex+1),o.rowHierarchyType==="grid"&&t?m.push(o.rowSubTotalLabel):t||m.push(o.colSubTotalLabel)),c=u.func(g,m,(d=u.sortRule)===null||d===void 0?void 0:d.sortType)}else c=(a=u.func)===null||a===void 0?void 0:a.call(u,n[u.fieldIndex],s[u.fieldIndex],(h=u.sortRule)===null||h===void 0?void 0:h.sortType);if(c!==0)return c}return 0}}getSort(e,t){const i=this;return e.sortByIndicator?(o,r,n)=>{const s=function(l,d){return i.rowHierarchyType==="grid"&&l.length<i.rows.length&&l[l.length-1]!==i.rowSubTotalLabel&&l[l.length-1]!==i.rowGrandTotalLabel&&l.push(i.rowSubTotalLabel),d.length<i.columns.length&&d[d.length-1]!==i.colSubTotalLabel&&d[d.length-1]!==i.colGrandTotalLabel&&d.push(i.colSubTotalLabel),i.getAggregator(l,d,e.sortByIndicator).value()};return t?gt(s(o,e.query),s(r,e.query),n):gt(s(e.query,o),s(e.query,r),n)}:e.sortBy?Ni(e.sortBy):e.sortFunc?e.sortFunc:e.sortType?Bi:gt}totalStatistics(){var e,t,i,o,r,n,s,l,d,a,h,c,u,v;const g=this,m=(y,_)=>{var S,P,f,p,I,w,C,T,H,b,x,A,E,Q,J,U,X,se,ne,le,ae,de,he,ue,Ce,_e,we,He,Te,Pe,Se,be,ee,j,q,G,ve,ye,me,oe,pe,Ie,Be,Ve,ze,ke,je,We,Ue,xe;if(!((P=(S=this.totalRecordsTree)===null||S===void 0?void 0:S[y])===null||P===void 0)&&P[_])return this.tree[y]||(this.tree[y]={}),void(this.tree[y][_]=(p=(f=this.totalRecordsTree)===null||f===void 0?void 0:f[y])===null||p===void 0?void 0:p[_]);const qe=_.split(this.stringJoinChar);if(!((w=(I=g.totals)===null||I===void 0?void 0:I.column)===null||w===void 0)&&w.subTotalsDimensions&&((H=(T=(C=g.totals)===null||C===void 0?void 0:C.column)===null||T===void 0?void 0:T.subTotalsDimensions)===null||H===void 0?void 0:H.length)>0&&g.totals.column.showSubTotals!==!1)for(let re=0,R=(A=(x=(b=g.totals)===null||b===void 0?void 0:b.column)===null||x===void 0?void 0:x.subTotalsDimensions)===null||A===void 0?void 0:A.length;re<R;re++){const K=g.totals.column.subTotalsDimensions[re],z=g.columns.indexOf(K);if(z>=0){const W=qe.slice(0,z+1);W.push(g.colSubTotalLabel);const $=W.join(this.stringJoinChar);if(!((Q=(E=this.totalRecordsTree)===null||E===void 0?void 0:E[y])===null||Q===void 0)&&Q[$])return void(this.tree[y][$]=(U=(J=this.totalRecordsTree)===null||J===void 0?void 0:J[y])===null||U===void 0?void 0:U[$]);this.tree[y][$]||(this.tree[y][$]=[]);const k=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let M=0;M<k.length;M++)if(this.calculatedFiledKeys.indexOf(k[M])>=0){const Y=(X=this.calculatedFieldRules)===null||X===void 0?void 0:X.find(F=>F.key===k[M]);!((ne=(se=this.tree[y])===null||se===void 0?void 0:se[$])===null||ne===void 0)&&ne[M]||(this.tree[y][$][M]=new this.aggregators[ie.RECALCULATE]({key:k[M],dimension:k[M],isRecord:!0,formatFun:(ae=(le=this.indicators)===null||le===void 0?void 0:le.find(F=>typeof F!="string"&&F.indicatorKey===k[M]))===null||ae===void 0?void 0:ae.format,calculateFun:Y==null?void 0:Y.calculateFun,dependAggregators:this.tree[y][$],dependIndicatorKeys:Y==null?void 0:Y.dependIndicatorKeys})),$!==_&&this.tree[y][$][M].push((he=(de=g.tree[y])===null||de===void 0?void 0:de[_])===null||he===void 0?void 0:he[M])}else{if(!this.tree[y][$][M]){const Y=this.getAggregatorRule(k[M]);this.tree[y][$][M]=new this.aggregators[(ue=Y==null?void 0:Y.aggregationType)!==null&&ue!==void 0?ue:ie.SUM]({key:k[M],dimension:(Ce=Y==null?void 0:Y.field)!==null&&Ce!==void 0?Ce:k[M],formatFun:(_e=Y==null?void 0:Y.formatFun)!==null&&_e!==void 0?_e:(He=(we=this.indicators)===null||we===void 0?void 0:we.find(F=>typeof F!="string"&&F.indicatorKey===k[M]))===null||He===void 0?void 0:He.format})}$!==_&&this.tree[y][$][M].push((Pe=(Te=g.tree[y])===null||Te===void 0?void 0:Te[_])===null||Pe===void 0?void 0:Pe[M])}}}if(!((be=(Se=g.totals)===null||Se===void 0?void 0:Se.column)===null||be===void 0)&&be.showGrandTotals||this.rows.length===0){const re=g.colGrandTotalLabel;if(!((j=(ee=this.totalRecordsTree)===null||ee===void 0?void 0:ee[y])===null||j===void 0)&&j[re])return void(this.tree[y][re]=(G=(q=this.totalRecordsTree)===null||q===void 0?void 0:q[y])===null||G===void 0?void 0:G[re]);this.tree[y][re]||(this.tree[y][re]=[]);const R=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let K=0;K<R.length;K++)if(this.calculatedFiledKeys.indexOf(R[K])>=0){const z=(ve=this.calculatedFieldRules)===null||ve===void 0?void 0:ve.find(W=>W.key===R[K]);!((me=(ye=this.tree[y])===null||ye===void 0?void 0:ye[re])===null||me===void 0)&&me[K]||(this.tree[y][re][K]=new this.aggregators[ie.RECALCULATE]({key:R[K],dimension:R[K],isRecord:!0,formatFun:(pe=(oe=this.indicators)===null||oe===void 0?void 0:oe.find(W=>typeof W!="string"&&W.indicatorKey===R[K]))===null||pe===void 0?void 0:pe.format,calculateFun:z==null?void 0:z.calculateFun,dependAggregators:this.tree[y][re],dependIndicatorKeys:z==null?void 0:z.dependIndicatorKeys})),re!==_&&this.tree[y][re][K].push((Be=(Ie=g.tree[y])===null||Ie===void 0?void 0:Ie[_])===null||Be===void 0?void 0:Be[K])}else{if(!this.tree[y][re][K]){const z=this.getAggregatorRule(R[K]);this.tree[y][re][K]=new this.aggregators[(Ve=z==null?void 0:z.aggregationType)!==null&&Ve!==void 0?Ve:ie.SUM]({key:R[K],dimension:(ze=z==null?void 0:z.field)!==null&&ze!==void 0?ze:R[K],formatFun:(ke=z==null?void 0:z.formatFun)!==null&&ke!==void 0?ke:(We=(je=this.indicators)===null||je===void 0?void 0:je.find(W=>typeof W!="string"&&W.indicatorKey===R[K]))===null||We===void 0?void 0:We.format})}re!==_&&this.tree[y][re][K].push((xe=(Ue=g.tree[y])===null||Ue===void 0?void 0:Ue[_])===null||xe===void 0?void 0:xe[K])}}};if(!((t=(e=g==null?void 0:g.totals)===null||e===void 0?void 0:e.column)===null||t===void 0)&&t.subTotalsDimensions&&((r=(o=(i=g==null?void 0:g.totals)===null||i===void 0?void 0:i.column)===null||o===void 0?void 0:o.subTotalsDimensions)===null||r===void 0?void 0:r.length)>=1||!((s=(n=g==null?void 0:g.totals)===null||n===void 0?void 0:n.row)===null||s===void 0)&&s.subTotalsDimensions&&((a=(d=(l=g==null?void 0:g.totals)===null||l===void 0?void 0:l.row)===null||d===void 0?void 0:d.subTotalsDimensions)===null||a===void 0?void 0:a.length)>=1||!((c=(h=g==null?void 0:g.totals)===null||h===void 0?void 0:h.column)===null||c===void 0)&&c.showGrandTotals||!((v=(u=g==null?void 0:g.totals)===null||u===void 0?void 0:u.row)===null||v===void 0)&&v.showGrandTotals){const y=[];Object.keys(g.tree).forEach(_=>{const S=_.split(this.stringJoinChar);Object.keys(g.tree[_]).forEach(P=>{var f,p,I,w,C,T,H,b,x,A,E,Q,J,U,X,se,ne,le,ae,de,he,ue,Ce,_e,we,He,Te,Pe,Se,be;if(!((p=(f=g.totals)===null||f===void 0?void 0:f.row)===null||p===void 0)&&p.subTotalsDimensions&&((C=(w=(I=g.totals)===null||I===void 0?void 0:I.row)===null||w===void 0?void 0:w.subTotalsDimensions)===null||C===void 0?void 0:C.length)>0&&g.totals.row.showSubTotals!==!1)for(let ee=0,j=(b=(H=(T=g.totals)===null||T===void 0?void 0:T.row)===null||H===void 0?void 0:H.subTotalsDimensions)===null||b===void 0?void 0:b.length;ee<j;ee++){const q=g.totals.row.subTotalsDimensions[ee],G=g.rows.indexOf(q);if(G>=0&&G<g.rows.length-1){const ve=S.slice(0,G+1);this.rowHierarchyType==="grid"&&ve.push(g.rowSubTotalLabel);const ye=ve.join(this.stringJoinChar);this.tree[ye]||(this.tree[ye]={},y.push(ye)),this.tree[ye][P]||(this.tree[ye][P]=[]);const me=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let oe=0;oe<me.length;oe++){if(!this.tree[ye][P][oe])if(this.calculatedFiledKeys.indexOf(me[oe])>=0){const pe=(x=this.calculatedFieldRules)===null||x===void 0?void 0:x.find(Ie=>Ie.key===me[oe]);this.tree[ye][P][oe]=new this.aggregators[ie.RECALCULATE]({key:me[oe],dimension:me[oe],isRecord:!0,formatFun:(E=(A=this.indicators)===null||A===void 0?void 0:A.find(Ie=>typeof Ie!="string"&&Ie.indicatorKey===me[oe]))===null||E===void 0?void 0:E.format,calculateFun:pe==null?void 0:pe.calculateFun,dependAggregators:this.tree[ye][P],dependIndicatorKeys:pe==null?void 0:pe.dependIndicatorKeys})}else{const pe=this.getAggregatorRule(me[oe]);this.tree[ye][P][oe]=new this.aggregators[(Q=pe==null?void 0:pe.aggregationType)!==null&&Q!==void 0?Q:ie.SUM]({key:me[oe],dimension:(J=pe==null?void 0:pe.field)!==null&&J!==void 0?J:me[oe],formatFun:(U=pe==null?void 0:pe.formatFun)!==null&&U!==void 0?U:(se=(X=this.indicators)===null||X===void 0?void 0:X.find(Ie=>typeof Ie!="string"&&Ie.indicatorKey===me[oe]))===null||se===void 0?void 0:se.format})}ye!==_&&this.tree[ye][P][oe].push((le=(ne=g.tree[_])===null||ne===void 0?void 0:ne[P])===null||le===void 0?void 0:le[oe])}}}if(!((de=(ae=g.totals)===null||ae===void 0?void 0:ae.row)===null||de===void 0)&&de.showGrandTotals||this.columns.length===0){const ee=g.rowGrandTotalLabel;this.tree[ee]||(this.tree[ee]={},y.push(ee)),this.tree[ee][P]||(this.tree[ee][P]=[]);const j=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let q=0;q<j.length;q++){if(!this.tree[ee][P][q])if(this.calculatedFiledKeys.indexOf(j[q])>=0){const G=(he=this.calculatedFieldRules)===null||he===void 0?void 0:he.find(ve=>ve.key===j[q]);this.tree[ee][P][q]=new this.aggregators[ie.RECALCULATE]({key:j[q],dimension:j[q],isRecord:!0,formatFun:(Ce=(ue=this.indicators)===null||ue===void 0?void 0:ue.find(ve=>typeof ve!="string"&&ve.indicatorKey===j[q]))===null||Ce===void 0?void 0:Ce.format,calculateFun:G==null?void 0:G.calculateFun,dependAggregators:this.tree[ee][P],dependIndicatorKeys:G==null?void 0:G.dependIndicatorKeys})}else{const G=this.getAggregatorRule(j[q]);this.tree[ee][P][q]=new this.aggregators[(_e=G==null?void 0:G.aggregationType)!==null&&_e!==void 0?_e:ie.SUM]({key:j[q],dimension:(we=G==null?void 0:G.field)!==null&&we!==void 0?we:j[q],formatFun:(He=G==null?void 0:G.formatFun)!==null&&He!==void 0?He:(Pe=(Te=this.indicators)===null||Te===void 0?void 0:Te.find(ve=>typeof ve!="string"&&ve.indicatorKey===j[q]))===null||Pe===void 0?void 0:Pe.format})}ee!==_&&this.tree[ee][P][q].push((be=(Se=g.tree[_])===null||Se===void 0?void 0:Se[P])===null||be===void 0?void 0:be[q])}}m(_,P)})}),y.forEach(_=>{Object.keys(g.tree[_]).forEach(S=>{m(_,S)})})}for(const y in g.totalRecordsTree)for(const _ in g.totalRecordsTree[y])m(y,_)}ArrToTree1(e,t,i,o,r){const n=[],s=this.stringJoinChar,l=new Map;function d(a){const h=[];let c;a.forEach((u,v)=>{var g;h.push(u);const m=h.join(s);let y=l.get(m);y||(y={value:u,dimensionKey:t[v],children:v===a.length-1&&((g=i==null?void 0:i.length)!==null&&g!==void 0?g:0)>=1?i==null?void 0:i.map(_=>typeof _=="string"?{indicatorKey:_,value:_}:{indicatorKey:_.indicatorKey,value:_.title}):[]},l.set(m,y),c?c.children.push(y):n.push(y)),c=y})}return e.forEach(a=>d(a)),o&&d([r]),n}ArrToTree(e,t,i,o,r,n,s,l,d){var a;let h=[];const c=this.stringJoinChar,u=new Map;if(e!=null&&e.length?e.forEach(v=>function(g){const m=[];let y;g.forEach((_,S)=>{var P,f,p,I;m.push(_);const w=m.join(c);let C=u.get(w);if(!C){if(C={value:_,dimensionKey:t[S],children:S===g.length-1&&((P=i==null?void 0:i.length)!==null&&P!==void 0?P:0)>=1?i==null?void 0:i.map(T=>typeof T=="string"?{indicatorKey:T,value:T}:{indicatorKey:T.indicatorKey,value:T.title}):[]},o[S]){let T=(f=C.children)!==null&&f!==void 0?f:[];const H={value:s,dimensionKey:t[S+1],levelSpan:o.length-S-1,children:((p=i==null?void 0:i.length)!==null&&p!==void 0?p:0)>=1?i==null?void 0:i.map(b=>typeof b=="string"?{indicatorKey:b,value:b}:{indicatorKey:b.indicatorKey,value:b.title}):[]};T.push(H),T=(I=H.children)!==null&&I!==void 0?I:[]}u.set(w,C),y?o[S-1]&&!d?y.children.splice(y.children.length-1,0,C):y.children.push(C):h.push(C)}y=C})}(v)):i&&(h=i==null?void 0:i.map(v=>{var g;return typeof v=="string"?{indicatorKey:v,value:v}:{indicatorKey:v.indicatorKey,value:(g=v.title)!==null&&g!==void 0?g:v.indicatorKey}})),r&&(e==null?void 0:e.length)){const v={value:n,dimensionKey:t[0],levelSpan:o.length,children:(a=i==null?void 0:i.map(g=>typeof g=="string"?{indicatorKey:g,value:g}:{indicatorKey:g.indicatorKey,value:g.title}))!==null&&a!==void 0?a:[]};l?h.unshift(v):h.push(v)}return h}cacheDeminsionCollectedValues(){for(const e in this.collectValuesBy)this.collectValuesBy[e].type!=="xField"&&this.collectValuesBy[e].type!=="yField"||(this.dataConfig.dimensionSortArray?this.cacheCollectedValues[e]=io(this.collectedValues[e],this.dataConfig.dimensionSortArray):this.cacheCollectedValues[e]=this.collectedValues[e])}changeTreeNodeValue(e=[],t=[],i,o){var r,n,s;const l=this.indicatorKeys.indexOf(i);let d,a;d=typeof e=="string"?e:e.join(this.stringJoinChar),a=typeof t=="string"?t:t.join(this.stringJoinChar),!((r=this.changedTree[d])===null||r===void 0)&&r[a]?this.changedTree[d][a][l]=o:this.changedTree[d]?(this.changedTree[d][a]=[],this.changedTree[d][a][l]=o):(this.changedTree[d]={},this.changedTree[d][a]=[],this.changedTree[d][a][l]=o);const h=(s=(n=this.tree[d])===null||n===void 0?void 0:n[a])===null||s===void 0?void 0:s[l];(h==null?void 0:h.records.length)===1&&(h.records[0][this.indicatorKeys[l]]=o)}changeRecordFieldValue(e,t,i){let o=!1;for(let r=0;r<this.indicatorKeys.length;r++)this.indicatorKeys[r]===e&&(o=!0);if(!o){if(Array.isArray(this.records))for(let r=0,n=this.records.length;r<n;r++){const s=this.records[r];s[e]===t&&(s[e]=i)}else for(const r in this.records)for(let n=0,s=this.records[r].length;n<s;n++){const l=this.records[r][n];l[e]===t&&(l[e]=i)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}_rowTreeHasChanged(){this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,"row"))}changeDataConfig(e){this.rows=e.rows,this.columns=e.columns}addRecords(e){for(let t=0,i=e.length;t<i;t++){const o=e[t];this.processRecord(o)}Array.isArray(this.records)&&this.records.push(e)}customTreeToDimensionPathArr(e,t){const i=[],o=this;function r(n,s){var l,d,a;n.virtual||(!((l=s[s.length-1])===null||l===void 0)&&l.childKeys&&n.dimensionKey&&s[s.length-1].childKeys.indexOf(n.dimensionKey)===-1&&n.dimensionKey!==s[s.length-1].dimensionKey&&s[s.length-1].childKeys.push(n.dimensionKey),s.push({dimensionKey:O(n.indicatorKey)?void 0:n.dimensionKey,value:n.value,indicatorKey:n.indicatorKey,virtual:n.virtual})),((d=n.children)===null||d===void 0?void 0:d.length)>0?(o.rowHierarchyType==="tree"&&t==="row"&&(s[s.length-1].childKeys=[],i.push([...s])),(a=n.children)===null||a===void 0||a.forEach(h=>r(h,[...s]))):i.push(s)}return e==null||e.forEach(n=>r(n,[])),i}getFieldMatchColDimensionPaths(e){var t,i;const o=[];for(let r=0;(i=r<((t=this.customColTreeDimensionPaths)===null||t===void 0?void 0:t.length))!==null&&i!==void 0&&i;r++){const n=this.customColTreeDimensionPaths[r];let s=!0;for(let l=0;l<n.length;l++){const d=n[l];if(d.dimensionKey&&e[d.dimensionKey]!==d.value||d.indicatorKey&&e[d.indicatorKey]===void 0){s=!1;break}}s&&o.push(n)}return o}getFieldMatchRowDimensionPaths(e){var t,i;const o=[];for(let r=0;(i=r<((t=this.customRowTreeDimensionPaths)===null||t===void 0?void 0:t.length))!==null&&i!==void 0&&i;r++){const n=this.customRowTreeDimensionPaths[r];let s=!0;for(let l=0;l<n.length;l++){const d=n[l];if(d.dimensionKey&&e[d.dimensionKey]!==d.value||d.indicatorKey&&e[d.indicatorKey]===void 0){s=!1;break}if(d.childKeys&&l===n.length-1&&d.childKeys.length>0&&d.childKeys.find(a=>O(e[a]))){s=!1;break}}s&&(this.indicatorsAsCol||this.rowHierarchyType!=="tree"||n.find(l=>l.indicatorKey)||(s=!1)),s&&o.push(n)}return o}}function io(D,e){return D.sort((t,i)=>{const o=e.indexOf(t),r=e.indexOf(i);return o<r?-1:o>r?1:0})}class oo extends Wt{constructor(e,t){var i,o,r,n,s,l,d,a,h,c,u,v,g,m,y,_,S,P;if(mt.mode==="node"?(t=e,e=null):e instanceof HTMLElement||(t=e,e=e.container?e.container:null),super(e,t),this.layoutNodeId={seqId:0},t){t.layout&&Object.assign(t,t.layout),this.internalProps.columns=ge(t.columns),this.internalProps.rows=ge(t.rows),this.internalProps.indicators=nt(t.indicators),(i=t.indicators)===null||i===void 0||i.forEach((p,I)=>{typeof p=="object"&&(p!=null&&p.editor)&&(this.internalProps.indicators[I].editor=p.editor)}),this.internalProps.columnTree=!t.indicatorsAsCol||!((o=t.columns)===null||o===void 0)&&o.length||t.columnTree?ge(t.columnTree):[],this.internalProps.rowTree=t.indicatorsAsCol||!((r=t.rows)===null||r===void 0)&&r.length||t.rowTree?ge(t.rowTree):[],this.internalProps.records=t.records,this.pagination=t.pagination,this.internalProps.columnResizeType=(n=t.columnResizeType)!==null&&n!==void 0?n:"column",this.internalProps.rowResizeType=(s=t.rowResizeType)!==null&&s!==void 0?s:"row",this.internalProps.dataConfig=ge(t.dataConfig),this.internalProps.columnWidthConfig=t.columnWidthConfig;const f=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,((l=f==null?void 0:f[0])===null||l===void 0?void 0:l.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),((d=t.customConfig)===null||d===void 0?void 0:d.enableDataAnalysis)===!1){const p=new ce((a=this.internalProps.columnTree)!==null&&a!==void 0?a:[],this.layoutNodeId),I=new ce((h=this.internalProps.rowTree)!==null&&h!==void 0?h:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType==="tree"?(c=this.options.rowExpandLevel)!==null&&c!==void 0?c:1:void 0);this.internalProps.layoutMap=new Ee(this,null,p,I),this.internalProps.recordsIsTwoDimensionalArray===!1&&(this.flatDataToObjects=new yt({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey},f))}else{const p=Lt(this,t),{rowKeys:I,columnKeys:w,indicatorKeys:C}=p;let{columnDimensionTree:T,rowDimensionTree:H}=p;this.dataset=new at(this.internalProps.dataConfig,I,w,C,this.internalProps.indicators,(u=t.indicatorsAsCol)===null||u===void 0||u,t.records,t.rowHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!t.extensionRows,!!t.parseCustomTreeToMatchRecords),t.columnTree||(t.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Ae(this.dataset.colHeaderTree,t.indicators)),T=new ce((v=this.dataset.colHeaderTree)!==null&&v!==void 0?v:[],this.layoutNodeId)),t.rowTree||(t.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Ae(this.dataset.rowHeaderTree,t.indicators)),H=new ce((g=this.dataset.rowHeaderTree)!==null&&g!==void 0?g:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType==="tree"?(m=this.options.rowExpandLevel)!==null&&m!==void 0?m:1:void 0)),this.internalProps.layoutMap=new Ee(this,this.dataset,T,H)}if(this._changePivotSortStateBySortRules(),((_=(y=t.pivotSortState)===null||y===void 0?void 0:y.length)!==null&&_!==void 0?_:0)>0&&(this.pivotSortState=[],this.pivotSortState=t.pivotSortState),mt.mode!=="node"&&(this.editorManager=new Vi(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.stateManager.initCheckedState(f),this.scenegraph.createSceneGraph(),t.title){const p=Le.getComponent("title");this.internalProps.title=new p(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(S=this.internalProps.emptyTip)===null||S===void 0||S.resetVisible();else{const p=Le.getComponent("emptyTip");this.internalProps.emptyTip=new p(this.options.emptyTip,this),(P=this.internalProps.emptyTip)===null||P===void 0||P.resetVisible()}setTimeout(()=>{this.fireListeners(st.INITIALIZED,null)},0)}}static get EVENT_TYPE(){return Ct}isListTable(){return!1}isPivotTable(){return!0}isPivotChart(){return!1}get recordsCount(){var e;return(e=this.records)===null||e===void 0?void 0:e.length}_canResizeColumn(e,t){const i=super._canResizeColumn(e,t);if(i){if(this.internalProps.layoutMap.isSeriesNumber(e,t)&&this.internalProps.rowSeriesNumber.disableColumnResize===!0)return!1;if(!this.internalProps.layoutMap.indicatorsAsCol){const o=this.internalProps.layoutMap.getBody(e,this.columnHeaderLevelCount);if(o!=null&&o.disableColumnResize)return!1}}return i}updateOption(e){var t,i,o,r,n,s,l,d,a,h,c,u,v,g,m,y,_,S,P,f;const p=this.internalProps;if(super.updateOption(e),this.layoutNodeId={seqId:0},this.internalProps.columns=ge(e.columns),this.internalProps.rows=ge(e.rows),this.internalProps.indicators=!((t=e.indicators)===null||t===void 0)&&t.length?nt(e.indicators):[],(i=e.indicators)===null||i===void 0||i.forEach((w,C)=>{typeof w=="object"&&(w!=null&&w.editor)&&(this.internalProps.indicators[C].editor=w.editor)}),this.internalProps.columnTree=!e.indicatorsAsCol||!((o=e.columns)===null||o===void 0)&&o.length||e.columnTree?ge(e.columnTree):[],this.internalProps.rowTree=e.indicatorsAsCol||!((r=e.rows)===null||r===void 0)&&r.length||e.rowTree?ge(e.rowTree):[],e.records&&(this.internalProps.records=e.records),this.stateManager.initCheckedState(this.internalProps.records),this.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1),this.pagination=e.pagination,p.columnResizeType=(n=e.columnResizeType)!==null&&n!==void 0?n:"column",p.rowResizeType=(s=e.rowResizeType)!==null&&s!==void 0?s:"row",p.dataConfig=ge(e.dataConfig),this.internalProps.columnWidthConfig=e.columnWidthConfig,(e==null?void 0:e.rowHierarchyType)==="tree"&&this.internalProps.layoutMap.rowHierarchyType==="tree"&&this.internalProps.layoutMap.rowExpandLevel===(e==null?void 0:e.rowExpandLevel)){const w=this.internalProps.layoutMap.rowDimensionTree.tree.children;(l=this.internalProps.rowTree)===null||l===void 0||l.forEach((C,T)=>{const H=w.find(b=>b.dimensionKey===C.dimensionKey&&b.value===C.value);H&&this._syncHierarchyState(H,C)})}const I=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,((d=I==null?void 0:I[0])===null||d===void 0?void 0:d.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),((a=e.customConfig)===null||a===void 0?void 0:a.enableDataAnalysis)===!1){let w,C;e.columnTree&&(w=new ce((h=this.internalProps.columnTree)!==null&&h!==void 0?h:[],this.layoutNodeId)),e.rowTree&&(C=new ce((c=this.internalProps.rowTree)!==null&&c!==void 0?c:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType==="tree"?(u=this.options.rowExpandLevel)!==null&&u!==void 0?u:1:void 0)),p.layoutMap=new Ee(this,null,w,C),this.internalProps.recordsIsTwoDimensionalArray===!1&&(this.flatDataToObjects=new yt({rows:p.layoutMap.fullRowDimensionKeys,columns:p.layoutMap.colDimensionKeys,indicators:p.layoutMap.indicatorKeys,indicatorsAsCol:p.layoutMap.indicatorsAsCol,indicatorDimensionKey:p.layoutMap.indicatorDimensionKey},I))}else{const w=Lt(this,e),{rowKeys:C,columnKeys:T,indicatorKeys:H}=w;let{columnDimensionTree:b,rowDimensionTree:x}=w;this.dataset=new at(p.dataConfig,C,T,H,this.internalProps.indicators,(v=e.indicatorsAsCol)===null||v===void 0||v,I,e.rowHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!e.extensionRows,!!e.parseCustomTreeToMatchRecords),e.columnTree||(e.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Ae(this.dataset.colHeaderTree,e.indicators)),b=new ce((g=this.dataset.colHeaderTree)!==null&&g!==void 0?g:[],this.layoutNodeId)),e.rowTree||(e.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Ae(this.dataset.rowHeaderTree,e.indicators)),x=new ce((m=this.dataset.rowHeaderTree)!==null&&m!==void 0?m:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType==="tree"?(y=this.options.rowExpandLevel)!==null&&y!==void 0?y:1:void 0)),p.layoutMap=new Ee(this,this.dataset,b,x)}if(this._changePivotSortStateBySortRules(),((S=(_=e.pivotSortState)===null||_===void 0?void 0:_.length)!==null&&S!==void 0?S:0)>0&&(this.pivotSortState=[],this.pivotSortState=e.pivotSortState),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,p.releaseList&&(p.releaseList.forEach(w=>{var C;return(C=w==null?void 0:w.release)===null||C===void 0?void 0:C.call(w)}),p.releaseList=null),this.scenegraph.clearCells(),this.scenegraph.createSceneGraph(),e.title){const w=Le.getComponent("title");this.internalProps.title=new w(e.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(P=this.internalProps.emptyTip)===null||P===void 0||P.resetVisible();else{const w=Le.getComponent("emptyTip");this.internalProps.emptyTip=new w(this.options.emptyTip,this),(f=this.internalProps.emptyTip)===null||f===void 0||f.resetVisible()}return new Promise(w=>{setTimeout(w,0)})}updatePagination(e){e?(this.pagination||(this.pagination={currentPage:0,perPageCount:0}),typeof e.currentPage=="number"&&e.currentPage>=0&&(this.pagination.currentPage=e.currentPage),e.perPageCount&&(this.pagination.perPageCount=e.perPageCount||this.pagination.perPageCount),this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(this.pagination),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()):this.pagination&&(this.pagination=void 0,this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(void 0),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render())}refreshHeader(){this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var e,t,i,o,r,n,s,l,d;const a=this,{layoutMap:h}=a.internalProps;h&&(a.colCount=(e=h.colCount)!==null&&e!==void 0?e:0,a.rowCount=(t=h.rowCount)!==null&&t!==void 0?t:0,this.internalProps.frozenColCount=Math.max(((i=h.rowHeaderLevelCount)!==null&&i!==void 0?i:0)+h.leftRowSeriesNumberColumnCount,(o=this.options.frozenColCount)!==null&&o!==void 0?o:0),a.frozenRowCount=Math.max(h.headerLevelCount,(r=this.options.frozenRowCount)!==null&&r!==void 0?r:0),a.bottomFrozenRowCount!==((n=this.options.bottomFrozenRowCount)!==null&&n!==void 0?n:0)&&(a.bottomFrozenRowCount=(s=this.options.bottomFrozenRowCount)!==null&&s!==void 0?s:0),a.rightFrozenColCount!==((l=this.options.rightFrozenColCount)!==null&&l!==void 0?l:0)&&(a.rightFrozenColCount=(d=this.options.rightFrozenColCount)!==null&&d!==void 0?d:0),this.stateManager.setFrozenCol(this.internalProps.frozenColCount))}_getSortFuncFromHeaderOption(e,t,i){}get rowHierarchyType(){return this.internalProps.layoutMap.rowHierarchyType}_syncHierarchyState(e,t){var i,o;e.value===t.value&&e.dimensionKey===t.dimensionKey&&(t.hierarchyState=(i=t.hierarchyState)!==null&&i!==void 0?i:t!=null&&t.children?e.hierarchyState:void 0,(o=t==null?void 0:t.children)===null||o===void 0||o.forEach((r,n)=>{var s;if(!((s=e==null?void 0:e.children)===null||s===void 0)&&s[n]&&r){const l=e.children.find(d=>d.dimensionKey===r.dimensionKey&&d.value===r.value);l&&this._syncHierarchyState(l,r)}}))}getRecordShowIndexByCell(e,t){}getTableIndexByRecordIndex(e){}getTableIndexByField(e){}getCellAddrByFieldRecord(e,t){}getBodyIndexByRow(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByRow(e)}getBodyIndexByCol(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByCol(e)}getFieldData(e,t,i){var o,r,n;if(!this.internalProps.layoutMap.isHeader(t,i)){if(this.internalProps.recordsIsTwoDimensionalArray){const s=this.getBodyIndexByRow(i),l=this.getBodyIndexByCol(t);return(o=this.records[s])===null||o===void 0?void 0:o[l]}if(this.dataset){const s=this.internalProps.layoutMap.getCellHeaderPaths(t,i);if(s){let l;const d=(r=s.colHeaderPaths)===null||r===void 0?void 0:r.filter(c=>!c.virtual).map((c,u)=>{var v;return c.indicatorKey&&(l={position:"col",index:u}),(v=c.indicatorKey)!==null&&v!==void 0?v:c.value}),a=(n=s.rowHeaderPaths)===null||n===void 0?void 0:n.filter(c=>!c.virtual).map((c,u)=>{var v;return c.indicatorKey&&(l={position:"row",index:u}),(v=c.indicatorKey)!==null&&v!==void 0?v:c.value}),h=this.dataset.getAggregator(a,d,this.internalProps.layoutMap.getIndicatorKey(t,i),!0,l);if(h.records&&h.records.length>=1)return h.records[0][e]}}else if(this.flatDataToObjects){const s=this.internalProps.layoutMap.getCellHeaderPaths(t,i),l=s.colHeaderPaths.map(h=>{var c;return(c=h.indicatorKey)!==null&&c!==void 0?c:h.value}),d=s.rowHeaderPaths.map(h=>{var c;return(c=h.indicatorKey)!==null&&c!==void 0?c:h.value}),a=this.flatDataToObjects.getTreeNode(d,l,this.internalProps.layoutMap.getBody(t,i).indicatorKey,!1);if(a!=null&&a.record)return a==null?void 0:a.record[e]}}}getCellValue(e,t,i){var o,r,n,s,l,d,a;if(!i){const h=this.getCustomMergeValue(e,t);if(h)return h}if(this.internalProps.layoutMap.isSeriesNumber(e,t)){if(this.internalProps.layoutMap.isSeriesNumberInHeader(e,t)){const{title:c}=this.internalProps.layoutMap.getSeriesNumberHeader(e,t);return c}const{format:h}=this.internalProps.layoutMap.getSeriesNumberBody(e,t);return typeof h=="function"?h(e,t,this):t-this.columnHeaderLevelCount+1}if(this.internalProps.layoutMap.isHeader(e,t)){const{title:h,fieldFormat:c}=this.internalProps.layoutMap.getHeader(e,t);return typeof c=="function"?c(h,e,t,this):h}if(this.internalProps.recordsIsTwoDimensionalArray){const{fieldFormat:h}=this.internalProps.layoutMap.getBody(e,t),c=this.getBodyIndexByRow(t),u=this.getBodyIndexByCol(e),v=(o=this.records[c])===null||o===void 0?void 0:o[u];return typeof h=="function"?h(v,e,t,this):v}if(this.dataset){const h=this.internalProps.layoutMap.getCellHeaderPaths(e,t);let c;const u=(n=(r=h.colHeaderPaths)===null||r===void 0?void 0:r.filter(y=>!y.virtual))===null||n===void 0?void 0:n.map((y,_)=>{var S;return y.indicatorKey&&(c={position:"col",index:_}),(S=y.indicatorKey)!==null&&S!==void 0?S:y.value}),v=(l=(s=h.rowHeaderPaths)===null||s===void 0?void 0:s.filter(y=>!y.virtual))===null||l===void 0?void 0:l.map((y,_)=>{var S;return y.indicatorKey&&(c={position:"row",index:_}),(S=y.indicatorKey)!==null&&S!==void 0?S:y.value}),g=this.dataset.getAggregator(v,u,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,c),{fieldFormat:m}=this.internalProps.layoutMap.getBody(e,t);return g.formatValue?g.formatValue(e,t,this):typeof m=="function"?m(g==null?void 0:g.value(),e,t,this):(d=g==null?void 0:g.value())!==null&&d!==void 0?d:""}if(this.flatDataToObjects){const h=this.internalProps.layoutMap.getCellHeaderPaths(e,t),c=h.colHeaderPaths.map(m=>{var y;return(y=m.indicatorKey)!==null&&y!==void 0?y:m.value}),u=h.rowHeaderPaths.map(m=>{var y;return(y=m.indicatorKey)!==null&&y!==void 0?y:m.value}),v=this.flatDataToObjects.getTreeNode(u,c,this.internalProps.layoutMap.getBody(e,t).indicatorKey),{fieldFormat:g}=this.internalProps.layoutMap.getBody(e,t);return typeof g=="function"?g(v==null?void 0:v.value,e,t,this):(a=v==null?void 0:v.value)!==null&&a!==void 0?a:""}}getCellOriginValue(e,t){var i,o,r;const n=this;if(n.internalProps.layoutMap.isHeader(e,t)){const{title:s}=n.internalProps.layoutMap.getHeader(e,t);return typeof s=="function"?s():s}if(this.internalProps.recordsIsTwoDimensionalArray){const s=this.getBodyIndexByRow(t),l=this.getBodyIndexByCol(e);return(i=this.records[s])===null||i===void 0?void 0:i[l]}if(this.dataset){let s;const l=this.internalProps.layoutMap.getCellHeaderPaths(e,t),d=(o=l.colHeaderPaths)===null||o===void 0?void 0:o.filter(c=>!c.virtual).map((c,u)=>{var v;return c.indicatorKey&&(s={position:"col",index:u}),(v=c.indicatorKey)!==null&&v!==void 0?v:c.value}),a=(r=l.rowHeaderPaths)===null||r===void 0?void 0:r.filter(c=>!c.virtual).map((c,u)=>{var v;return c.indicatorKey&&(s={position:"row",index:u}),(v=c.indicatorKey)!==null&&v!==void 0?v:c.value}),h=this.dataset.getAggregator(a,d,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,s);return h.value?h.value():void 0}if(this.flatDataToObjects){const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),l=s.colHeaderPaths.map(h=>{var c;return(c=h.indicatorKey)!==null&&c!==void 0?c:h.value}),d=s.rowHeaderPaths.map(h=>{var c;return(c=h.indicatorKey)!==null&&c!==void 0?c:h.value}),a=this.flatDataToObjects.getTreeNode(d,l,this.internalProps.layoutMap.getBody(e,t).indicatorKey);return a==null?void 0:a.value}}getCellRawValue(e,t){var i,o,r;const n=this;if(n.internalProps.layoutMap.isHeader(e,t)){const{title:s}=n.internalProps.layoutMap.getHeader(e,t);return typeof s=="function"?s():s}if(this.internalProps.recordsIsTwoDimensionalArray){const s=this.getBodyIndexByRow(t),l=this.getBodyIndexByCol(e);return(i=this.records[s])===null||i===void 0?void 0:i[l]}if(this.dataset){let s;const l=this.internalProps.layoutMap.getCellHeaderPaths(e,t),d=(o=l.colHeaderPaths)===null||o===void 0?void 0:o.filter(c=>!c.virtual).map((c,u)=>{var v;return c.indicatorKey&&(s={position:"col",index:u}),(v=c.indicatorKey)!==null&&v!==void 0?v:c.value}),a=(r=l.rowHeaderPaths)===null||r===void 0?void 0:r.filter(c=>!c.virtual).map((c,u)=>{var v;return c.indicatorKey&&(s={position:"row",index:u}),(v=c.indicatorKey)!==null&&v!==void 0?v:c.value}),h=this.dataset.getAggregator(a,d,this.internalProps.layoutMap.getIndicatorKey(e,t),!1,s);return h.value?h.value():void 0}if(this.flatDataToObjects){const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),l=s.colHeaderPaths.map(h=>{var c;return(c=h.indicatorKey)!==null&&c!==void 0?c:h.value}),d=s.rowHeaderPaths.map(h=>{var c;return(c=h.indicatorKey)!==null&&c!==void 0?c:h.value}),a=this.flatDataToObjects.getTreeNode(d,l,this.internalProps.layoutMap.getBody(e,t).indicatorKey,!1);return a==null?void 0:a.value}}getCellOriginRecord(e,t){var i,o,r;if(!this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.recordsIsTwoDimensionalArray){const n=this.getBodyIndexByRow(t),s=this.getBodyIndexByCol(e);return(i=this.records[n])===null||i===void 0?void 0:i[s]}if(this.dataset){let n;const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),l=(o=s.colHeaderPaths)===null||o===void 0?void 0:o.filter(a=>!a.virtual).map((a,h)=>{var c;return a.indicatorKey&&(n={position:"col",index:h}),(c=a.indicatorKey)!==null&&c!==void 0?c:a.value}),d=(r=s.rowHeaderPaths)===null||r===void 0?void 0:r.filter(a=>!a.virtual).map((a,h)=>{var c;return a.indicatorKey&&(n={position:"row",index:h}),(c=a.indicatorKey)!==null&&c!==void 0?c:a.value});return this.dataset.getAggregator(d,l,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,n).records}if(this.flatDataToObjects){const n=this.internalProps.layoutMap.getCellHeaderPaths(e,t),s=n.colHeaderPaths.map(a=>{var h;return(h=a.indicatorKey)!==null&&h!==void 0?h:a.value}),l=n.rowHeaderPaths.map(a=>{var h;return(h=a.indicatorKey)!==null&&h!==void 0?h:a.value}),d=this.flatDataToObjects.getTreeNode(l,s,this.internalProps.layoutMap.getBody(e,t).indicatorKey);return d==null?void 0:d.record}}}getCellRawRecord(e,t){var i,o,r;if(!this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.recordsIsTwoDimensionalArray){const n=this.getBodyIndexByRow(t),s=this.getBodyIndexByCol(e);return(i=this.records[n])===null||i===void 0?void 0:i[s]}if(this.dataset){let n;const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),l=(o=s.colHeaderPaths)===null||o===void 0?void 0:o.filter(a=>!a.virtual).map((a,h)=>{var c;return a.indicatorKey&&(n={position:"col",index:h}),(c=a.indicatorKey)!==null&&c!==void 0?c:a.value}),d=(r=s.rowHeaderPaths)===null||r===void 0?void 0:r.filter(a=>!a.virtual).map((a,h)=>{var c;return a.indicatorKey&&(n={position:"row",index:h}),(c=a.indicatorKey)!==null&&c!==void 0?c:a.value});return this.dataset.getAggregator(d,l,this.internalProps.layoutMap.getIndicatorKey(e,t),!1,n).records}if(this.flatDataToObjects){const n=this.internalProps.layoutMap.getCellHeaderPaths(e,t),s=n.colHeaderPaths.map(a=>{var h;return(h=a.indicatorKey)!==null&&h!==void 0?h:a.value}),l=n.rowHeaderPaths.map(a=>{var h;return(h=a.indicatorKey)!==null&&h!==void 0?h:a.value}),d=this.flatDataToObjects.getTreeNode(l,s,this.internalProps.layoutMap.getBody(e,t).indicatorKey,!1);return d==null?void 0:d.record}}}updateSortRules(e,t,i){this.internalProps.dataConfig?this.internalProps.dataConfig.sortRules=e:this.internalProps.dataConfig={sortRules:e},this.dataset.updateSortRules(e),this._changePivotSortStateBySortRules();const{layoutMap:o}=this.internalProps;o.resetHeaderTree(),this.scenegraph.clearCells(),lt(t)&&lt(i)?(this.isRowHeader(t,i)?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):this.isCornerHeader(t,i)?o.cornerSetting.titleOnDimension==="column"?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):o.cornerSetting.titleOnDimension==="row"&&this.internalProps._heightResizedRowMap.clear():this.isColumnHeader(t,i)&&this.internalProps._heightResizedRowMap.clear(),this.refreshRowColCount()):this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.createSceneGraph(!0),this.render()}_changePivotSortStateBySortRules(){var e,t,i,o;this.pivotSortState=[];const r=(t=(e=this.internalProps.dataConfig)===null||e===void 0?void 0:e.sortRules)!==null&&t!==void 0?t:[];for(let n=0;n<r.length;n++){const s=r[n],l=[];if(s.sortByIndicator&&s.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1])){for(let a=0;a<s.query.length;a++)l.push({dimensionKey:this.dataset.indicatorsAsCol?this.dataset.columns[a]:this.dataset.rows[a],value:s.query[a]});l.push({indicatorKey:s.sortByIndicator,value:(o=(i=this.internalProps.layoutMap.getIndicatorInfo(s.sortByIndicator))===null||i===void 0?void 0:i.title)!==null&&o!==void 0?o:s.sortByIndicator})}else l.push({dimensionKey:s.sortField,isPivotCorner:!0,value:s.sortField});const d=s.sortType?s.sortType.toUpperCase():"ASC";this.pivotSortState.push({dimensions:l,order:Xe[d]})}}_parseColumnWidthConfig(e){for(let t=0;t<(e==null?void 0:e.length);t++){const i=e[t],o=i.dimensions,r=i.width,n=this.getCellAddressByHeaderPaths(o);if(n&&n.col>=this.rowHeaderLevelCount){const s=this.getCellHeaderPaths(n.col,this.columnHeaderLevelCount);if(s.colHeaderPaths.length===o.length){let l=!0;for(let d=0;d<o.length;d++){const a=o[d];if(s.colHeaderPaths.findIndex((h,c)=>h.indicatorKey===a.indicatorKey||h.dimensionKey===a.dimensionKey&&h.value===a.value)<0){l=!1;break}}l&&!this.internalProps._widthResizedColMap.has(n.col)&&(this._setColWidth(n.col,r),this.internalProps._widthResizedColMap.add(n.col))}}}}updatePivotSortState(e){this.pivotSortState=e}sort(e,t,i){var o;let r;if(this.isCornerHeader(e,t)){const l=this.getHeaderDefine(e,t);r=[];const d={isPivotCorner:!0,dimensionKey:l.value,value:l.value};r.push(d)}else r=this.isColumnHeader(e,t)?this.getCellHeaderPaths(e,t).colHeaderPaths:this.getCellHeaderPaths(e,t).rowHeaderPaths;const n=r[r.length-1].indicatorKey,s=this.getHeaderDefine(e,t);if(s.sort){if(this.dataset.sortRules){const l={};for(let d=this.dataset.sortRules.length-1;d>=0;d--){const a=this.dataset.sortRules[d];s.dimensionKey&&a.sortField===s.dimensionKey?(l[a.sortField]=a,this.dataset.sortRules.splice(d,1)):n&&a.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1])&&this.dataset.sortRules.splice(d,1)}n?this.dataset.sortRules.push({sortField:this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1],sortType:Xe[i],sortByIndicator:n,query:r.reduce((d,a)=>(a.dimensionKey&&d.push(a.value),d),[])}):this.dataset.sortRules.push(Object.assign((o=l[s.dimensionKey])!==null&&o!==void 0?o:{},{sortField:s.dimensionKey,sortType:Xe[i]}))}else this.dataset.sortRules=n?[{sortField:this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1],sortType:Xe[i],sortByIndicator:n,query:r.reduce((l,d)=>(d.dimensionKey&&l.push(d.value),l),[])}]:[{sortField:s.dimensionKey,sortType:Xe[i]}];this.updateSortRules(this.dataset.sortRules,e,t)}}getPivotSortState(e,t){if(!this.pivotSortState)return;const i=this.getCellRange(e,t);for(let o=0;o<this.pivotSortState.length;o++){const r=this.pivotSortState[o],n=r.dimensions,s=this.getCellAddressByHeaderPaths(n),l=r.order;if(s&&Ut(i,s.col,s.row))return l}}_moveHeaderPosition(e,t){const i=this.getCellRange(e.col,e.row),o=this.getCellRange(t.col,t.row),r=this.internalProps.layoutMap.moveHeaderPosition(e,t);if(r){if(r.moveType==="column"){if(this.internalProps.recordsIsTwoDimensionalArray)for(let n=0;n<this.internalProps.records.length;n++){const s=this.internalProps.records[n].splice(r.sourceIndex-this.rowHeaderLevelCount,r.sourceSize);s.unshift(r.targetIndex-this.rowHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records[n],s)}this.colWidthsMap.exchangeOrder(i.start.col,i.end.col-i.start.col+1,o.start.col,o.end.col-o.start.col+1,r.targetIndex),this.setMinMaxLimitWidth()}else if(r.moveType==="row"){if(this.internalProps.recordsIsTwoDimensionalArray){const n=this.internalProps.records.splice(r.sourceIndex-this.columnHeaderLevelCount,r.sourceSize);n.unshift(r.targetIndex-this.columnHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records,n)}r.targetIndex>r.sourceIndex?this.rowHeightsMap.exchangeOrder(r.sourceIndex,r.sourceSize,r.targetIndex+r.sourceSize-r.targetSize,r.targetSize,r.targetIndex):this.rowHeightsMap.exchangeOrder(r.sourceIndex,r.sourceSize,r.targetIndex,r.targetSize,r.targetIndex)}return r}return null}toggleHierarchyState(e,t,i=!0){const o=this.getHierarchyState(e,t);if(o===Qe.expand)this._refreshHierarchyState(e,t,i),this.fireListeners(Ct.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:Qe.collapse});else if(o===Qe.collapse){const r=this.internalProps.layoutMap.getHeadNode(e,t);Array.isArray(r.children)&&this._refreshHierarchyState(e,t,i),this.fireListeners(Ct.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:Qe.expand,originData:r})}}_refreshHierarchyState(e,t,i=!0,o){var r,n;let s=!1,l=!1;this.stateManager.updateHoverIcon(e,t,void 0,void 0);const d=this.internalProps.layoutMap.checkHasChart();d&&(this.autoFillWidth&&(s=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&(l=this.getAllRowsHeight()<=this.tableNoFrameHeight));const a=this.internalProps.layoutMap.toggleHierarchyState(e,t);o&&o(),this.refreshRowColCount(),this.clearCellStyleCache(),this.scenegraph.updateHierarchyIcon(e,t),(r=this.reactCustomLayout)===null||r===void 0||r.clearCache(),this.scenegraph.updateRow(a.removeCellPositions,a.addCellPositions,a.updateCellPositions,i),(n=this.reactCustomLayout)===null||n===void 0||n.updateAllCustomCell(),d&&(this.autoFillWidth&&!s&&(s=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!l&&(l=this.getAllRowsHeight()<=this.tableNoFrameHeight),(this.widthMode==="adaptive"||s||this.heightMode==="adaptive"||l)&&this.scenegraph.updateChartSizeForResizeColWidth(-1))}getHeaderCellAddressByPath(e){return this.internalProps.layoutMap.getPivotCellAdress(e)}getCellAddressByHeaderPaths(e){return this.internalProps.layoutMap.getCellAdressByHeaderPath(e)}getHeaderPathByXY(e){let t;return t=e?this.getCellAt(e.x+this.getFrozenColsWidth()+this.scrollLeft+1,e.y+this.getFrozenRowsHeight()+this.scrollTop+1):this.getCellAt(this.getFrozenColsWidth()+this.scrollLeft+1,this.getFrozenRowsHeight()+this.scrollTop+1),this.internalProps.layoutMap.getCellHeaderPaths(t.col,t.row)}getHierarchyState(e,t){var i;return(i=this._getHeaderLayoutMap(e,t))===null||i===void 0?void 0:i.hierarchyState}getLayoutColumnTree(){return this.internalProps.layoutMap.getLayoutColumnTree()}getLayoutColumnTreeCount(){return this.internalProps.layoutMap.getLayoutColumnTreeCount()}getLayoutRowTree(){return this.internalProps.layoutMap.getLayoutRowTree()}getLayoutRowTreeCount(){return this.internalProps.layoutMap.getLayoutRowTreeCount()}getCellHeaderTreeNodes(e,t){return this.internalProps.layoutMap.getCellHeaderPathsWithTreeNode(e,t)}_hasHierarchyTreeHeader(){return this.internalProps.layoutMap.rowHierarchyType==="tree"}getMenuInfo(e,t,i){const o=this.internalProps.layoutMap.getPivotDimensionInfo(e,t);return{dimensionKey:o[o.length-1].dimensionKey,value:this.getCellValue(e,t),cellLocation:this.getCellLocation(e,t),isPivotCorner:this.isCornerHeader(e,t),event:void 0}}setRecords(e){var t,i,o,r,n,s,l;const d={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.options.records=this.internalProps.records=e,this.internalProps.recordsIsTwoDimensionalArray=!1,((t=e==null?void 0:e[0])===null||t===void 0?void 0:t.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0);const a=this.options,h=this.internalProps;if(((i=this.options.customConfig)===null||i===void 0?void 0:i.enableDataAnalysis)===!1)this.internalProps.recordsIsTwoDimensionalArray===!1&&(this.flatDataToObjects=new yt({rows:h.layoutMap.fullRowDimensionKeys,columns:h.layoutMap.colDimensionKeys,indicators:h.layoutMap.indicatorKeys,indicatorsAsCol:h.layoutMap.indicatorsAsCol,indicatorDimensionKey:h.layoutMap.indicatorDimensionKey},e));else{let c,u;this.dataset.setRecords(e),c=a.columnTree?h.layoutMap.columnDimensionTree:new ce((o=this.dataset.colHeaderTree)!==null&&o!==void 0?o:[],this.layoutNodeId),u=a.rowTree?h.layoutMap.rowDimensionTree:new ce((r=this.dataset.rowHeaderTree)!==null&&r!==void 0?r:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType==="tree"?(n=this.options.rowExpandLevel)!==null&&n!==void 0?n:1:void 0),h.layoutMap=new Ee(this,this.dataset,c,u),this.pivotSortState=[],a.pivotSortState&&(this.pivotSortState=a.pivotSortState)}if(this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(d.col,d.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.eventManager.updateEventBinder(),this.options.emptyTip)if(this.internalProps.emptyTip)(s=this.internalProps.emptyTip)===null||s===void 0||s.resetVisible();else{const c=Le.getComponent("emptyTip");this.internalProps.emptyTip=new c(this.options.emptyTip,this),(l=this.internalProps.emptyTip)===null||l===void 0||l.resetVisible()}}startEditCell(e,t,i){var o;if(O(e)&&O(t))this.eventManager.isDraging=!1,this.selectCell(e,t),this.editorManager.startEditCell(e,t,i);else if(!((o=this.stateManager.select)===null||o===void 0)&&o.cellPos){const{col:r,row:n}=this.stateManager.select.cellPos;O(r)&&O(n)&&this.editorManager.startEditCell(r,n,i)}}completeEditCell(){this.editorManager.completeEdit()}getEditor(e,t){var i,o,r;let n;if(this.isCornerHeader(e,t)){const s=this.getHeaderDefine(e,t);n=(i=s==null?void 0:s.headerEditor)!==null&&i!==void 0?i:this.options.headerEditor}else if(this.isHeader(e,t)){const s=this.getHeaderDefine(e,t);n=(o=s==null?void 0:s.headerEditor)!==null&&o!==void 0?o:this.options.headerEditor}else{const s=this.getBodyColumnDefine(e,t);n=(r=s==null?void 0:s.editor)!==null&&r!==void 0?r:this.options.editor}return typeof n=="function"&&(n=n({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||"",table:this})),typeof n=="string"?zi(n):n}isHasEditorDefine(e,t){var i;const o=this.getBodyColumnDefine(e,t);let r=(i=o==null?void 0:o.editor)!==null&&i!==void 0?i:this.options.editor;return typeof r=="function"&&(r=r({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||"",table:this})),O(r)}changeCellValue(e,t,i,o=!1){if(o&&this.isHasEditorDefine(e,t)||o===!1){let r=i;const n=this.getCellOriginValue(e,t),s=this.getCellRawValue(e,t);typeof s=="number"&&Ot(i)&&(r=parseFloat(i)),this._changeCellValueToDataSet(e,t,n,r);const l=this.getCellRange(e,t);for(let d=l.start.col;d<=l.end.col;d++)for(let a=l.start.row;a<=l.end.row;a++)this.scenegraph.updateCellContent(d,a);if(this.widthMode==="adaptive"||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth)this.internalProps._widthResizedColMap.size===0&&this.scenegraph.recalculateColWidths();else if(!this.internalProps._widthResizedColMap.has(e)){const d=this.getColWidth(e),a=xt(e,0,this.rowCount-1,this,!1);a!==d&&this.scenegraph.updateColWidth(e,a-d)}if(this.heightMode==="adaptive"||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight)this.internalProps._heightResizedRowMap.size===0&&this.scenegraph.recalculateRowHeights();else if(this.heightMode==="autoHeight"&&!this.internalProps._heightResizedRowMap.has(t)){const d=this.getRowHeight(t),a=Mt(t,0,this.colCount-1,this);this.scenegraph.updateRowHeight(t,a-d)}this.fireListeners(st.CHANGE_CELL_VALUE,{col:e,row:t,rawValue:s,currentValue:n,changedValue:r}),this.scenegraph.updateNextFrame()}}changeCellValues(e,t,i,o=!1){let r=e,n=t;const s=[],l=[];for(let h=0;h<i.length&&!(t+h>this.rowCount-1);h++){const c=i[h],u=[],v=[];s.push(u),l.push(v);for(let g=0;g<c.length&&!(e+g>this.colCount-1);g++){const m=this.getCellRawValue(e+g,t+h);u.push(m);const y=this.getCellOriginValue(e+g,t+h);v.push(y)}}for(let h=0;h<i.length&&!(t+h>this.rowCount-1);h++){n=t+h;const c=i[h];let u=e;for(let v=0;v<c.length&&!(e+v>this.colCount-1);v++)if(u=e+v,o&&this.isHasEditorDefine(e+v,t+h)||o===!1){const g=c[v];let m=g;const y=l[h][v],_=s[h][v];typeof _=="number"&&Ot(g)&&(m=parseFloat(g)),this._changeCellValueToDataSet(e+v,t+h,y,m),this.fireListeners(st.CHANGE_CELL_VALUE,{col:e+v,row:t+h,rawValue:_,currentValue:y,changedValue:this.getCellOriginValue(e+v,t+h)})}r=Math.max(r,u)}const d=this.getCellRange(e,t),a=this.getCellRange(r,n);for(let h=d.start.col;h<=a.end.col;h++)for(let c=d.start.row;c<=a.end.row;c++)this.scenegraph.updateCellContent(h,c);if(this.widthMode==="adaptive"||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth)this.internalProps._widthResizedColMap.size===0&&this.scenegraph.recalculateColWidths();else for(let h=e;h<=a.end.col;h++)if(!this.internalProps._widthResizedColMap.has(h)){const c=this.getColWidth(h),u=xt(h,0,this.rowCount-1,this,!1);u!==c&&this.scenegraph.updateColWidth(h,u-c)}if(this.heightMode==="adaptive"||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight)this.scenegraph.recalculateRowHeights();else if(this.heightMode==="autoHeight"){const h=[],c=[];for(let u=t;u<=a.end.row;u++)if(this.rowHeightsMap.get(u)){const v=this.getRowHeight(u),g=Mt(u,0,this.colCount-1,this);h.push(u),c.push(g-v)}this.scenegraph.updateRowsHeight(h,c)}this.scenegraph.updateNextFrame()}_changeCellValueToDataSet(e,t,i,o){var r,n,s,l,d,a,h,c;if(this.internalProps.recordsIsTwoDimensionalArray){const u=this.getBodyIndexByRow(t),v=this.getBodyIndexByCol(e);this.records[u][v]=o}else if(this.dataset){const u=this.internalProps.layoutMap.getCellHeaderPaths(e,t);if(this.isCornerHeader(e,t))this.internalProps.layoutMap.changeCornerTitle(e,t,o);else if(this.isHeader(e,t))this.internalProps.layoutMap.changeTreeNodeTitle(e,t,o),!this.isCornerHeader(e,t)&&this.dataset.changeRecordFieldValue(!((r=u.colHeaderPaths)===null||r===void 0)&&r.length?(n=u.colHeaderPaths[u.colHeaderPaths.length-1].indicatorKey)!==null&&n!==void 0?n:u.colHeaderPaths[u.colHeaderPaths.length-1].dimensionKey:(s=u.rowHeaderPaths[u.rowHeaderPaths.length-1].indicatorKey)!==null&&s!==void 0?s:u.rowHeaderPaths[u.rowHeaderPaths.length-1].dimensionKey,i,o);else{const v=(l=u.colHeaderPaths)===null||l===void 0?void 0:l.filter(m=>!m.virtual).map(m=>{var y;return(y=m.indicatorKey)!==null&&y!==void 0?y:m.value}),g=(d=u.rowHeaderPaths)===null||d===void 0?void 0:d.filter(m=>!m.virtual).map(m=>{var y;return(y=m.indicatorKey)!==null&&y!==void 0?y:m.value});this.dataset.changeTreeNodeValue(this.internalProps.layoutMap.indicatorsAsCol?g:g.slice(0,-1),this.internalProps.layoutMap.indicatorsAsCol?v.slice(0,-1):v,this.internalProps.layoutMap.getIndicatorKey(e,t),o)}}else if(this.flatDataToObjects){const u=this.internalProps.layoutMap.getCellHeaderPaths(e,t);if(this.isHeader(e,t))this.internalProps.layoutMap.changeTreeNodeTitle(e,t,o),!this.isCornerHeader(e,t)&&this.flatDataToObjects.changeRecordFieldValue(!((a=u.colHeaderPaths)===null||a===void 0)&&a.length?(h=u.colHeaderPaths[u.colHeaderPaths.length-1].indicatorKey)!==null&&h!==void 0?h:u.colHeaderPaths[u.colHeaderPaths.length-1].dimensionKey:(c=u.rowHeaderPaths[u.rowHeaderPaths.length-1].indicatorKey)!==null&&c!==void 0?c:u.rowHeaderPaths[u.rowHeaderPaths.length-1].dimensionKey,i,o);else{const v=u.colHeaderPaths.map(m=>{var y;return(y=m.indicatorKey)!==null&&y!==void 0?y:m.value}),g=u.rowHeaderPaths.map(m=>{var y;return(y=m.indicatorKey)!==null&&y!==void 0?y:m.value});this.flatDataToObjects.changeTreeNodeValue(g,v,this.internalProps.layoutMap.getBody(e,t).indicatorKey,o)}}}_hasCustomRenderOrLayout(){if(this.options.customRender)return!0;const{columnsDefine:e,rowsDefine:t,indicatorsDefine:i}=this.internalProps.layoutMap;for(let o=0;o<e.length;o++){const r=e[o];if(typeof r!="string"&&(r.headerCustomLayout||r.headerCustomRender))return!0}for(let o=0;o<t.length;o++){const r=t[o];if(typeof r!="string"&&(r.headerCustomLayout||r.headerCustomRender))return!0}for(let o=0;o<i.length;o++){const r=i[o];if(typeof r!="string"&&(r.customLayout||r.headerCustomLayout||r.customRender||r.headerCustomRender))return!0}return!1}changeRecordOrder(e,t){}setTreeNodeChildren(e,t,i,o){this.flatDataToObjects?(this.internalProps.layoutMap.getHeadNode(i,o).children=e,this._refreshHierarchyState(i,o,!0,()=>{this.flatDataToObjects.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey}),this.flatDataToObjects.addRecords(t)})):(this.internalProps.layoutMap.getHeadNode(i,o).children=e,this._refreshHierarchyState(i,o,!0,()=>{this.dataset._rowTreeHasChanged(),this.dataset.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys}),this.dataset.addRecords(t)}))}updateFilterRules(e){this.internalProps.dataConfig.filterRules=e,this.dataset.updateFilterRules(e),this.renderWithRecreateCells()}getFilteredRecords(){var e;return(e=this.dataset)===null||e===void 0?void 0:e.filterRules}}qt(),Gt(),Qt(),Jt(),$t(),Yt(),Xt(),Zt(),ei(),ti(),ii(),oi(),ri(),si();class _t extends oo{}qt(),Gt(),Qt(),Jt(),$t(),Yt(),Xt(),Zt(),ei(),ti(),ii(),oi(),ri(),si();class wt extends Wt{constructor(e,t){var i,o,r,n,s,l,d,a,h,c,u,v,g,m,y,_,S,P,f,p;let I,w;mt.mode==="node"?(t=e,e=null):e instanceof HTMLElement||(t=e,e=e.container?e.container:null),super(e,t),this.layoutNodeId={seqId:0},this._selectedDataItemsInChart=[],this._selectedDimensionInChart=[],this._chartEventMap={},t.layout&&Object.assign(t,t.layout),this.internalProps.columns=ge(t.columns),this.internalProps.rows=ge(t.rows),this.internalProps.indicators=nt(t.indicators),this.internalProps.columnTree=!t.indicatorsAsCol||!((i=t.columns)===null||i===void 0)&&i.length||t.columnTree?ge(t.columnTree):[],this.internalProps.rowTree=t.indicatorsAsCol||!((o=t.rows)===null||o===void 0)&&o.length||t.rowTree?ge(t.rowTree):[],this.internalProps.records=t.records,this.setCustomStateNameToSpec(),this.internalProps.columnResizeType=(r=t.columnResizeType)!==null&&r!==void 0?r:"column",this.internalProps.rowResizeType=(n=t.rowResizeType)!==null&&n!==void 0?n:"row",this.internalProps.dataConfig={isPivotChart:!0},this._axes=Oe(t.axes)?t.axes:[],t.columnTree&&(t.indicatorsAsCol!==!1&&(this.internalProps.columnTree=Ae(this.internalProps.columnTree,t.indicators)),I=new ce((s=this.internalProps.columnTree)!==null&&s!==void 0?s:[],this.layoutNodeId)),t.rowTree&&(t.indicatorsAsCol===!1&&(this.internalProps.rowTree=Ae(this.internalProps.rowTree,t.indicators)),w=new ce((l=this.internalProps.rowTree)!==null&&l!==void 0?l:[],this.layoutNodeId));const C=!((d=w==null?void 0:w.dimensionKeys)===null||d===void 0)&&d.count?w.dimensionKeys.valueArr():(h=(a=t.rows)===null||a===void 0?void 0:a.reduce((b,x)=>(typeof x=="string"?b.push(x):b.push(x.dimensionKey),b),[]))!==null&&h!==void 0?h:[],T=!((c=I==null?void 0:I.dimensionKeys)===null||c===void 0)&&c.count?I.dimensionKeys.valueArr():(v=(u=t.columns)===null||u===void 0?void 0:u.reduce((b,x)=>(typeof x=="string"?b.push(x):b.push(x.dimensionKey),b),[]))!==null&&v!==void 0?v:[],H=(m=(g=t.indicators)===null||g===void 0?void 0:g.reduce((b,x)=>(typeof x=="string"?b.push(x):b.push(x.indicatorKey),b),[]))!==null&&m!==void 0?m:[];if(this.internalProps.dataConfig.collectValuesBy=this._generateCollectValuesConfig(T,C),this.internalProps.dataConfig.aggregationRules=this._generateAggregationRules(),this.internalProps.dataConfig.dimensionSortArray=this._getDimensionSortArray(),this.dataset=new at(this.internalProps.dataConfig,C,T,H,this.internalProps.indicators,(y=t.indicatorsAsCol)===null||y===void 0||y,t.records,void 0,this.internalProps.columnTree,this.internalProps.rowTree,!0),this.options.indicatorsAsCol&&it(this.internalProps.indicators)){const b=x=>{x.forEach(A=>{var E;!((E=A.children)===null||E===void 0)&&E.length?b(A.children):A.children=[{dimensionKey:"axis",value:""}]})};!((_=this.dataset.rowHeaderTree)===null||_===void 0)&&_.length?b(this.dataset.rowHeaderTree):this.dataset.rowHeaderTree=[{dimensionKey:"axis",value:""}]}if(t.columnTree||t.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Ae(this.dataset.colHeaderTree,t.indicators)),t.rowTree||t.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Ae(this.dataset.rowHeaderTree,t.indicators)),I=new ce((S=this.dataset.colHeaderTree)!==null&&S!==void 0?S:[],this.layoutNodeId),w=new ce((P=this.dataset.rowHeaderTree)!==null&&P!==void 0?P:[],this.layoutNodeId),this.internalProps.layoutMap=new Ee(this,this.dataset,I,w),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.createSceneGraph(),t.title){const b=Le.getComponent("title");this.internalProps.title=new b(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(f=this.internalProps.emptyTip)===null||f===void 0||f.resetVisible();else{const b=Le.getComponent("emptyTip");this.internalProps.emptyTip=new b(this.options.emptyTip,this),(p=this.internalProps.emptyTip)===null||p===void 0||p.resetVisible()}setTimeout(()=>{this.fireListeners(st.INITIALIZED,null)},0)}static get EVENT_TYPE(){return ki}get pivotChartAxes(){return this._axes}get recordsCount(){var e;return(e=this.records)===null||e===void 0?void 0:e.length}isListTable(){return!1}isPivotTable(){return!0}isPivotChart(){return!0}_canResizeColumn(e,t){const i=super._canResizeColumn(e,t);if(i&&!this.internalProps.layoutMap.indicatorsAsCol){const o=this.internalProps.layoutMap.getBody(e,this.columnHeaderLevelCount);if(o!=null&&o.disableColumnResize)return!1}return i}updateOption(e){var t,i,o,r,n,s,l,d,a,h,c,u,v,g,m,y,_,S,P,f,p,I;const w=this.internalProps;let C,T;super.updateOption(e),this.layoutNodeId={seqId:0},this.internalProps.columns=ge(e.columns),this.internalProps.rows=ge(e.rows),this.internalProps.indicators=!((t=e.indicators)===null||t===void 0)&&t.length?nt(e.indicators):[],this.internalProps.columnTree=!e.indicatorsAsCol||!((i=e.columns)===null||i===void 0)&&i.length||e.columnTree?ge(e.columnTree):[],this.internalProps.rowTree=e.indicatorsAsCol||!((o=e.rows)===null||o===void 0)&&o.length||e.rowTree?ge(e.rowTree):[],e.records&&(this.internalProps.records=e.records),this.setCustomStateNameToSpec(),this._selectedDataItemsInChart=[],w.columnResizeType=(r=e.columnResizeType)!==null&&r!==void 0?r:"column",w.rowResizeType=(n=e.rowResizeType)!==null&&n!==void 0?n:"row",w.dataConfig={isPivotChart:!0},this._axes=Oe(e.axes)?e.axes:[],e.columnTree&&(e.indicatorsAsCol!==!1&&(this.internalProps.columnTree=Ae(this.internalProps.columnTree,e.indicators)),C=new ce((s=this.internalProps.columnTree)!==null&&s!==void 0?s:[],this.layoutNodeId)),e.rowTree&&(e.indicatorsAsCol===!1&&(this.internalProps.rowTree=Ae(this.internalProps.rowTree,e.indicators)),T=new ce((l=this.internalProps.rowTree)!==null&&l!==void 0?l:[],this.layoutNodeId));const H=!((d=T==null?void 0:T.dimensionKeys)===null||d===void 0)&&d.count?T.dimensionKeys.valueArr():(h=(a=e.rows)===null||a===void 0?void 0:a.reduce((A,E)=>(typeof E=="string"?A.push(E):A.push(E.dimensionKey),A),[]))!==null&&h!==void 0?h:[],b=!((c=C==null?void 0:C.dimensionKeys)===null||c===void 0)&&c.count?C.dimensionKeys.valueArr():(v=(u=e.columns)===null||u===void 0?void 0:u.reduce((A,E)=>(typeof E=="string"?A.push(E):A.push(E.dimensionKey),A),[]))!==null&&v!==void 0?v:[],x=(m=(g=e.indicators)===null||g===void 0?void 0:g.reduce((A,E)=>(typeof E=="string"?A.push(E):A.push(E.indicatorKey),A),[]))!==null&&m!==void 0?m:[];if(this.internalProps.dataConfig.collectValuesBy=this._generateCollectValuesConfig(b,H),this.internalProps.dataConfig.aggregationRules=this._generateAggregationRules(),this.internalProps.dataConfig.dimensionSortArray=this._getDimensionSortArray(),this.dataset=new at(this.internalProps.dataConfig,H,b,x,this.internalProps.indicators,(y=e.indicatorsAsCol)===null||y===void 0||y,(_=e.records)!==null&&_!==void 0?_:this.internalProps.records,void 0,this.internalProps.columnTree,this.internalProps.rowTree,!0),this.options.indicatorsAsCol&&it(this.internalProps.indicators)){const A=E=>{E.forEach(Q=>{var J;!((J=Q.children)===null||J===void 0)&&J.length?A(Q.children):Q.children=[{dimensionKey:"axis",value:""}]})};!((S=this.dataset.rowHeaderTree)===null||S===void 0)&&S.length?A(this.dataset.rowHeaderTree):this.dataset.rowHeaderTree=[{dimensionKey:"axis",value:""}]}if(e.columnTree||e.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Ae(this.dataset.colHeaderTree,e.indicators)),e.rowTree||e.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Ae(this.dataset.rowHeaderTree,e.indicators)),C=new ce((P=this.dataset.colHeaderTree)!==null&&P!==void 0?P:[],this.layoutNodeId),T=new ce((f=this.dataset.rowHeaderTree)!==null&&f!==void 0?f:[],this.layoutNodeId),w.layoutMap=new Ee(this,this.dataset,C,T),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,w.releaseList&&(w.releaseList.forEach(A=>{var E;return(E=A==null?void 0:A.release)===null||E===void 0?void 0:E.call(A)}),w.releaseList=null),this.scenegraph.clearCells(),this.scenegraph.createSceneGraph(),e.title){const A=Le.getComponent("title");this.internalProps.title=new A(e.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(p=this.internalProps.emptyTip)===null||p===void 0||p.resetVisible();else{const A=Le.getComponent("emptyTip");this.internalProps.emptyTip=new A(this.options.emptyTip,this),(I=this.internalProps.emptyTip)===null||I===void 0||I.resetVisible()}return new Promise(A=>{setTimeout(A,0)})}updatePagination(){}refreshHeader(){this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var e,t,i,o,r,n,s,l;const d=this,{layoutMap:a}=d.internalProps;a&&(d.colCount=(e=a.colCount)!==null&&e!==void 0?e:0,d.rowCount=(t=a.rowCount)!==null&&t!==void 0?t:0,d.internalProps.frozenColCount=(i=a.rowHeaderLevelCount)!==null&&i!==void 0?i:0,d.frozenRowCount=Math.max(a.headerLevelCount,(o=this.options.frozenRowCount)!==null&&o!==void 0?o:0),d.bottomFrozenRowCount!==((r=a==null?void 0:a.bottomFrozenRowCount)!==null&&r!==void 0?r:0)&&(d.bottomFrozenRowCount=(n=a==null?void 0:a.bottomFrozenRowCount)!==null&&n!==void 0?n:0),d.rightFrozenColCount!==((s=a==null?void 0:a.rightFrozenColCount)!==null&&s!==void 0?s:0)&&(d.rightFrozenColCount=(l=a==null?void 0:a.rightFrozenColCount)!==null&&l!==void 0?l:0),this.stateManager.setFrozenCol(this.internalProps.frozenColCount))}_getSortFuncFromHeaderOption(e,t,i){}syncHierarchyState(e,t){var i,o;e.value===t.value&&e.dimensionKey===t.dimensionKey&&(t.hierarchyState=(i=t.hierarchyState)!==null&&i!==void 0?i:t!=null&&t.children?e.hierarchyState:void 0,(o=t==null?void 0:t.children)===null||o===void 0||o.forEach((r,n)=>{var s;!((s=e==null?void 0:e.children)===null||s===void 0)&&s[n]&&r&&this.syncHierarchyState(e.children[n],r)}))}getRecordShowIndexByCell(e,t){}getTableIndexByRecordIndex(e){}getTableIndexByField(e){}getCellAddrByFieldRecord(e,t){}getBodyIndexByRow(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByRow(e)}getBodyIndexByCol(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByCol(e)}getCellValue(e,t,i){var o,r,n;if(!i){const h=this.getCustomMergeValue(e,t);if(h)return h}if(this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.layoutMap.isBottomFrozenRow(e,t)||this.internalProps.layoutMap.isRightFrozenColumn(e,t)){const u=this.internalProps.layoutMap.getIndicatorKeyInChartSpec(e,t);let v;return u==null||u.forEach(g=>{const m=this.internalProps.layoutMap.getIndicatorInfo(g);m&&(v=m)}),(r=(o=v==null?void 0:v.title)!==null&&o!==void 0?o:v==null?void 0:v.indicatorKey)!==null&&r!==void 0?r:""}const{title:h,fieldFormat:c}=this.internalProps.layoutMap.getHeader(e,t);return typeof c=="function"?c(h,e,t,this):h}if(this.dataset){let h;const c=this.internalProps.layoutMap.getCellHeaderPaths(e,t),u=c.colHeaderPaths.map((m,y)=>{var _;return m.indicatorKey&&(h={position:"col",index:y}),(_=m.indicatorKey)!==null&&_!==void 0?_:m.value}),v=c.rowHeaderPaths.map((m,y)=>{var _;return m.indicatorKey&&(h={position:"row",index:y}),(_=m.indicatorKey)!==null&&_!==void 0?_:m.value}),g=this.dataset.getAggregator(v,u,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,h);return g.value?g.value():void 0}const{fieldFormat:s}=this.internalProps.layoutMap.getBody(e,t),l=this.getBodyIndexByRow(t),d=this.getBodyIndexByCol(e),a=(n=this.records[l])===null||n===void 0?void 0:n[d];return typeof s=="function"?s(a,e,t,this):a}getCellOriginValue(e,t){var i,o,r;const n=this;if(n.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.layoutMap.isBottomFrozenRow(e,t)||this.internalProps.layoutMap.isRightFrozenColumn(e,t)){const a=this.internalProps.layoutMap.getIndicatorKeyInChartSpec(e,t);let h;return a==null||a.forEach(c=>{const u=this.internalProps.layoutMap.getIndicatorInfo(c);u&&(h=u)}),(o=(i=h==null?void 0:h.title)!==null&&i!==void 0?i:h==null?void 0:h.indicatorKey)!==null&&o!==void 0?o:""}const{title:d}=n.internalProps.layoutMap.getHeader(e,t);return typeof d=="function"?d():d}if(this.dataset){let d;const a=this.internalProps.layoutMap.getCellHeaderPaths(e,t),h=a.colHeaderPaths.map((v,g)=>{var m;return v.indicatorKey&&(d={position:"col",index:g}),(m=v.indicatorKey)!==null&&m!==void 0?m:v.value}),c=a.rowHeaderPaths.map((v,g)=>{var m;return v.indicatorKey&&(d={position:"row",index:g}),(m=v.indicatorKey)!==null&&m!==void 0?m:v.value}),u=this.dataset.getAggregator(c,h,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,d);return u.value?u.value():void 0}const s=this.getBodyIndexByRow(t),l=this.getBodyIndexByCol(e);return(r=this.records[s])===null||r===void 0?void 0:r[l]}getCellRawValue(e,t){return this.getCellOriginValue(e,t)}getCellOriginRecord(e,t){if(!this.internalProps.layoutMap.isHeader(e,t)&&this.dataset){let i;const o=this.internalProps.layoutMap.getCellHeaderPaths(e,t),r=o.colHeaderPaths.map((s,l)=>{var d;return s.indicatorKey&&(i={position:"col",index:l}),(d=s.indicatorKey)!==null&&d!==void 0?d:s.value}),n=o.rowHeaderPaths.map((s,l)=>{var d;return s.indicatorKey&&(i={position:"row",index:l}),(d=s.indicatorKey)!==null&&d!==void 0?d:s.value});return this.dataset.getAggregator(n,r,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,i).records}}getCellRawRecord(e,t){return this.getCellOriginRecord(e,t)}getPivotSortState(e,t){if(!this.pivotSortState)return;const i=this.getCellRange(e,t);for(let o=0;o<this.pivotSortState.length;o++){const{col:r,row:n,order:s}=this.pivotSortState[o];if(Ut(i,r,n))return s}}_moveHeaderPosition(e,t){var i,o,r,n;const s=this.internalProps.layoutMap.moveHeaderPosition(e,t);if(s){if(s.moveType==="column"){if(((o=(i=this.options.records)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.constructor)===Array)for(let l=0;l<this.internalProps.records.length;l++){const d=this.internalProps.records[l].splice(s.sourceIndex-this.rowHeaderLevelCount,s.sourceSize);d.unshift(s.targetIndex-this.rowHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records[l],d)}this.colWidthsMap.adjustOrder(s.sourceIndex,s.targetIndex,s.sourceSize),this.setMinMaxLimitWidth()}else if(s.moveType==="row"){if(((n=(r=this.options.records)===null||r===void 0?void 0:r[0])===null||n===void 0?void 0:n.constructor)===Array){const l=this.internalProps.records.splice(s.sourceIndex-this.columnHeaderLevelCount,s.sourceSize);l.unshift(s.targetIndex-this.columnHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records,l)}this.rowHeightsMap.adjustOrder(s.sourceIndex,s.targetIndex,s.sourceSize)}return s}return null}toggleHierarchyState(e,t,i=!0){}getHeaderCellAddressByPath(e){return this.internalProps.layoutMap.getPivotCellAdress(e)}getCellAddressByHeaderPaths(e){return this.internalProps.layoutMap.getCellAdressByHeaderPath(e)}getHeaderPathByXY(e){let t;return t=e?this.getCellAt(e.x+this.getFrozenColsWidth()+this.scrollLeft+1,e.y+this.getFrozenRowsHeight()+this.scrollTop+1):this.getCellAt(this.getFrozenColsWidth()+this.scrollLeft+1,this.getFrozenRowsHeight()+this.scrollTop+1),this.internalProps.layoutMap.getCellHeaderPaths(t.col,t.row)}getHierarchyState(e,t){var i;return(i=this._getHeaderLayoutMap(e,t))===null||i===void 0?void 0:i.hierarchyState}_hasHierarchyTreeHeader(){return this.internalProps.layoutMap.rowHierarchyType==="tree"}getMenuInfo(e,t,i){const o=this.internalProps.layoutMap.getPivotDimensionInfo(e,t);return{dimensionKey:o[o.length-1].dimensionKey,value:this.getCellValue(e,t),cellLocation:this.getCellLocation(e,t),isPivotCorner:this.isCornerHeader(e,t),event:void 0}}_generateCollectValuesConfig(e,t){var i,o,r,n,s,l,d,a,h,c,u,v,g,m,y,_,S;e=e.filter(p=>p!==Me),t=t.filter(p=>p!==Me);const P=this.internalProps.indicators,f={};for(let p=0,I=P==null?void 0:P.length;p<I;p++)if(typeof P[p]!="string"&&P[p].chartSpec){if(((i=P[p].chartSpec)===null||i===void 0?void 0:i.type)==="pie"||((o=P[p].chartSpec)===null||o===void 0?void 0:o.type)==="rose"||((r=P[p].chartSpec)===null||r===void 0?void 0:r.type)==="radar"||((n=P[p].chartSpec)===null||n===void 0?void 0:n.type)==="gauge"||((s=P[p].chartSpec)===null||s===void 0?void 0:s.type)==="wordCloud")continue;const w=P[p],C=w.chartSpec;if(this.options.indicatorsAsCol===!1)if((C==null?void 0:C.stack)!==!1&&((C==null?void 0:C.type)==="bar"||(C==null?void 0:C.type)==="area")&&(C.stack=!0),f[w.indicatorKey]={by:t,range:!0,sumBy:(C==null?void 0:C.stack)&&e.concat(C==null?void 0:C.xField)},C.series)C.series.forEach(T=>{var H,b,x,A,E,Q,J,U,X,se,ne,le,ae,de;const he=typeof T.xField=="string"?T.xField:T.xField[0];f[he]={by:e,type:T.direction!=="horizontal"?"xField":void 0,range:Ge(T,this._axes,T.direction==="horizontal",!0),sortBy:T.direction!=="horizontal"?(A=(x=(b=(H=T==null?void 0:T.data)===null||H===void 0?void 0:H.fields)===null||b===void 0?void 0:b[he])===null||x===void 0?void 0:x.domain)!==null&&A!==void 0?A:(J=(Q=(E=C==null?void 0:C.data)===null||E===void 0?void 0:E.fields)===null||Q===void 0?void 0:Q[he])===null||J===void 0?void 0:J.domain:void 0};const ue=T.yField;T.stack!==!1&&(T.type==="bar"||T.type==="area")&&(T.stack=!0),f[ue]={by:t,range:Ge(T,this._axes,T.direction==="horizontal",!1),sumBy:T.stack&&e.concat(T==null?void 0:T.xField),sortBy:T.direction==="horizontal"?(ne=(se=(X=(U=T==null?void 0:T.data)===null||U===void 0?void 0:U.fields)===null||X===void 0?void 0:X[ue])===null||se===void 0?void 0:se.domain)!==null&&ne!==void 0?ne:(de=(ae=(le=C==null?void 0:C.data)===null||le===void 0?void 0:le.fields)===null||ae===void 0?void 0:ae[ue])===null||de===void 0?void 0:de.domain:void 0,extendRange:rt(C.markLine)}});else{const T=typeof C.xField=="string"?C.xField:C.xField[0];f[T]={by:e,type:C.direction!=="horizontal"?"xField":void 0,range:Ge(C,this._axes,C.direction==="horizontal",!0),sortBy:C.direction!=="horizontal"?(a=(d=(l=C==null?void 0:C.data)===null||l===void 0?void 0:l.fields)===null||d===void 0?void 0:d[T])===null||a===void 0?void 0:a.domain:void 0},(C==null?void 0:C.stack)!==!1&&((C==null?void 0:C.type)==="bar"||(C==null?void 0:C.type)==="area")&&(C.stack=!0);const H=C.yField;f[H]={by:t,range:C.direction!=="horizontal",sumBy:C.stack&&e.concat(C==null?void 0:C.xField),sortBy:C.direction==="horizontal"?(u=(c=(h=C==null?void 0:C.data)===null||h===void 0?void 0:h.fields)===null||c===void 0?void 0:c[H])===null||u===void 0?void 0:u.domain:void 0,extendRange:rt(C.markLine)}}else{const T=P[p];if((C==null?void 0:C.stack)!==!1&&((C==null?void 0:C.type)==="bar"||(C==null?void 0:C.type)==="area")&&(C.stack=!0),f[T.indicatorKey]={by:e,range:!0,sumBy:(C==null?void 0:C.stack)&&t.concat(C==null?void 0:C.yField)},C.series)C.series.forEach(H=>{var b,x,A,E,Q,J,U,X,se,ne,le,ae,de,he;const ue=typeof H.yField=="string"?H.yField:H.yField[0];f[ue]={by:t,type:H.direction==="horizontal"?"yField":void 0,range:Ge(H,this._axes,H.direction==="horizontal",!1),sortBy:H.direction==="horizontal"?(E=(A=(x=(b=H==null?void 0:H.data)===null||b===void 0?void 0:b.fields)===null||x===void 0?void 0:x[ue])===null||A===void 0?void 0:A.domain)!==null&&E!==void 0?E:(U=(J=(Q=C==null?void 0:C.data)===null||Q===void 0?void 0:Q.fields)===null||J===void 0?void 0:J[ue])===null||U===void 0?void 0:U.domain:void 0};const Ce=H.xField;H.stack!==!1&&(H.type==="bar"||H.type==="area")&&(H.stack=!0),f[Ce]={by:e,range:Ge(H,this._axes,H.direction==="horizontal",!0),sumBy:H.stack&&t.concat(H==null?void 0:H.yField),sortBy:H.direction!=="horizontal"?(le=(ne=(se=(X=H==null?void 0:H.data)===null||X===void 0?void 0:X.fields)===null||se===void 0?void 0:se[Ce])===null||ne===void 0?void 0:ne.domain)!==null&&le!==void 0?le:(he=(de=(ae=C==null?void 0:C.data)===null||ae===void 0?void 0:ae.fields)===null||de===void 0?void 0:de[Ce])===null||he===void 0?void 0:he.domain:void 0,extendRange:rt(C.markLine)}});else{const H=typeof C.yField=="string"?C.yField:C.yField[0];f[H]={by:t,type:C.direction==="horizontal"?"yField":void 0,range:Ge(C,this._axes,C.direction==="horizontal",!1),sortBy:C.direction==="horizontal"?(m=(g=(v=C==null?void 0:C.data)===null||v===void 0?void 0:v.fields)===null||g===void 0?void 0:g[H])===null||m===void 0?void 0:m.domain:void 0},(C==null?void 0:C.stack)!==!1&&((C==null?void 0:C.type)==="bar"||(C==null?void 0:C.type)==="area")&&(C.stack=!0);const b=C.xField;f[b]={by:e,range:Ge(C,this._axes,C.direction==="horizontal",!0),sumBy:C.stack&&t.concat(C==null?void 0:C.yField),sortBy:C.direction!=="horizontal"?(S=(_=(y=C==null?void 0:C.data)===null||y===void 0?void 0:y.fields)===null||_===void 0?void 0:_[b])===null||S===void 0?void 0:S.domain:void 0,extendRange:rt(C.markLine)}}}}return f}_generateAggregationRules(){var e;const t=[];return(e=this.internalProps.indicators)===null||e===void 0||e.forEach(i=>{var o,r;if(typeof i=="string")t.push({indicatorKey:i,field:i,aggregationType:ie.RECORD});else if(!((o=i.chartSpec)===null||o===void 0)&&o.series){const n=[];(r=i.chartSpec)===null||r===void 0||r.series.forEach(s=>{const l=this.options.indicatorsAsCol===!1?s.yField:s.xField;n.indexOf(l)===-1&&n.push(l)}),t.push({indicatorKey:i.indicatorKey,field:n,aggregationType:ie.RECORD})}else{const n=this.options.indicatorsAsCol===!1?i.chartSpec.yField:i.chartSpec.xField;t.push({indicatorKey:i.indicatorKey,field:n??i.indicatorKey,aggregationType:ie.RECORD})}}),t}setCustomStateNameToSpec(){var e;const t=i=>{var o,r,n,s,l,d,a,h,c,u;!((r=(o=i.bar)===null||o===void 0?void 0:o.state)===null||r===void 0)&&r.selected&&(i.bar.state.vtable_selected=i.bar.state.selected,i.bar.state.vtable_selected_reverse=i.bar.state.selected_reverse,delete i.bar.state.selected,delete i.bar.state.selected_reverse),!((s=(n=i.point)===null||n===void 0?void 0:n.state)===null||s===void 0)&&s.selected&&(i.point.state.vtable_selected=i.point.state.selected,i.point.state.vtable_selected_reverse=i.point.state.selected_reverse,delete i.point.state.selected,delete i.point.state.selected_reverse),!((d=(l=i.line)===null||l===void 0?void 0:l.state)===null||d===void 0)&&d.selected&&(i.line.state.vtable_selected=i.line.state.selected,i.line.state.vtable_selected_reverse=i.line.state.selected_reverse,delete i.line.state.selected,delete i.line.state.selected_reverse),!((h=(a=i.area)===null||a===void 0?void 0:a.state)===null||h===void 0)&&h.selected&&(i.area.state.vtable_selected=i.area.state.selected,i.area.state.vtable_selected_reverse=i.area.state.selected_reverse,delete i.area.state.selected,delete i.area.state.selected_reverse),!((u=(c=i.pie)===null||c===void 0?void 0:c.state)===null||u===void 0)&&u.selected&&(i.pie.state.vtable_selected=i.pie.state.selected,i.pie.state.vtable_selected_reverse=i.pie.state.selected_reverse,delete i.pie.state.selected,delete i.pie.state.selected_reverse)};(e=this.internalProps.indicators)===null||e===void 0||e.forEach(i=>{if(i.chartSpec){const o=i.chartSpec;o.series?o.series.forEach(r=>{t(r)}):t(o)}})}updateFilterRules(e){this.internalProps.dataConfig.filterRules=e,this.dataset.updateFilterRules(e),Et(this.scenegraph),ji(this.scenegraph),this.render()}clearChartCacheImage(e,t){lt(e)&&lt(t)?Wi(e,t,this.scenegraph):Et(this.scenegraph)}getLegendSelected(){var e;const t=[];return(e=this.internalProps.legends)===null||e===void 0||e.forEach(i=>{const o=i.legendComponent._getSelectedLegends().map(r=>r.label);t.push(...o)}),t}setLegendSelected(e){var t;(t=this.internalProps.legends)===null||t===void 0||t.forEach(i=>{i.legendComponent.setSelected(e)})}getChartDatumPosition(e,t){const{chartInstance:i,bounds:o}=this.getChartInstance(t);if(i){const r=i.convertDatumToPosition(e);return r?{x:Math.round(r.x+o.x1),y:Math.round(r.y+o.y1)}:null}return null}getCellAddressByRecord(e){const t=[],i=[],o={},r=[];this.dataset.dataConfig.aggregationRules.forEach(n=>{if(typeof n.field=="string")o[n.field]=n.indicatorKey,r.push(n.field);else for(let s=0;s<n.field.length;s++)o[n.field[s]]=n.indicatorKey,r.push(n.field[s])});for(const n in e)this.dataset.rows.indexOf(n)>=0&&t.push({dimensionKey:n,value:e[n]}),this.dataset.columns.indexOf(n)>=0&&i.push({dimensionKey:n,value:e[n]}),r.indexOf(n)>=0&&(this.dataset.indicatorsAsCol?i.push({indicatorKey:o[n]}):t.push({indicatorKey:o[n]}));return this.getCellAddressByHeaderPaths({rowHeaderPaths:t,colHeaderPaths:i,cellLocation:"body"})}getChartInstance(e){var t,i,o,r,n;const s=this.getCellAddressByHeaderPaths(e);if(s){const l=this.getCellRelativeRect(s.col,s.row),d=this.scenegraph.getCell(s.col,s.row);let a;const h=(t=d==null?void 0:d.getChildren())===null||t===void 0?void 0:t[0];if(h.attribute.chartInstance){a=h.attribute.chartInstance;const{dataId:c,data:u,axes:v,spec:g}=h.attribute,m=h.getViewBox();if(v==null||v.forEach((y,_)=>{var S,P,f,p;y.type==="linear"?a.updateModelSpecSync({type:"axes",index:_},{min:(P=(S=y.range)===null||S===void 0?void 0:S.min)!==null&&P!==void 0?P:0,max:(p=(f=y.range)===null||f===void 0?void 0:f.max)!==null&&p!==void 0?p:0},!0):y.type==="band"&&a.updateModelSpec({type:"axes",index:_},{domain:y.domain.slice(0)},!0)}),a.updateViewBox({x1:m.x1-h.getRootNode().table.scrollLeft,x2:m.x2-h.getRootNode().table.scrollLeft,y1:m.y1-h.getRootNode().table.scrollTop,y2:m.y2-h.getRootNode().table.scrollTop},!1,!1),typeof c=="string")a.updateDataSync(c,u??[]);else{const y=[];for(const _ in c){const S=c[_],P=g.series.find(f=>{var p;return((p=f==null?void 0:f.data)===null||p===void 0?void 0:p.id)===_});y.push({id:_,values:S?(i=u==null?void 0:u.filter(f=>f.hasOwnProperty(S)))!==null&&i!==void 0?i:[]:u??[],fields:(o=P==null?void 0:P.data)===null||o===void 0?void 0:o.fields}),a.updateFullDataSync||a.updateDataSync(_,S?(r=u==null?void 0:u.filter(f=>f.hasOwnProperty(S)))!==null&&r!==void 0?r:[]:u??[])}(n=a.updateFullDataSync)===null||n===void 0||n.call(a,y)}this.renderAsync()}return{chartInstance:a,bounds:l.bounds}}return{}}_getDimensionSortArray(){var e,t;if(!((t=(e=this.options)===null||e===void 0?void 0:e.axes)===null||t===void 0)&&t.length){const i=this.options.indicatorsAsCol?"left":"bottom",o=this.options.axes.find(r=>r.orient===i);if(o&&Oe(o.domain))return o.domain}}setRecords(e){var t,i;const o={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.options.records=this.internalProps.records=e;const r=this.options,n=this.internalProps;let s,l;this.dataset.setRecords(e),s=r.columnTree?n.layoutMap.columnDimensionTree:new ce((t=this.dataset.colHeaderTree)!==null&&t!==void 0?t:[],this.layoutNodeId),l=r.rowTree?n.layoutMap.rowDimensionTree:new ce((i=this.dataset.rowHeaderTree)!==null&&i!==void 0?i:[],this.layoutNodeId),n.layoutMap=new Ee(this,this.dataset,s,l),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(o.col,o.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.eventManager.updateEventBinder()}_hasCustomRenderOrLayout(){if(this.options.customRender)return!0;const{columnsDefine:e,rowsDefine:t,indicatorsDefine:i}=this.internalProps.layoutMap;for(let o=0;o<e.length;o++){const r=e[o];if(typeof r!="string"&&(r.headerCustomLayout||r.headerCustomRender))return!0}for(let o=0;o<t.length;o++){const r=t[o];if(typeof r!="string"&&(r.headerCustomLayout||r.headerCustomRender))return!0}for(let o=0;o<i.length;o++){const r=i[o];if(typeof r!="string"&&(r.customLayout||r.headerCustomLayout||r.customRender||r.headerCustomRender))return!0}return!1}changeRecordOrder(e,t){}getLayoutColumnTree(){return this.internalProps.layoutMap.getLayoutColumnTree()}getLayoutColumnTreeCount(){return this.internalProps.layoutMap.getLayoutColumnTreeCount()}getLayoutRowTree(){return this.internalProps.layoutMap.getLayoutRowTree()}getLayoutRowTreeCount(){return this.internalProps.layoutMap.getLayoutRowTreeCount()}getCellHeaderTreeNodes(e,t){return this.internalProps.layoutMap.getCellHeaderPathsWithTreeNode(e,t)}}let ro=class extends Ui{constructor(e){var t,i,o,r,n,s,l,d,a,h;e.src&&(e.image=e.src),e.shape==="circle"&&(e.cornerRadius=e.width/2);const c=Oe(e.boundsPadding),u=[(i=(t=e.marginTop)!==null&&t!==void 0?t:c?e.boundsPadding[0]:e.boundsPadding)!==null&&i!==void 0?i:0,(r=(o=e.marginRight)!==null&&o!==void 0?o:c?e.boundsPadding[1]:e.boundsPadding)!==null&&r!==void 0?r:0,(l=(n=e.marginBottom)!==null&&n!==void 0?n:c?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&l!==void 0?l:0,(h=(d=e.marginLeft)!==null&&d!==void 0?d:c?(a=e.boundsPadding[3])!==null&&a!==void 0?a:e.boundsPadding[1]:e.boundsPadding)!==null&&h!==void 0?h:0];e.boundsPadding=u,super(e)}},so=class extends qi{constructor(e){var t,i,o,r,n,s,l,d,a,h,c;e.textBaseline||(e.textBaseline="top");const u=Oe(e.boundsPadding),v=[(i=(t=e.marginTop)!==null&&t!==void 0?t:u?e.boundsPadding[0]:e.boundsPadding)!==null&&i!==void 0?i:0,(r=(o=e.marginRight)!==null&&o!==void 0?o:u?e.boundsPadding[1]:e.boundsPadding)!==null&&r!==void 0?r:0,(l=(n=e.marginBottom)!==null&&n!==void 0?n:u?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&l!==void 0?l:0,(h=(d=e.marginLeft)!==null&&d!==void 0?d:u?(a=e.boundsPadding[3])!==null&&a!==void 0?a:e.boundsPadding[1]:e.boundsPadding)!==null&&h!==void 0?h:0];e.boundsPadding=v,e.fill=(c=e.fill)!==null&&c!==void 0?c:"#000",super(e)}getSize(e){this.AABBBounds.width()}},no=class extends Gi{constructor(e){var t,i,o,r,n,s,l,d,a,h;const c=Oe(e.boundsPadding),u=[(i=(t=e.marginTop)!==null&&t!==void 0?t:c?e.boundsPadding[0]:e.boundsPadding)!==null&&i!==void 0?i:0,(r=(o=e.marginRight)!==null&&o!==void 0?o:c?e.boundsPadding[1]:e.boundsPadding)!==null&&r!==void 0?r:0,(l=(n=e.marginBottom)!==null&&n!==void 0?n:c?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&l!==void 0?l:0,(h=(d=e.marginLeft)!==null&&d!==void 0?d:c?(a=e.boundsPadding[3])!==null&&a!==void 0?a:e.boundsPadding[1]:e.boundsPadding)!==null&&h!==void 0?h:0];e.boundsPadding=u,super(e)}getSize(e){this.AABBBounds.width()}},lo=class extends Qi{constructor(e){var t,i,o,r,n,s,l,d,a,h;const c=Oe(e.boundsPadding),u=[(i=(t=e.marginTop)!==null&&t!==void 0?t:c?e.boundsPadding[0]:e.boundsPadding)!==null&&i!==void 0?i:0,(r=(o=e.marginRight)!==null&&o!==void 0?o:c?e.boundsPadding[1]:e.boundsPadding)!==null&&r!==void 0?r:0,(l=(n=e.marginBottom)!==null&&n!==void 0?n:c?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&l!==void 0?l:0,(h=(d=e.marginLeft)!==null&&d!==void 0?d:c?(a=e.boundsPadding[3])!==null&&a!==void 0?a:e.boundsPadding[1]:e.boundsPadding)!==null&&h!==void 0?h:0];e.boundsPadding=u,super(e)}};function dt(D){return D.flatMap(e=>Array.isArray(e.children)?dt(e.children):e)}function ni(D){return D.replace(/-([a-z])/g,e=>e[1].toUpperCase())}function Rt(D){const e={};for(const t in D)if(D.hasOwnProperty(t)){const i=ni(t);e[i]=D[t]}return e}function ao(D,e){return D.startsWith("on")&&Ji(e[D])}function ho(D){const e={Group:lo,Image:ro,Text:so,Tag:no,Radio:$i,CheckBox:Yi};function t(r){if(!r)return null;const{type:n,children:s}=r,l=Rt(r.props),d=(n==null?void 0:n.symbol)||(n==null?void 0:n.name),a=e[d];if(!a)return null;const h=new a(Object.assign({},l));return o(h,l),i(s).forEach(u=>{const v=t(u);v?h.add(v):u.type===Symbol.for("v-fgt")&&u.children.forEach(g=>{const m=t(g);m&&h.add(m)})}),h}function i(r){var n;return((n=r==null?void 0:r.default)===null||n===void 0?void 0:n.call(r))||r||[]}function o(r,n){Object.keys(n).forEach(s=>{if(ao(s,n)){let l;s.startsWith("on")?l=s.slice(2).toLowerCase():l=ni(s.slice(2)).toLowerCase(),r.addEventListener(l,n[s])}})}return{rootComponent:t(D)}}function uo(D){return e=>{const{table:t,row:i,col:o,rect:r}=e,n=t.getCellOriginRecord(o,i),{height:s,width:l}=r??t.getCellRect(o,i),d=D.customLayout({table:t,row:i,col:o,rect:r,record:n,height:s,width:l})[0],{rootComponent:a}=ho(d);return{rootContainer:a,renderDefault:!1}}}function li(D){const e={columns:[],columnHeaderTitle:[],rows:[],rowHeaderTitle:[],indicators:[],corner:{},tooltip:{},menu:{}},t={PivotColumnDimension:"columns",PivotColumnHeaderTitle:"columnHeaderTitle",PivotRowDimension:"rows",PivotRowHeaderTitle:"rowHeaderTitle",PivotCorner:"corner",PivotIndicator:"indicators",Tooltip:"tooltip",Menu:"menu"};return D.forEach(i=>{var o,r;i.props=Rt(i.props);const n=((o=i.type)===null||o===void 0?void 0:o.symbol)||((r=i.type)===null||r===void 0?void 0:r.name),s=t[n];s&&(Array.isArray(e[s])?i.props.hasOwnProperty("objectHandler")?e[s].push(i.props.objectHandler):e[s].push(i.props):e[s]=i.props)}),e}function co(D){const e={columns:[],tooltip:{},menu:{}},t={ListColumn:"columns",Tooltip:"tooltip",Menu:"menu"};return D.forEach(i=>{var o,r;i.props=Rt(i.props);const n=((o=i.type)===null||o===void 0?void 0:o.symbol)||((r=i.type)===null||r===void 0?void 0:r.name),s=t[n];s&&(s==="columns"&&i.children&&(i.props.customLayout=uo(i.children)),Array.isArray(e[s])?e[s].push(i.props):e[s]=i.props)}),e}const N=Object.assign(Object.assign(Object.assign({},ft.EVENT_TYPE),_t.EVENT_TYPE),wt.EVENT_TYPE),ai={onClickCell:N.CLICK_CELL,onDblClickCell:N.DBLCLICK_CELL,onMouseDownCell:N.MOUSEDOWN_CELL,onMouseUpCell:N.MOUSEUP_CELL,onSelectedCell:N.SELECTED_CELL,onKeyDown:N.KEYDOWN,onMouseEnterTable:N.MOUSEENTER_TABLE,onMouseLeaveTable:N.MOUSELEAVE_TABLE,onMouseDownTable:N.MOUSEDOWN_TABLE,onMouseMoveCell:N.MOUSEMOVE_CELL,onMouseEnterCell:N.MOUSEENTER_CELL,onMouseLeaveCell:N.MOUSELEAVE_CELL,onContextMenuCell:N.CONTEXTMENU_CELL,onResizeColumn:N.RESIZE_COLUMN,onResizeColumnEnd:N.RESIZE_COLUMN_END,onChangeHeaderPosition:N.CHANGE_HEADER_POSITION,onChangeHeaderPositionStart:N.CHANGE_HEADER_POSITION_START,onChangeHeaderPositionFail:N.CHANGE_HEADER_POSITION_FAIL,onSortClick:N.SORT_CLICK,onFreezeClick:N.FREEZE_CLICK,onScroll:N.SCROLL,onDropdownMenuClick:N.DROPDOWN_MENU_CLICK,onMouseOverChartSymbol:N.MOUSEOVER_CHART_SYMBOL,onDragSelectEnd:N.DRAG_SELECT_END,onDropdownIconClick:N.DROPDOWN_ICON_CLICK,onDropdownMenuClear:N.DROPDOWN_MENU_CLEAR,onTreeHierarchyStateChange:N.TREE_HIERARCHY_STATE_CHANGE,onShowMenu:N.SHOW_MENU,onHideMenu:N.HIDE_MENU,onIconClick:N.ICON_CLICK,onLegendItemClick:N.LEGEND_ITEM_CLICK,onLegendItemHover:N.LEGEND_ITEM_HOVER,onLegendItemUnHover:N.LEGEND_ITEM_UNHOVER,onLegendChange:N.LEGEND_CHANGE,onMouseEnterAxis:N.MOUSEENTER_AXIS,onMouseLeaveAxis:N.MOUSELEAVE_AXIS,onCheckboxStateChange:N.CHECKBOX_STATE_CHANGE,onRadioStateChange:N.RADIO_STATE_CHANGE,onAfterRender:N.AFTER_RENDER,onInitialized:N.INITIALIZED,onPivotSortClick:N.PIVOT_SORT_CLICK,onDrillMenuClick:N.DRILLMENU_CLICK,onVChartEventType:N.VCHART_EVENT_TYPE,onChangCellValue:N.CHANGE_CELL_VALUE,onMousedownFillHandle:N.MOUSEDOWN_FILL_HANDLE,onDragFillHandleEnd:N.DRAG_FILL_HANDLE_END,onDblclickFillHandle:N.DBLCLICK_FILL_HANDLE,onScrollVerticalEnd:N.SCROLL_VERTICAL_END,onScrollHorizontalEnd:N.SCROLL_HORIZONTAL_END},zt=Object.keys(ai);var Dt=ot({__name:"base-table",props:{type:{type:String,required:!1},options:{type:null,required:!1},records:{type:Array,required:!1},width:{type:[Number,String],required:!1,default:"100%"},height:{type:[Number,String],required:!1,default:"100%"},onReady:{type:Function,required:!1},onError:{type:Function,required:!1},onClickCell:{type:null,required:!1},onDblClickCell:{type:null,required:!1},onMouseDownCell:{type:null,required:!1},onMouseUpCell:{type:null,required:!1},onSelectedCell:{type:null,required:!1},onKeyDown:{type:null,required:!1},onMouseEnterTable:{type:null,required:!1},onMouseLeaveTable:{type:null,required:!1},onMouseDownTable:{type:null,required:!1},onMouseMoveCell:{type:null,required:!1},onMouseEnterCell:{type:null,required:!1},onMouseLeaveCell:{type:null,required:!1},onContextMenuCell:{type:null,required:!1},onResizeColumn:{type:null,required:!1},onResizeColumnEnd:{type:null,required:!1},onChangeHeaderPosition:{type:null,required:!1},onChangeHeaderPositionStart:{type:null,required:!1},onChangeHeaderPositionFail:{type:null,required:!1},onSortClick:{type:null,required:!1},onFreezeClick:{type:null,required:!1},onScroll:{type:null,required:!1},onDropdownMenuClick:{type:null,required:!1},onMouseOverChartSymbol:{type:null,required:!1},onDragSelectEnd:{type:null,required:!1},onDropdownIconClick:{type:null,required:!1},onDropdownMenuClear:{type:null,required:!1},onTreeHierarchyStateChange:{type:null,required:!1},onShowMenu:{type:null,required:!1},onHideMenu:{type:null,required:!1},onIconClick:{type:null,required:!1},onLegendItemClick:{type:null,required:!1},onLegendItemHover:{type:null,required:!1},onLegendItemUnHover:{type:null,required:!1},onLegendChange:{type:null,required:!1},onMouseEnterAxis:{type:null,required:!1},onMouseLeaveAxis:{type:null,required:!1},onCheckboxStateChange:{type:null,required:!1},onRadioStateChange:{type:null,required:!1},onAfterRender:{type:null,required:!1},onInitialized:{type:null,required:!1},onPivotSortClick:{type:null,required:!1},onDrillMenuClick:{type:null,required:!1},onVChartEventType:{type:null,required:!1},onChangeCellValue:{type:null,required:!1},onMousedownFillHandle:{type:null,required:!1},onDragFillHandleEnd:{type:null,required:!1},onDblclickFillHandle:{type:null,required:!1},onScrollVerticalEnd:{type:null,required:!1},onScrollHorizontalEnd:{type:null,required:!1}},emits:zt,setup(D,{expose:e,emit:t}){const i=D,o=Re(null),r=Pt(null);e({vTableInstance:r});const n=De(()=>typeof i.width=="number"?`${i.width}px`:i.width),s=De(()=>typeof i.height=="number"?`${i.height}px`:i.height),l=t,d=u=>{zt.forEach(v=>{const g=m=>{l(v,m)};u.on(ai[v],g)})},a=(u,v)=>{r.value=new u(o.value,v)},h=()=>{var u,v;if(!o.value)return;r.value&&r.value.release();const g=()=>i.records!==void 0&&i.records!==null&&i.records.length>0?i.records:i.options.records;try{switch(i.type){case"list":a(ft,Object.assign(Object.assign({},i.options),{records:g()}));break;case"pivot":a(_t,Object.assign(Object.assign({},i.options),{records:g()}));break;case"chart":a(wt,Object.assign(Object.assign({},i.options),{records:g()}));break}d(r.value),(u=i.onReady)===null||u===void 0||u.call(i,r.value,!0)}catch(m){(v=i.onError)===null||v===void 0||v.call(i,m)}},c=u=>{var v;if(r.value)try{switch(i.type){case"list":r.value instanceof ft&&r.value.updateOption(u);break;case"pivot":r.value instanceof _t&&r.value.updateOption(u);break;case"chart":r.value instanceof wt&&r.value.updateOption(u);break}}catch(g){(v=i.onError)===null||v===void 0||v.call(i,g)}};return jt(h),pi(()=>{var u;return(u=r.value)===null||u===void 0?void 0:u.release()}),Ft(()=>i.options,u=>{r.value?c(u):h()}),Ft(()=>i.records,(u,v)=>{r.value?c(Object.assign(Object.assign({},i.options),{records:u})):h()},{deep:!0}),(u,v)=>(Ke(),Ne("div",{ref_key:"vTableContainer",ref:o,style:tt([{width:n.value,height:s.value},{position:"relative"}])},null,4))}}),pt=ot({__name:"list-table",props:{options:{type:Object,required:!0},records:{type:Array,required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1}},setup(D,{expose:e}){const t=D,i=Re(null),o=St(),r=De(()=>{var n;const s=dt(((n=o.default)===null||n===void 0?void 0:n.call(o))||[]),l=co(s);return Object.assign(Object.assign({},t.options),{columns:l.columns.length?l.columns:t.options.columns,tooltip:l.tooltip||t.options.tooltip,menu:l.menu||t.options.menu})});return e({vTableInstance:De(()=>{var n;return((n=i.value)===null||n===void 0?void 0:n.vTableInstance)||null})}),(n,s)=>(Ke(),Ne(Ye,null,[L(Dt,bt({type:"list",options:r.value,records:n.records,width:n.width,height:n.height,ref_key:"baseTableRef",ref:i},n.$attrs),null,16,["options","records","width","height"]),It(n.$slots,"default")],64))}}),vo=ot({__name:"pivot-table",props:{options:{type:Object,required:!0},records:{type:Array,required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1}},setup(D,{expose:e}){const t=D,i=Pt(null),o=St(),r=De(()=>{var n;const s=dt(((n=o.default)===null||n===void 0?void 0:n.call(o))||[]),l=li(s);return Object.assign(Object.assign({},t.options),{columns:l.columns.length?l.columns:t.options.columns,columnHeaderTitle:l.columnHeaderTitle.length?l.columnHeaderTitle:t.options.columnHeaderTitle,rows:l.rows.length?l.rows:t.options.rows,rowHeaderTitle:l.rowHeaderTitle.length?l.rowHeaderTitle:t.options.rowHeaderTitle,indicators:l.indicators.length?l.indicators:t.options.indicators,corner:t.options.corner||l.corner,tooltip:t.options.tooltip||l.tooltip,menu:t.options.menu||l.menu})});return e({vTableInstance:De(()=>{var n;return((n=i.value)===null||n===void 0?void 0:n.vTableInstance)||null})}),(n,s)=>(Ke(),Ne(Ye,null,[L(Dt,bt({type:"pivot",options:r.value,records:n.records,width:n.width,height:n.height,ref_key:"baseTableRef",ref:i},n.$attrs),null,16,["options","records","width","height"]),It(n.$slots,"default")],64))}}),go=ot({__name:"pivot-chart",props:{options:{type:Object,required:!0},records:{type:Array,required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1}},setup(D,{expose:e}){const t=D,i=Pt(null),o=St(),r=De(()=>{var n;const s=dt(((n=o.default)===null||n===void 0?void 0:n.call(o))||[]),l=li(s);return Object.assign(Object.assign({},t.options),{columns:l.columns.length?l.columns:t.options.columns,columnHeaderTitle:l.columnHeaderTitle.length?l.columnHeaderTitle:t.options.columnHeaderTitle,rows:l.rows.length?l.rows:t.options.rows,rowHeaderTitle:l.rowHeaderTitle.length?l.rowHeaderTitle:t.options.rowHeaderTitle,indicators:l.indicators.length?l.indicators:t.options.indicators,corner:t.options.corner||l.corner,tooltip:t.options.tooltip||l.tooltip,menu:t.options.menu||l.menu})});return e({vTableInstance:De(()=>{var n;return((n=i.value)===null||n===void 0?void 0:n.vTableInstance)||null})}),(n,s)=>(Ke(),Ne(Ye,null,[L(Dt,bt({type:"chart",options:r.value,records:n.records,width:n.width,height:n.height,ref_key:"baseTableRef",ref:i},n.$attrs),null,16,["options","records","width","height"]),It(n.$slots,"default")],64))}});const Co=(D,e)=>{Xi(D,e)};function Z(D){return null}Z.symbol="ListColumn";function di(D){return null}di.symbol="PivotColumnDimension";function hi(D){return null}hi.symbol="PivotRowDimension";function ui(D){return null}ui.symbol="PivotIndicator";function ci(D){return null}ci.symbol="PivotCorner";function vi(D){return null}vi.symbol="Menu";function $e(){return null}$e.symbol="Group";function Ht(){return null}Ht.symbol="Image";function Tt(){return null}Tt.symbol="Text";function gi(D){return null}gi.symbol="Tag";const kt=[{"Row ID":"7981","Order ID":"CA-2015-103800","Order Date":"2015/1/3","Ship Date":"2015/1/7","Ship Mode":"Standard Class","Customer ID":"DP-13000","Customer Name":"Darren Powers",Segment:"Consumer",Country:"United States",City:"Houston",State:"Texas","Postal Code":"77095",Region:"Central","Product ID":"OFF-PA-10000174",Category:"Office Supplies","Sub-Category":"Paper","Product Name":'Message Book, Wirebound, Four 5 1/2" X 4" Forms/Pg., 200 Dupl. Sets/Book',Sales:"16.448",Quantity:"2",Discount:"0.2",Profit:"5.5512"},{"Row ID":"740","Order ID":"CA-2015-112326","Order Date":"2015/1/4","Ship Date":"2015/1/8","Ship Mode":"Standard Class","Customer ID":"PO-19195","Customer Name":"Phillina Ober",Segment:"Home Office",Country:"United States",City:"Naperville",State:"Illinois","Postal Code":"60540",Region:"Central","Product ID":"OFF-LA-10003223",Category:"Office Supplies","Sub-Category":"Labels","Product Name":"Avery 508",Sales:"11.784",Quantity:"3",Discount:"0.2",Profit:"4.2717"},{"Row ID":"741","Order ID":"CA-2015-112326","Order Date":"2015/1/4","Ship Date":"2015/1/8","Ship Mode":"Standard Class","Customer ID":"PO-19195","Customer Name":"Phillina Ober",Segment:"Home Office",Country:"United States",City:"Naperville",State:"Illinois","Postal Code":"60540",Region:"Central","Product ID":"OFF-ST-10002743",Category:"Office Supplies","Sub-Category":"Storage","Product Name":"SAFCO Boltless Steel Shelving",Sales:"272.736",Quantity:"3",Discount:"0.2",Profit:"-64.7748"},{"Row ID":"742","Order ID":"CA-2015-112326","Order Date":"2015/1/4","Ship Date":"2015/1/8","Ship Mode":"Standard Class","Customer ID":"PO-19195","Customer Name":"Phillina Ober",Segment:"Home Office",Country:"United States",City:"Naperville",State:"Illinois","Postal Code":"60540",Region:"Central","Product ID":"OFF-BI-10004094",Category:"Office Supplies","Sub-Category":"Binders","Product Name":"GBC Standard Plastic Binding Systems Combs",Sales:"3.54",Quantity:"2",Discount:"0.8",Profit:"-5.487"},{"Row ID":"1760","Order ID":"CA-2015-141817","Order Date":"2015/1/5","Ship Date":"2015/1/12","Ship Mode":"Standard Class","Customer ID":"MB-18085","Customer Name":"Mick Brown",Segment:"Consumer",Country:"United States",City:"Philadelphia",State:"Pennsylvania","Postal Code":"19143",Region:"East","Product ID":"OFF-AR-10003478",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Avery Hi-Liter EverBold Pen Style Fluorescent Highlighters, 4/Pack",Sales:"19.536",Quantity:"3",Discount:"0.2",Profit:"4.884"},{"Row ID":"5328","Order ID":"CA-2015-130813","Order Date":"2015/1/6","Ship Date":"2015/1/8","Ship Mode":"Second Class","Customer ID":"LS-17230","Customer Name":"Lycoris Saunders",Segment:"Consumer",Country:"United States",City:"Los Angeles",State:"California","Postal Code":"90049",Region:"West","Product ID":"OFF-PA-10002005",Category:"Office Supplies","Sub-Category":"Paper","Product Name":"Xerox 225",Sales:"19.44",Quantity:"3",Discount:"0",Profit:"9.3312"},{"Row ID":"7181","Order ID":"CA-2015-106054","Order Date":"2015/1/6","Ship Date":"2015/1/7","Ship Mode":"First Class","Customer ID":"JO-15145","Customer Name":"Jack O'Briant",Segment:"Corporate",Country:"United States",City:"Athens",State:"Georgia","Postal Code":"30605",Region:"South","Product ID":"OFF-AR-10002399",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Dixon Prang Watercolor Pencils, 10-Color Set with Brush",Sales:"12.78",Quantity:"3",Discount:"0",Profit:"5.2398"},{"Row ID":"7475","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"FUR-CH-10004063",Category:"Furniture","Sub-Category":"Chairs","Product Name":"Global Deluxe High-Back Manager's Chair",Sales:"2573.82",Quantity:"9",Discount:"0",Profit:"746.4078"},{"Row ID":"7476","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-BI-10004632",Category:"Office Supplies","Sub-Category":"Binders","Product Name":"Ibico Hi-Tech Manual Binding System",Sales:"609.98",Quantity:"2",Discount:"0",Profit:"274.491"},{"Row ID":"7477","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-AR-10001662",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Rogers Handheld Barrel Pencil Sharpener",Sales:"5.48",Quantity:"2",Discount:"0",Profit:"1.4796"},{"Row ID":"7478","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"TEC-PH-10004977",Category:"Technology","Sub-Category":"Phones","Product Name":"GE 30524EE4",Sales:"391.98",Quantity:"2",Discount:"0",Profit:"113.6742"},{"Row ID":"7479","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"TEC-PH-10004539",Category:"Technology","Sub-Category":"Phones","Product Name":"Wireless Extenders zBoost YX545 SOHO Signal Booster",Sales:"755.96",Quantity:"4",Discount:"0",Profit:"204.1092"},{"Row ID":"7480","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-FA-10001883",Category:"Office Supplies","Sub-Category":"Fasteners","Product Name":"Alliance Super-Size Bands, Assorted Sizes",Sales:"31.12",Quantity:"4",Discount:"0",Profit:"0.3112"},{"Row ID":"7481","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-PA-10000955",Category:"Office Supplies","Sub-Category":"Paper","Product Name":"Southworth 25% Cotton Granite Paper & Envelopes",Sales:"6.54",Quantity:"1",Discount:"0",Profit:"3.0084"},{"Row ID":"7661","Order ID":"CA-2015-105417","Order Date":"2015/1/7","Ship Date":"2015/1/12","Ship Mode":"Standard Class","Customer ID":"VS-21820","Customer Name":"Vivek Sundaresam",Segment:"Consumer",Country:"United States",City:"Huntsville",State:"Texas","Postal Code":"77340",Region:"Central","Product ID":"FUR-FU-10004864",Category:"Furniture","Sub-Category":"Furnishings","Product Name":'Howard Miller 14-1/2" Diameter Chrome Round Wall Clock',Sales:"76.728",Quantity:"3",Discount:"0.6",Profit:"-53.7096"},{"Row ID":"7662","Order ID":"CA-2015-105417","Order Date":"2015/1/7","Ship Date":"2015/1/12","Ship Mode":"Standard Class","Customer ID":"VS-21820","Customer Name":"Vivek Sundaresam",Segment:"Consumer",Country:"United States",City:"Huntsville",State:"Texas","Postal Code":"77340",Region:"Central","Product ID":"OFF-BI-10003708",Category:"Office Supplies","Sub-Category":"Binders","Product Name":'Acco Four Pocket Poly Ring Binder with Label Holder, Smoke, 1"',Sales:"10.43",Quantity:"7",Discount:"0.8",Profit:"-18.2525"},{"Row ID":"593","Order ID":"CA-2015-135405","Order Date":"2015/1/9","Ship Date":"2015/1/13","Ship Mode":"Standard Class","Customer ID":"MS-17830","Customer Name":"Melanie Seite",Segment:"Consumer",Country:"United States",City:"Laredo",State:"Texas","Postal Code":"78041",Region:"Central","Product ID":"OFF-AR-10004078",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Newell 312",Sales:"9.344",Quantity:"2",Discount:"0.2",Profit:"1.168"},{"Row ID":"594","Order ID":"CA-2015-135405","Order Date":"2015/1/9","Ship Date":"2015/1/13","Ship Mode":"Standard Class","Customer ID":"MS-17830","Customer Name":"Melanie Seite",Segment:"Consumer",Country:"United States",City:"Laredo",State:"Texas","Postal Code":"78041",Region:"Central","Product ID":"TEC-AC-10001266",Category:"Technology","Sub-Category":"Accessories","Product Name":"Memorex Micro Travel Drive 8 GB",Sales:"31.2",Quantity:"3",Discount:"0.2",Profit:"9.75"},{"Row ID":"866","Order ID":"CA-2015-149020","Order Date":"2015/1/10","Ship Date":"2015/1/15","Ship Mode":"Standard Class","Customer ID":"AJ-10780","Customer Name":"Anthony Jacobs",Segment:"Corporate",Country:"United States",City:"Springfield",State:"Virginia","Postal Code":"22153",Region:"South","Product ID":"OFF-LA-10004272",Category:"Office Supplies","Sub-Category":"Labels","Product Name":"Avery 482",Sales:"2.89",Quantity:"1",Discount:"0",Profit:"1.3583"},{"Row ID":"867","Order ID":"CA-2015-149020","Order Date":"2015/1/10","Ship Date":"2015/1/15","Ship Mode":"Standard Class","Customer ID":"AJ-10780","Customer Name":"Anthony Jacobs",Segment:"Corporate",Country:"United States",City:"Springfield",State:"Virginia","Postal Code":"22153",Region:"South","Product ID":"FUR-FU-10000965",Category:"Furniture","Sub-Category":"Furnishings","Product Name":'Howard Miller 11-1/2" Diameter Ridgewood Wall Clock',Sales:"51.94",Quantity:"1",Discount:"0",Profit:"21.2954"},{"Row ID":"717","Order ID":"CA-2015-130092","Order Date":"2015/1/11","Ship Date":"2015/1/14","Ship Mode":"First Class","Customer ID":"SV-20365","Customer Name":"Seth Vernon",Segment:"Consumer",Country:"United States",City:"Dover",State:"Delaware","Postal Code":"19901",Region:"East","Product ID":"FUR-FU-10000010",Category:"Furniture","Sub-Category":"Furnishings","Product Name":"DAX Value U-Channel Document Frames, Easel Back",Sales:"9.94",Quantity:"2",Discount:"0",Profit:"3.0814"},{"Row ID":"764","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-EN-10001990",Category:"Office Supplies","Sub-Category":"Envelopes","Product Name":"Staple envelope",Sales:"11.36",Quantity:"2",Discount:"0",Profit:"5.3392"},{"Row ID":"765","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-EN-10001532",Category:"Office Supplies","Sub-Category":"Envelopes","Product Name":"Brown Kraft Recycled Envelopes",Sales:"50.94",Quantity:"3",Discount:"0",Profit:"25.47"},{"Row ID":"766","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"TEC-AC-10003174",Category:"Technology","Sub-Category":"Accessories","Product Name":"Plantronics S12 Corded Telephone Headset System",Sales:"646.74",Quantity:"6",Discount:"0",Profit:"258.696"},{"Row ID":"767","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-BI-10004187",Category:"Office Supplies","Sub-Category":"Binders","Product Name":"3-ring staple pack",Sales:"5.64",Quantity:"3",Discount:"0",Profit:"2.7072"},{"Row ID":"768","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-ST-10000025",Category:"Office Supplies","Sub-Category":"Storage","Product Name":"Fellowes Stor/Drawer Steel Plus Storage Drawers",Sales:"572.58",Quantity:"6",Discount:"0",Profit:"34.3548"},{"Row ID":"2979","Order ID":"CA-2015-109232","Order Date":"2015/1/13","Ship Date":"2015/1/16","Ship Mode":"Second Class","Customer ID":"ND-18370","Customer Name":"Natalie DeCherney",Segment:"Consumer",Country:"United States",City:"Mount Pleasant",State:"South Carolina","Postal Code":"29464",Region:"South","Product ID":"FUR-CH-10000422",Category:"Furniture","Sub-Category":"Chairs","Product Name":"Global Highback Leather Tilter in Burgundy",Sales:"545.94",Quantity:"6",Discount:"0",Profit:"87.3504"},{"Row ID":"4938","Order ID":"CA-2015-157147","Order Date":"2015/1/13","Ship Date":"2015/1/18","Ship Mode":"Standard Class","Customer ID":"BD-11605","Customer Name":"Brian Dahlen",Segment:"Consumer",Country:"United States",City:"San Francisco",State:"California","Postal Code":"94109",Region:"West","Product ID":"OFF-ST-10000078",Category:"Office Supplies","Sub-Category":"Storage","Product Name":"Tennsco 6- and 18-Compartment Lockers",Sales:"1325.85",Quantity:"5",Discount:"0",Profit:"238.653"},{"Row ID":"4939","Order ID":"CA-2015-157147","Order Date":"2015/1/13","Ship Date":"2015/1/18","Ship Mode":"Standard Class","Customer ID":"BD-11605","Customer Name":"Brian Dahlen",Segment:"Consumer",Country:"United States",City:"San Francisco",State:"California","Postal Code":"94109",Region:"West","Product ID":"FUR-BO-10003034",Category:"Furniture","Sub-Category":"Bookcases","Product Name":"O'Sullivan Elevations Bookcase, Cherry Finish",Sales:"333.999",Quantity:"3",Discount:"0.15",Profit:"3.9294"},{"Row ID":"4940","Order ID":"CA-2015-157147","Order Date":"2015/1/13","Ship Date":"2015/1/18","Ship Mode":"Standard Class","Customer ID":"BD-11605","Customer Name":"Brian Dahlen",Segment:"Consumer",Country:"United States",City:"San Francisco",State:"California","Postal Code":"94109",Region:"West","Product ID":"OFF-AR-10003514",Category:"Office Supplies","Sub-Category":"Art","Product Name":"4009 Highlighters by Sanford",Sales:"19.9",Quantity:"5",Discount:"0",Profit:"6.567"}],yo=[{bloggerId:1,bloggerName:"Virtual Anchor Xiaohua",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/flower.jpg",introduction:"Hi everyone, I am Xiaohua, the virtual host. I am a little fairy who likes games, animation and food. I hope to share happy moments with you through live broadcast.",fansCount:400,worksCount:10,viewCount:5,city:"Dream City",tags:["game","anime","food"]},{bloggerId:2,bloggerName:"Virtual anchor little wolf",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/wolf.jpg",introduction:"Hello everyone, I am the virtual anchor Little Wolf. I like music, travel and photography, and I hope to explore the beauty of the world with you through live broadcast.",fansCount:800,worksCount:20,viewCount:15,city:"City of Music",tags:["music","travel","photography"]},{bloggerId:3,bloggerName:"Virtual anchor bunny",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/rabbit.jpg",introduction:"Hello everyone, I am the virtual anchor Xiaotu. I like painting, handicrafts and beauty makeup. I hope to share creativity and fashion with you through live broadcast.",fansCount:600,worksCount:15,viewCount:10,city:"City of Art",tags:["painting","handmade","beauty makeup"]},{bloggerId:4,bloggerName:"Virtual anchor kitten",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/cat.jpg",introduction:"Hello everyone, I am the virtual host Kitty. I am a lazy cat who likes dancing, fitness and cooking. I hope to live a healthy and happy life with everyone through the live broadcast.",fansCount:1e3,worksCount:30,viewCount:20,city:"Health City",tags:["dance","fitness","cooking"]},{bloggerId:5,bloggerName:"Virtual anchor Bear",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/bear.jpg",introduction:"Hello everyone, I am the virtual host Xiaoxiong. A little wise man who likes movies, reading and philosophy, I hope to explore the meaning of life with you through live broadcast.",fansCount:1200,worksCount:25,viewCount:18,city:"City of Wisdom",tags:["Movie","Literature"]},{bloggerId:6,bloggerName:"Virtual anchor bird",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/bird.jpeg",introduction:"Hello everyone, I am the virtual anchor Xiaoniao. I like singing, acting and variety shows. I hope to be happy with everyone through the live broadcast.",fansCount:900,worksCount:12,viewCount:8,city:"Happy City",tags:["music","performance","variety"]}],po=[{dimensionKey:"Region",title:"Region",headerStyle:{textStick:!0}},"Category"],mo=[{dimensionKey:"Order Year",title:"Order Year",headerStyle:{textStick:!0}},"Ship Mode"],fo=[{indicatorKey:"Quantity",title:"Quantity",width:"auto",cellType:"chart",chartModule:"vchart",chartSpec:{stack:!0,type:"bar",data:{id:"data",fields:{"Sub-Category":{sortIndex:0,domain:["Chairs","Tables","Bookcases","Furnishings","Binders","Art","Storage","Appliances","Envelopes","Fasteners","Paper","Labels","Supplies","Accessories","Phones","Copiers","Machines"]},"Segment-Indicator":{sortIndex:1,domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"]}}},xField:["Sub-Category"],yField:"Quantity",seriesField:"Segment-Indicator",axes:[{orient:"left",visible:!0,label:{visible:!0}},{orient:"bottom",visible:!0}],bar:{state:{selected:{fill:"yellow"},selected_reverse:{opacity:.2}}},scales:[{id:"color",type:"ordinal",domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"],range:["#2E62F1","#4DC36A","#FF8406","#FFCC00","#4F44CF","#5AC8FA","#003A8C","#B08AE2","#FF6341","#98DD62","#07A199","#87DBDD"]}]},style:{padding:1}},{indicatorKey:"Sales",title:"Sales & Profit",cellType:"chart",chartModule:"vchart",chartSpec:{type:"common",series:[{type:"bar",data:{id:"data1",fields:{"Sub-Category":{sortIndex:0,domain:["Chairs","Tables","Bookcases","Furnishings","Binders","Art","Storage","Appliances","Envelopes","Fasteners","Paper","Labels","Supplies","Accessories","Phones","Copiers","Machines"]},"Segment-Indicator":{sortIndex:1,domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"]}}},stack:!0,xField:["Sub-Category"],yField:"Sales",seriesField:"Segment-Indicator",bar:{state:{selected:{fill:"yellow"},selected_reverse:{opacity:.2}}}},{type:"line",data:{id:"data2",fields:{"Sub-Category":{sortIndex:0,domain:["Chairs","Tables","Bookcases","Furnishings","Binders","Art","Storage","Appliances","Envelopes","Fasteners","Paper","Labels","Supplies","Phones","Accessories","Machines","Copiers"]},"Segment-Indicator":{sortIndex:1,domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"]}}},stack:!1,xField:["Sub-Category"],yField:"Profit",seriesField:"Segment-Indicator",line:{state:{selected:{lineWidth:3},selected_reverse:{lineWidth:1}}},point:{state:{selected:{fill:"yellow"},selected_reverse:{fill:"#ddd"}}}}],scales:[{id:"color",type:"ordinal",domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"],range:["#2E62F1","#4DC36A","#FF8406","#FFCC00","#4F44CF","#5AC8FA","#003A8C","#B08AE2","#FF6341","#98DD62","#07A199","#87DBDD"]}]},style:{padding:1}}],_o={class:"h-full"},Lo=ot({name:"plugin_tables_vtable",__name:"index",setup(D){Co("vchart",yi);const e=["#3370ff","#34c724","#ff9f1a","#ff4050","#1f2329"],t=mi(),i=Re(null),o=De(()=>({theme:t.darkMode?Ze:et})),r=Re(kt),n=Re(null),s=De(()=>({groupBy:["Category","Sub-Category"],theme:(t.darkMode?Ze:et).extends({groupTitleStyle:{fontWeight:"bold",bgColor:I=>{const{col:w,row:C,table:T}=I,H=T.getGroupTitleLevel(w,C);return H!==void 0?e[H%e.length]:"white"}}})})),l=Re(kt),d=Re(null),a=De(()=>({tooltip:{isShowOverflowTextTooltip:!0},dataConfig:{sortRules:[{sortField:"Category",sortBy:["Office Supplies","Technology","Furniture"]}]},widthMode:"standard",theme:t.darkMode?Ze:et,emptyTip:{text:"no data records"}})),h=Re([{indicatorKey:"Quantity",title:"Quantity",width:"auto",showSort:!1,headerStyle:{fontWeight:"normal"},style:{padding:[16,28,16,28],color(p){return p.dataValue>=0?"black":"red"}}},{indicatorKey:"Sales",title:"Sales",width:"auto",showSort:!1,headerStyle:{fontWeight:"normal"},format:p=>`$${Number(p).toFixed(2)}`,style:{padding:[16,28,16,28],color(p){return p.dataValue>=0?"black":"red"}}},{indicatorKey:"Profit",title:"Profit",width:"auto",showSort:!1,headerStyle:{fontWeight:"normal"},format:p=>`$${Number(p).toFixed(2)}`,style:{padding:[16,28,16,28],color(p){return p.dataValue>=0?"black":"red"}}}]),c=Re([{dimensionKey:"City",title:"City",headerStyle:{textStick:!0},width:"auto"}]),u=Re([]),v=Re(null),g=De(()=>({rows:mo,columns:po,indicators:fo,indicatorsAsCol:!1,defaultRowHeight:200,defaultHeaderRowHeight:50,defaultColWidth:280,defaultHeaderColWidth:100,indicatorTitle:"指标",autoWrapText:!0,corner:{titleOnDimension:"row",headerStyle:{autoWrapText:!0}},legends:{orient:"bottom",type:"discrete",data:[{label:"Consumer-Quantity",shape:{fill:"#2E62F1",symbolType:"circle"}},{label:"Consumer-Quantity",shape:{fill:"#4DC36A",symbolType:"square"}},{label:"Home Office-Quantity",shape:{fill:"#FF8406",symbolType:"square"}},{label:"Consumer-Sales",shape:{fill:"#FFCC00",symbolType:"square"}},{label:"Consumer-Sales",shape:{fill:"#4F44CF",symbolType:"square"}},{label:"Home Office-Sales",shape:{fill:"#5AC8FA",symbolType:"square"}},{label:"Consumer-Profit",shape:{fill:"#003A8C",symbolType:"square"}},{label:"Consumer-Profit",shape:{fill:"#B08AE2",symbolType:"square"}},{label:"Home Office-Profit",shape:{fill:"#FF6341",symbolType:"square"}}]},theme:(t.darkMode?Ze:et).extends({bodyStyle:{borderColor:"gray",borderLineWidth:[1,0,0,1]},headerStyle:{borderColor:"gray",borderLineWidth:[0,0,1,1],hover:{cellBgColor:"#CCE0FF"}},rowHeaderStyle:{borderColor:"gray",borderLineWidth:[1,1,0,0],hover:{cellBgColor:"#CCE0FF"}},cornerHeaderStyle:{borderColor:"gray",borderLineWidth:[0,1,1,0],hover:{cellBgColor:""}},cornerRightTopCellStyle:{borderColor:"gray",borderLineWidth:[0,0,1,1],hover:{cellBgColor:""}},cornerLeftBottomCellStyle:{borderColor:"gray",borderLineWidth:[1,1,0,0],hover:{cellBgColor:""}},cornerRightBottomCellStyle:{borderColor:"gray",borderLineWidth:[1,0,0,1],hover:{cellBgColor:""}},rightFrozenStyle:{borderColor:"gray",borderLineWidth:[1,0,1,1],hover:{cellBgColor:""}},bottomFrozenStyle:{borderColor:"gray",borderLineWidth:[1,1,0,1],hover:{cellBgColor:""}},selectionStyle:{cellBgColor:"",cellBorderColor:""},frameStyle:{borderLineWidth:0}}),emptyTip:{text:"no data records"}})),m=Re({}),y=p=>{var I;(I=v==null?void 0:v.value)==null||I.vTableInstance.updateFilterRules([{filterKey:"Segment-Indicator",filteredValues:p.value}])},_=Re(null),S=De(()=>({defaultRowHeight:80,theme:t.darkMode?Ze:et})),P=Re(yo),f=Re({fontFamily:"Arial",fontSize:12,fontWeight:"bold"});return jt(()=>{fetch("https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/North_American_Superstore_Pivot_data.json").then(p=>p.json()).then(p=>{u.value=p}),fetch("https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/North_American_Superstore_Pivot_Chart_data.json").then(p=>p.json()).then(p=>{m.value=p})}),(p,I)=>{const w=fi,C=Ci,T=Zi;return Ke(),Ne("div",_o,[L(T,{vertical:"",size:16},{default:fe(()=>[L(w,{title:"List Table",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:fe(()=>[L(B(pt),{ref_key:"listTableRef",ref:i,options:o.value,records:r.value,height:"400px"},{default:fe(()=>[L(B(Z),{field:"Order ID",title:"Order ID",width:"auto"}),L(B(Z),{field:"Customer ID",title:"Customer ID",width:"auto"}),L(B(Z),{field:"Product Name",title:"Product Name",width:"auto"}),L(B(Z),{field:"Category",title:"Category",width:"auto"}),L(B(Z),{field:"Sub-Category",title:"Sub-Category",width:"auto"}),L(B(Z),{field:"Region",title:"Region",width:"auto"}),L(B(Z),{field:"City",title:"City",width:"auto"}),L(B(Z),{field:"Order Date",title:"Order Date",width:"auto"}),L(B(Z),{field:"Quantity",title:"Quantity",width:"auto"}),L(B(Z),{field:"Sales",title:"Sales",width:"auto"}),L(B(Z),{field:"Profit",title:"Profit",width:"auto"})]),_:1},8,["options","records"])]),_:1}),L(w,{title:"Group Table",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:fe(()=>[L(B(pt),{ref_key:"groupTableRef",ref:n,options:s.value,records:l.value,height:"400px"},{default:fe(()=>[L(B(Z),{field:"Order ID",title:"Order ID",width:"auto"}),L(B(Z),{field:"Customer ID",title:"Customer ID",width:"auto"}),L(B(Z),{field:"Product Name",title:"Product Name",width:"auto"}),L(B(Z),{field:"Category",title:"Category",width:"auto"}),L(B(Z),{field:"Sub-Category",title:"Sub-Category",width:"auto"}),L(B(Z),{field:"Region",title:"Region",width:"auto"}),L(B(Z),{field:"City",title:"City",width:"auto"}),L(B(Z),{field:"Order Date",title:"Order Date",width:"auto"}),L(B(Z),{field:"Quantity",title:"Quantity",width:"auto"}),L(B(Z),{field:"Sales",title:"Sales",width:"auto"}),L(B(Z),{field:"Profit",title:"Profit",width:"auto"})]),_:1},8,["options","records"])]),_:1}),L(w,{title:"Pivot Table",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:fe(()=>[L(B(vo),{ref_key:"pivotTableRef",ref:d,options:a.value,records:u.value,height:"400px"},{default:fe(()=>[L(B(di),{title:"Category","dimension-key":"Category","header-style":{textStick:!0},width:"auto"}),(Ke(!0),Ne(Ye,null,ht(c.value,(H,b)=>(Ke(),ut(B(hi),{key:b,"dimension-key":H.dimensionKey,title:H.title,"header-style":H.headerStyle,width:H.width},null,8,["dimension-key","title","header-style","width"]))),128)),(Ke(!0),Ne(Ye,null,ht(h.value,(H,b)=>(Ke(),ut(B(ui),{key:b,"indicator-key":H.indicatorKey,title:H.title,width:H.width,"show-sort":H.showSort,"header-style":H.headerStyle,format:H.format,style:tt(H.style)},null,8,["indicator-key","title","width","show-sort","header-style","format","style"]))),128)),L(B(ci),{"title-on-dimension":"row"}),L(B(vi),{"menu-type":"html","context-menu-items":["copy","paste","delete","..."]})]),_:1},8,["options","records"])]),_:1}),L(w,{title:"Pivot Chart",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:fe(()=>[L(B(go),{ref_key:"pivotChartRef",ref:v,options:g.value,records:m.value,height:"800px",onOnLegendItemClick:y},null,8,["options","records"])]),_:1}),L(w,{title:"Custom Component",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:fe(()=>[L(B(pt),{ref_key:"customLayoutListTableRef",ref:_,options:S.value,records:P.value,height:"400px"},{default:fe(()=>[L(B(Z),{field:"bloggerId",title:"Order Number",width:"100"}),L(B(Z),{field:"bloggerName",title:"Anchor Nickname",width:330},{customLayout:fe(({record:H,height:b,width:x})=>[L(B($e),{height:b,width:x,display:"flex","flex-direction":"row","flex-wrap":"nowrap"},{default:fe(()=>[L(B($e),{height:b,width:60,display:"flex","flex-direction":"column","align-items":"center","justify-content":"space-around",fill:"red",opacity:.1},{default:fe(()=>[L(B(Ht),{id:"icon0",width:50,height:50,image:H.bloggerAvatar,"corner-radius":25},null,8,["image"])]),_:2},1032,["height"]),L(B($e),{height:b,width:x-60,display:"flex","flex-direction":"column","flex-wrap":"nowrap"},{default:fe(()=>[L(B($e),{height:b/2,width:x-60,display:"flex","flex-wrap":"wrap","align-items":"center",fill:"orange",opacity:.1},{default:fe(()=>[L(B(Tt),{text:H.bloggerName,"font-size":13,"font-family":"sans-serif",fill:"black","bounds-padding":[0,0,0,10]},null,8,["text"]),L(B(Ht),{id:"location",image:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/location.svg",width:15,height:15,"bounds-padding":[0,0,0,10],cursor:"pointer"}),L(B(Tt),{text:H.city,"font-size":11,"font-family":"sans-serif",fill:"#6f7070"},null,8,["text"])]),_:2},1032,["height","width"]),L(B($e),{height:b/2,width:x-60,display:"flex","align-items":"center",fill:"yellow",opacity:.1},{default:fe(()=>[(Ke(!0),Ne(Ye,null,ht(H==null?void 0:H.tags,A=>(Ke(),ut(B(gi),{key:A,text:A,"text-style":{fontSize:10,fontFamily:"sans-serif",fill:"rgb(51, 101, 238)"},panel:{visible:!0,fill:"#f4f4f2",cornerRadius:5},space:5,"bounds-padding":[0,0,0,5]},null,8,["text"]))),128))]),_:2},1032,["height","width"])]),_:2},1032,["height","width"])]),_:2},1032,["height","width"])]),_:1}),L(B(Z),{field:"fansCount",title:"Fans Count",width:"120","field-format":H=>H.fansCount+"w",style:tt(f.value)},null,8,["field-format","style"]),L(B(Z),{field:"worksCount",title:"Works Count",style:tt(f.value),width:"135"},null,8,["style"]),L(B(Z),{field:"viewCount",title:"View Count",width:"120","field-format":H=>H.viewCount+"w",style:tt(f.value)},null,8,["field-format","style"])]),_:1},8,["options","records"])]),_:1}),L(w,{bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:fe(()=>[L(C,{label:"More VTable Demos: ",link:"https://www.visactor.com/vtable/example"})]),_:1})]),_:1})])}}});export{Lo as default};
