import{d as kt,av as qt,cz as $t,a as fe,$ as l,r as m,p as ie,cA as Ct,a2 as o,cx as Z,cs as Fe,K as h,cB as St,B as X,_ as P,ak as rs,i as Pt,as as It,o as _,b as C,f as u,w as p,e as t,h as r,J as zt,I as Dt,al as le,g as v,t as c,b1 as Ut,bw as Tt,N as T,H as Ot,c as Y,ae as $,af as Nt,bT as G,cw as Lt,cy as Rt}from"./index-D2aSDdb8.js";import{e as jt,p as Mt,g as Vt,r as Et,h as At,i as Ht,a as Ft,c as Bt,j as Wt,k as Jt}from"./session-DruRzhnc.js";import{N as ge}from"./Space-DZKXzBSy.js";import{N as us}from"./DatePicker-Dw6E7xlv.js";import{N as Qt}from"./DataTable-Bn6ddARk.js";import{N as I}from"./text-BaKLBtlu.js";import"./get-slot-Bk_rJcZu.js";import"./Pagination-DOgyADDE.js";const Kt={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden bg-gray-50 lt-sm:overflow-auto dark:bg-gray-900"},Gt={class:"mb-4"},Zt={class:"mb-4"},Xt={class:"advanced-search"},Yt={key:0,class:"detail-content"},ea={class:"flat-info-container"},sa={class:"info-row"},ta={class:"info-cell"},aa={class:"cell-value"},la={class:"info-cell"},ia={class:"info-cell"},na={class:"info-cell"},oa={class:"cell-value"},ra={class:"info-cell"},ua={class:"cell-value"},ca={class:"info-row"},da={key:0,class:"info-cell"},pa={key:1,class:"info-cell"},va={key:2,class:"info-cell"},fa={key:3,class:"info-cell"},ga={class:"info-cell"},ma={class:"cell-value"},_a={class:"info-row"},ya={class:"info-cell"},ba={class:"cell-value"},ha={key:0,class:"info-cell"},xa={key:1,class:"info-cell"},wa={key:2,class:"info-cell"},ka={class:"info-row"},qa={class:"info-cell"},$a={class:"cell-value"},Ca={class:"info-cell"},Sa={class:"cell-value"},Pa={class:"info-cell"},Ia={class:"cell-value"},za={class:"info-cell"},Da={class:"cell-value"},Ua={class:"info-row"},Ta={class:"info-cell"},Oa={class:"cell-value"},Na={class:"info-cell"},La={class:"cell-value"},Ra={class:"info-cell"},ja={class:"cell-value"},Ma={class:"info-cell"},Va={class:"cell-value"},Ea={class:"info-row"},Aa={class:"info-cell full-width"},Ha={class:"cell-value"},Fa={class:"info-row"},Ba={class:"info-cell"},Wa={class:"cell-value"},Ja={class:"info-cell"},Qa={class:"cell-value"},Ka={class:"info-cell"},Ga={class:"cell-value"},Za={class:"info-cell"},Xa={class:"cell-value"},Ya={class:"info-row"},el={class:"info-cell"},sl={class:"cell-value"},tl={class:"info-cell"},al={class:"cell-value"},ll={class:"info-cell"},il={class:"cell-value"},nl={class:"info-cell"},ol={class:"cell-value"},rl={class:"info-row"},ul={class:"info-cell"},cl={class:"cell-value"},dl={class:"info-cell"},pl={class:"cell-value"},vl={class:"info-cell"},fl={class:"cell-value"},gl={class:"info-cell"},ml={class:"cell-value"},_l={class:"info-row"},yl={class:"info-cell"},bl={class:"cell-value"},hl={class:"info-cell"},xl={class:"cell-value"},wl={class:"info-cell"},kl={class:"cell-value"},ql={class:"info-cell"},$l={class:"cell-value"},Cl={class:"info-row"},Sl={class:"info-cell"},Pl={class:"cell-value"},Il={class:"info-cell"},zl={class:"cell-value"},Dl={class:"info-cell"},Ul={class:"cell-value"},Tl={class:"info-cell"},Ol={class:"cell-value"},Nl={class:"info-row"},Ll={class:"info-cell wide"},Rl={class:"cell-value"},jl={class:"info-cell"},Ml={class:"cell-value"},Vl={class:"info-cell"},El={class:"info-row"},Al={class:"info-cell full-width"},Hl={class:"cell-value"},Fl={class:"info-row"},Bl={class:"info-cell full-width"},Wl={class:"cell-value"},Jl={class:"info-row"},Ql={class:"info-cell full-width"},Kl={class:"cell-value"},Gl={class:"info-row"},Zl={class:"info-cell full-width"},Xl={class:"cell-value"},Yl={key:1,class:"py-8 text-center"},ei={class:"space-y-4"},si={class:"mb-4"},ti={key:0},ai={key:1},li={key:2},ii={class:"space-y-4"},ni={class:"mb-4"},oi={key:0},ri={key:1},ui={key:2},ci={class:"space-y-4"},di={class:"mb-4"},pi={key:0},vi={key:1},fi={class:"space-y-4"},gi={class:"mb-4"},mi={key:0},_i={key:1},yi={class:"mb-4"},bi={class:"space-y-4"},hi={key:0,class:"card-simulation"},xi={class:"credit-card"},wi={class:"card-top"},ki={class:"card-brand-logo"},qi=["src","alt"],$i={class:"card-number"},Ci={class:"card-bottom"},Si={class:"card-info-item"},Pi={class:"value"},Ii={class:"card-info-item"},zi={class:"value"},Di={class:"card-info-item"},Ui={class:"value"},Ti={key:0,class:"card-info"},Oi={class:"info-grid"},Ni={class:"info-item"},Li={class:"info-value"},Ri={class:"info-item"},ji={class:"info-value"},Mi={class:"info-item"},Vi={class:"info-value"},Ei={class:"info-item"},Ai={class:"info-value"},Hi={class:"info-item"},Fi={class:"info-value"},Bi={class:"export-config"},Wi={class:"config-section"},Ji={class:"mode-description"},Qi={class:"config-section"},Ki={class:"config-section"},Gi={class:"config-section"},Zi={class:"current-filters"},Xi={class:"config-section"},Yi={class:"space-y-4"},en=kt({name:"payment_request",__name:"index",setup(sn){const be=qt(),cs=$t(),Oe=[{label:fe(()=>l("page.payment.request.status.all")),value:"all",customStatus:"",includeTrash:!1},{label:fe(()=>l("page.payment.request.status.pending")),value:"pending",customStatus:"pending",includeTrash:!1},{label:fe(()=>l("page.payment.request.status.bound")),value:"bound",customStatus:"bound",includeTrash:!1},{label:fe(()=>l("page.payment.request.status.completed")),value:"completed",customStatus:"completed",includeTrash:!1},{label:fe(()=>l("page.payment.request.status.trash")),value:"trash",customStatus:"trash",includeTrash:!0}],ee=m("all"),Ne=m(!1),b=m([]),q=ie({page:1,pageSize:15,total:0,showSizePicker:!0,pageSizes:[15,20,50,100]}),he=ie({completed:{page:1,pageSize:15},uncompleted:{page:1,pageSize:100},all:{page:1,pageSize:15}}),ne=m(null),Le=m(new Date),x=ie({page:1,size:15,status:"",is_completed:void 0,success:void 0,user_uuid:void 0,client_id:void 0,ip_address:void 0,start_date:void 0,end_date:void 0,custom_status:void 0,include_trash:!1}),g=ie({status:x.status,is_completed:"false",success:"",user_uuid:"",client_id:"",ip_address:"",start_date:null,end_date:null}),me=m(!1),xe=m(!1),Re=m(!1),y=ie({export_mode:"basic",format:"csv"}),Be=[{label:l("page.payment.request.export.modes.basic"),value:"basic",description:l("page.payment.request.export.modes.basicDescription")},{label:l("page.payment.request.export.modes.personalInfo"),value:"personal_info",description:l("page.payment.request.export.modes.personalInfoDescription")},{label:l("page.payment.request.export.modes.cardAnalysis"),value:"card_analysis",description:l("page.payment.request.export.modes.cardAnalysisDescription")},{label:l("page.payment.request.export.modes.sessionContext"),value:"session_context",description:l("page.payment.request.export.modes.sessionContextDescription")},{label:l("page.payment.request.export.modes.full"),value:"full",description:l("page.payment.request.export.modes.fullDescription")}],ds=[{label:l("page.payment.request.export.formats.csv"),value:"csv"},{label:l("page.payment.request.export.formats.json"),value:"json"}],ps=[{label:l("page.payment.request.cardTypes.all"),value:""},{label:l("page.payment.request.cardTypes.visa"),value:"visa"},{label:l("page.payment.request.cardTypes.mastercard"),value:"mastercard"},{label:l("page.payment.request.cardTypes.amex"),value:"amex"},{label:l("page.payment.request.cardTypes.unionpay"),value:"unionpay"},{label:l("page.payment.request.cardTypes.other"),value:"generic"}],oe={connected:{label:l("page.payment.request.statusLabels.connected"),type:"success"},filling_card:{label:l("page.payment.request.statusLabels.fillingCard"),type:"warning"},filling_card_holder:{label:l("page.payment.request.statusLabels.fillingCardHolder"),type:"warning"},filling_card_number:{label:l("page.payment.request.statusLabels.fillingCardNumber"),type:"warning"},filling_expiry_date:{label:l("page.payment.request.statusLabels.fillingExpiryDate"),type:"warning"},filling_cvv:{label:l("page.payment.request.statusLabels.fillingCvv"),type:"warning"},filling_personal_info:{label:l("page.payment.request.statusLabels.fillingPersonalInfo"),type:"warning"},filling_phone:{label:l("page.payment.request.statusLabels.fillingPhone"),type:"warning"},filling_zip_code:{label:l("page.payment.request.statusLabels.fillingZipCode"),type:"warning"},filling_city:{label:l("page.payment.request.statusLabels.fillingCity"),type:"warning"},filling_street_address:{label:l("page.payment.request.statusLabels.fillingStreetAddress"),type:"warning"},filling_first_name:{label:l("page.payment.request.statusLabels.fillingFirstName"),type:"warning"},filling_last_name:{label:l("page.payment.request.statusLabels.fillingLastName"),type:"warning"},filling_email:{label:l("page.payment.request.statusLabels.fillingEmail"),type:"warning"},filling_country:{label:l("page.payment.request.statusLabels.fillingCountry"),type:"warning"},filling_state:{label:l("page.payment.request.statusLabels.fillingState"),type:"warning"},filling_verification:{label:l("page.payment.request.statusLabels.fillingVerification"),type:"warning"},filling_otp:{label:l("page.payment.request.statusLabels.fillingOtp"),type:"warning"},filling_email_otp:{label:l("page.payment.request.statusLabels.fillingEmailOtp"),type:"warning"},filling_pin:{label:l("page.payment.request.statusLabels.fillingPin"),type:"warning"},filling_app_verification:{label:l("page.payment.request.statusLabels.fillingAppVerification"),type:"warning"},card_submitted:{label:l("page.payment.request.statusLabels.cardSubmitted"),type:"info"},cvv_submitted:{label:l("page.payment.request.statusLabels.cvvSubmitted"),type:"info"},verification_required:{label:l("page.payment.request.statusLabels.verificationRequired"),type:"warning"},verification_submitted:{label:l("page.payment.request.statusLabels.verificationSubmitted"),type:"info"},payment_success:{label:l("page.payment.request.statusLabels.paymentSuccess"),type:"success"},payment_failed:{label:l("page.payment.request.statusLabels.paymentFailed"),type:"error"},card_rejected:{label:l("page.payment.request.statusLabels.cardRejected"),type:"error"},disconnected:{label:l("page.payment.request.statusLabels.disconnected"),type:"default"},otp_resending:{label:"OTP重发",type:"warning"},email_otp_resending:{label:"邮箱OTP重发",type:"warning"}},vs=[{label:l("page.payment.request.search.allStatus"),value:""},...Object.entries(oe).map(([s,e])=>({label:e.label,value:s}))],fs=[{label:l("page.payment.request.search.uncompleted"),value:"false"},{label:l("page.payment.request.search.completed"),value:"true"},{label:l("page.payment.request.search.all"),value:""}],gs=[{label:l("page.payment.request.search.all"),value:""},{label:l("page.payment.request.search.success"),value:"true"},{label:l("page.payment.request.search.failed"),value:"false"}],ms=[{label:l("page.payment.request.blacklistTypes.payWrong"),value:"pay_wrong"},{label:l("page.payment.request.blacklistTypes.userBlack"),value:"user_black"}],je={alipay:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/alipay.svg",amex:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/amex.svg",diners:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/diners.svg",discover:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/discover.svg",elo:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/elo.svg",hiper:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/hiper.svg",hipercard:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/hipercard.svg",jcb:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/jcb.svg",maestro:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/maestro.svg",mastercard:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/mastercard.svg",mir:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/mir.svg",paypal:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/paypal.svg",unionpay:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/unionpay.svg",visa:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/visa.svg",generic:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/generic.svg"},Me=m(!1),d=m(null),Ve=m(!1),_e=m({}),We=m({}),we=m(!1),z=m(null),ke=m(!1),qe=m(!1),$e=m(!1),Ce=m(!1),Se=m(!1),Pe=m(!1),Ie=m(!1),w=m(null),ye=m(""),re=m(""),ue=m(""),ze=m(""),De=m(""),Ue=m(""),ce=m(!1),de=m(!1),pe=m(!1),ve=m(!1),V=ie({blacklist_type:"user_black",redirect_url:"",notes:""}),O=m(new Set),Te=m(!1),H=ie({card_prefix:"",note_content:"",tag_color:"info"}),Je=m([]),Qe=m("");function _s(s,e){We.value[s]=e,_e.value[s]=!0}const ys=fe(()=>{const s=window.innerHeight;return Math.max(300,s-150-60-60-80)});function Ee(){Object.keys(_e.value).forEach(s=>{_e.value[Number.parseInt(s)]&&(_e.value[Number.parseInt(s)]=!1)})}function bs(s){console.log("showCardDialog called",s),z.value=s,we.value=!0,console.log("showCardModal.value set to",we.value)}function hs(s){const e=Le.value,i=new Date(s),a=Math.floor((e.getTime()-i.getTime())/1e3);if(a<60)return`${a}秒前`;if(a<3600){const n=Math.floor(a/60),f=a%60;return`${n}分${f}秒前`}return a<86400?`${Math.floor(a/3600)}时前`:`${Math.floor(a/86400)}天前`}function xs(s){const e=Le.value,i=new Date(s),a=Math.floor((e.getTime()-i.getTime())/1e3);if(a<60)return`${a}秒`;if(a<3600){const n=Math.floor(a/60),f=a%60;return`${n}分${f}秒`}return`${Math.floor(a/3600)}时`}function ws(s){return["verification_required","filling_verification","filling_otp","filling_email_otp","filling_pin","filling_app_verification","verification_submitted","otp_resending","email_otp_resending"].includes(s)}function ks(s){let e;g.is_completed==="true"?e="completed":g.is_completed==="false"?e="uncompleted":e="all",he[e].page=q.page,he[e].pageSize=q.pageSize;let i;s==="true"?i="completed":s==="false"?i="uncompleted":i="all",q.page=he[i].page,q.pageSize=he[i].pageSize}const Ke={alipay:"支付宝",amex:"American Express",diners:"Diners Club",discover:"Discover",elo:"Elo",hiper:"Hiper",hipercard:"Hipercard",jcb:"JCB",maestro:"Maestro",mastercard:"Mastercard",mir:"Mir",paypal:"PayPal",unionpay:"银联",visa:"Visa",generic:"未知卡型"};function Ge(s){if(!s)return je.generic;const e=s.toLowerCase();return je[e]||je.generic}function Ze(s){if(!s)return Ke.generic;const e=s.toLowerCase();return Ke[e]||s}async function D(s){var e,i;try{await navigator.clipboard.writeText(s),(e=window.$message)==null||e.success(l("page.payment.request.messages.copySuccess"))}catch(a){console.error("复制失败:",a),(i=window.$message)==null||i.error(l("page.payment.request.messages.copyFailed"))}}function j(s,e,i="",a=!1){const n={type:"payment_action",data:{client_id:s,action:e,message:i,custom_message_enabled:a}};ss(n),console.log("发送支付操作:",n)}function qs(s){w.value=s,ye.value=s.notes||"",ke.value=!0}async function $s(){var s,e;if(w.value)try{await jt(w.value.id,ye.value);const i=b.value.findIndex(a=>a.id===w.value.id);i!==-1&&(b.value[i]={...b.value[i],notes:ye.value}),(s=window.$message)==null||s.success(l("page.payment.request.messages.noteSubmitted")),ke.value=!1}catch(i){console.error("提交备注失败:",i),(e=window.$message)==null||e.error(l("page.payment.request.messages.noteSubmitFailed"))}}function Cs(s,e=!1){w.value=s,re.value="",ce.value=e,qe.value=!0}function Ss(){var s;w.value&&(O.value.add(w.value.id),j(w.value.session_info.client_id,"require_otp",re.value,ce.value),(s=window.$message)==null||s.success(l("page.payment.request.messages.otpSent")),qe.value=!1)}function Ps(s,e=!1){w.value=s,ue.value="",de.value=e,$e.value=!0}function Is(){var s;w.value&&(O.value.add(w.value.id),j(w.value.session_info.client_id,"require_email_otp",ue.value,de.value),(s=window.$message)==null||s.success(l("page.payment.request.messages.emailOtpSent")),$e.value=!1)}function zs(s,e=!1){w.value=s,ze.value="",pe.value=e,Ce.value=!0}function Ds(){var s;w.value&&(O.value.add(w.value.id),j(w.value.session_info.client_id,"require_pin",ze.value,pe.value),(s=window.$message)==null||s.success(l("page.payment.request.messages.pinSent")),Ce.value=!1)}function Us(s,e=!1){w.value=s,De.value="",ve.value=e,Se.value=!0}function Ts(){var s;w.value&&(O.value.add(w.value.id),j(w.value.session_info.client_id,"require_app",De.value,ve.value),(s=window.$message)==null||s.success(l("page.payment.request.messages.appSent")),Se.value=!1)}function Os(s){w.value=s,Ue.value="",Pe.value=!0}function Ns(){var s;w.value&&(O.value.add(w.value.id),j(w.value.session_info.client_id,"reject_payment",Ue.value),(s=window.$message)==null||s.success(l("page.payment.request.messages.rejectPaymentSent")),Pe.value=!1)}function Ls(s){var e;j(s.session_info.client_id,"disconnect_client"),(e=window.$message)==null||e.success(l("page.payment.request.messages.disconnectSent"))}function Rs(s){w.value=s,V.blacklist_type="user_black",V.redirect_url="",V.notes="",Ie.value=!0}function js(){var e;if(!w.value)return;const s={type:"payment_action",data:{client_id:w.value.session_info.client_id,action:"disconnect_client_black",message:"",blacklist_params:{blacklist_type:V.blacklist_type,redirect_url:V.redirect_url,notes:V.notes}}};ss(s),(e=window.$message)==null||e.success(l("page.payment.request.messages.blacklistSent")),Ie.value=!1}function Ms(s){Vs(s)}async function Vs(s){var e,i,a;try{ee.value==="trash"?(await Mt(s.id),(e=window.$message)==null||e.success("已永久删除")):(await Vt(s.id),(i=window.$message)==null||i.success("已移至垃圾桶"));const f=b.value.findIndex(S=>S.id===s.id);f!==-1&&b.value.splice(f,1),E()}catch(n){console.error("删除失败:",n),(a=window.$message)==null||a.error("删除失败")}}async function Es(s){var e,i;try{await Et(s.id);const a=b.value.findIndex(n=>n.id===s.id);a!==-1&&(b.value.splice(a,1),q.total-=1),(e=window.$message)==null||e.success("恢复成功"),b.value.length===0&&q.page>1&&(q.page-=1,await E())}catch(a){console.error("恢复失败:",a),(i=window.$message)==null||i.error("恢复失败")}}async function Xe(s,e){var i,a;try{await At(s.id,e);const n=b.value.findIndex(S=>S.id===s.id);n!==-1&&(b.value[n]={...b.value[n],custom_status:e,update_time:new Date().toISOString()});const f={pending:"待处理",bound:"已绑定",completed:"已完成"};(i=window.$message)==null||i.success(`已设置为${f[e]}`)}catch(n){console.error("设置状态失败:",n),(a=window.$message)==null||a.error("设置状态失败")}}function Ye(s){let e=s.custom_status;return e||(e="pending",s.card_number&&s.card_holder&&s.expiry_date&&s.cvv&&(e="bound")),[{key:"pending",label:"设置为待处理",icon:"carbon:time"},{key:"bound",label:"设置为已绑定",icon:"carbon:link"},{key:"completed",label:"设置为已完成",icon:"carbon:checkmark"}].filter(a=>a.key!==e)}function As(s){var e;O.value.add(s.id),j(s.session_info.client_id,"show_initial_wait"),(e=window.$message)==null||e.success(l("page.payment.request.messages.initialPageSent"))}function Hs(s){var e;O.value.add(s.id),j(s.session_info.client_id,"show_connecting"),(e=window.$message)==null||e.success(l("page.payment.request.messages.connectPageSent"))}function Fs(s){var e;O.value.add(s.id),j(s.session_info.client_id,"show_wait_verification"),(e=window.$message)==null||e.success(l("page.payment.request.messages.waitVerificationSent"))}function Bs(s){var e;O.value.add(s.id),j(s.session_info.client_id,"approve_payment"),(e=window.$message)==null||e.success(l("page.payment.request.messages.approvePaymentSent"))}function Ws(s){var e;O.value.add(s.id),j(s.session_info.client_id,"reject_card"),(e=window.$message)==null||e.success(l("page.payment.request.messages.rejectCardSent"))}function Js(s){if(O.value.has(s.id))return!0;const i=["filling_verification","filling_otp","filling_email_otp","filling_pin","filling_app_verification","card_submitted","cvv_submitted","verification_required","verification_submitted","otp_resending","email_otp_resending"].includes(s.status);return i&&O.value.add(s.id),i}function U(s,e,i=!1){var a,n;switch(s){case"add-remark":qs(e);break;case"show-initial":As(e);break;case"show-connecting":Hs(e);break;case"show-wait-verification":Fs(e);break;case"require-otp":Cs(e,i);break;case"require-email-otp":Ps(e,i);break;case"require-pin":i?zs(e,i):(O.value.add(e.id),j(e.session_info.client_id,"require_pin","",!1),(a=window.$message)==null||a.success(l("page.payment.request.messages.pinSent")));break;case"require-app":i?Us(e,i):(O.value.add(e.id),j(e.session_info.client_id,"require_app","",!1),(n=window.$message)==null||n.success(l("page.payment.request.messages.appSent")));break;case"approve-payment":Bs(e);break;case"reject-payment":Os(e);break;case"reject-card":Ws(e);break;case"disconnect":Ls(e);break;case"disconnect-blacklist":Rs(e);break}}async function es(s){var e;try{Ve.value=!0,Me.value=!0,d.value=null;const i=await Ht(s.id);d.value=i.data}catch(i){console.error("获取详情失败:",i),(e=window.$message)==null||e.error(l("page.payment.request.messages.getDetailFailed"))}finally{Ve.value=!1}}function Qs(s){return s.status==="card_submitted"||s.is_completed?!0:[s.card_holder,s.card_number,s.expiry_date,s.cvv,s.otp,s.email_otp,s.pin].filter(Boolean).length>=4}function Ks(s){const e=[`支付请求详情 #${s.request.id}`,Gs(s),Zs(s),Xs(s),Ys(s),et(s),st(s)];D(e.join(`
`))}function Gs(s){var e;return`
=== 基本信息 ===
ID: ${s.request.id}
状态: ${((e=oe[s.request.status])==null?void 0:e.label)||s.request.status}
完成状态: ${s.request.is_completed?"已完成":"进行中"}
金额: ${s.request.currency} ${s.request.amount}
验证次数: ${s.request.verification_attempts}
创建时间: ${Z(s.request.create_time)}`}function Zs(s){return`
=== 卡片信息 ===
卡号: ${s.request.card_number||"无"}
持卡人: ${s.request.card_holder||"无"}
有效期: ${s.request.expiry_date||"无"}
CVV: ${s.request.cvv||"无"}
卡类型: ${s.request.card_type||"无"}`}function Xs(s){return`
=== 验证信息 ===
验证类型: ${s.request.verification_type||"无"}
OTP: ${s.request.otp||"无"}
邮箱OTP: ${s.request.email_otp||"无"}
PIN: ${s.request.pin||"无"}`}function Ys(s){return`
=== 个人信息 ===
电话: ${s.request.phone||"无"}
邮编: ${s.request.zip_code||"无"}
城市: ${s.request.city||"无"}
街道地址: ${s.request.street_address||"无"}
名字: ${s.request.first_name||"无"}
姓氏: ${s.request.last_name||"无"}
邮箱: ${s.request.email||"无"}
国家: ${s.request.country||"无"}
州/省: ${s.request.state||"无"}`}function et(s){return`
=== 用户统计 ===
总支付次数: ${s.request.user_statistics.total_payments}
完成支付次数: ${s.request.user_statistics.completed_payments}
成功支付次数: ${s.request.user_statistics.successful_payments}
成功率: ${(s.request.user_statistics.success_rate*100).toFixed(1)}%`}function st(s){var e,i,a,n,f,S,k,N,A,L,R,M,F,B,W,J,Q,K,te,ae;return`
=== 用户信息 ===
用户ID: ${((e=s.user)==null?void 0:e.id)||"无"}
用户UUID: ${((i=s.user)==null?void 0:i.uuid)||"无"}
首次访问: ${Z((a=s.user)==null?void 0:a.first_seen)||"无"}
最后访问: ${Z((n=s.user)==null?void 0:n.last_seen)||"无"}

=== 浏览器信息 ===
浏览器: ${((f=s.session.user_agent_parse)==null?void 0:f.browser_name)||"无"}
浏览器版本: ${((S=s.session.user_agent_parse)==null?void 0:S.browser_version)||"无"}
操作系统: ${((k=s.session.user_agent_parse)==null?void 0:k.browser_os)||"无"}
平台: ${((N=s.session.user_agent_parse)==null?void 0:N.browser_platform)||"无"}

=== 设备指纹信息 ===
语言: ${((L=(A=s.session.device_fingerprint)==null?void 0:A.device_info)==null?void 0:L.language)||"无"}
时区: ${((M=(R=s.session.device_fingerprint)==null?void 0:R.device_info)==null?void 0:M.timezone)||"无"}
设备平台: ${((B=(F=s.session.device_fingerprint)==null?void 0:F.device_info)==null?void 0:B.platform)||"无"}
产品: ${((J=(W=s.session.device_fingerprint)==null?void 0:W.device_info)==null?void 0:J.product)||"无"}

=== IP地理信息 ===
国家: ${((Q=s.session.ip_info)==null?void 0:Q.country)||"无"}
地区: ${((K=s.session.ip_info)==null?void 0:K.region)||"无"}
城市: ${((te=s.session.ip_info)==null?void 0:te.city)||"无"}
ISP: ${((ae=s.session.ip_info)==null?void 0:ae.isp)||"无"}

=== 会话信息 ===
客户端ID: ${s.session.client_id}
会话ID: ${s.session.session_id}
IP地址: ${s.session.ip_address}
页面URL: ${s.session.page_url}
页面标题: ${s.session.page_title}
用户代理: ${s.session.user_agent}
连接状态: ${s.session.is_connected?"在线":"离线"}`}const{status:tn,isReconnecting:an,send:ss}=Ct({onMessage:s=>{ot(s)}});async function tt(){var s;try{const e=await Ft();e.data&&(Je.value=e.data.colors)}catch(e){console.error("获取标签颜色失败:",e),(s=window.$message)==null||s.error("获取标签颜色失败")}}function at(s){return s.replace(/\D/g,"").substring(0,6)}function lt(s){Qe.value=s;const e=at(s);Object.assign(H,{card_prefix:e,note_content:"",tag_color:"info"}),Te.value=!0}async function it(){var s,e,i,a;try{if(!H.card_prefix||!H.note_content){(s=window.$message)==null||s.error("请填写完整信息");return}if(!/^\d{6,8}$/.test(H.card_prefix)){(e=window.$message)==null||e.error("卡头必须是6-8位数字");return}await Bt(H),(i=window.$message)==null||i.success("添加卡头备注成功"),Te.value=!1,E()}catch(n){console.error("添加卡头备注失败:",n),(a=window.$message)==null||a.error("添加卡头备注失败")}}function nt(s){const e=[];return Qs(s)&&e.push({label:"Info",value:"info",type:"success",isInfo:!0}),s.page_visit_history&&s.page_visit_history.length>0&&e.push({label:"Path",value:`${s.page_visit_history.length}`,type:"primary",isPath:!0,pageVisitHistory:s.page_visit_history}),s.card_prefix_note&&s.card_prefix_note.note_content&&e.push({label:"卡备注",value:s.card_prefix_note.note_content,type:s.card_prefix_note.tag_color||"info",isCardPrefixNote:!0}),s.card_holder&&e.push({label:"持卡人",value:s.card_holder,type:"info"}),s.card_number&&e.push({label:"卡号",value:s.card_number,type:"primary",isCardNumber:!0}),s.expiry_date&&e.push({label:"过期",value:s.expiry_date,type:"warning"}),s.cvv&&e.push({label:"CVV",value:s.cvv,type:"error"}),s.otp&&e.push({label:"OTP",value:s.otp,type:"success"}),s.email_otp&&e.push({label:"邮箱OTP",value:s.email_otp,type:"info"}),s.pin&&e.push({label:"PIN",value:s.pin,type:"default"}),e}function ot(s){if(s.data.type==="pong"||s.data.type!=="client_event")return;const{event_type:e,client_id:i,session_info:a,request_id:n,data:f}=s.data;if(console.log("收到WebSocket消息:",{event_type:e,client_id:i,status:a==null?void 0:a.status}),!b.value.some(k=>k.session_info.client_id===i)){console.log(`客户端 ${i} 不在当前列表中，重新获取数据`),E();return}switch(e){case"user_start_fill_card":rt(i,f,a);break;case"user_personal_info_change":ut(i,f,a);break;case"user_start_fill_verification":ct(i,f,a);break;case"verification_submit":dt(i,f,a);break;case"client_connected":Ae(i,a.status);break;case"client_disconnected":Ae(i,a.status);break;default:a!=null&&a.status&&Ae(i,a.status,n);break}}function rt(s,e,i){const a=b.value.findIndex(n=>n.session_info.client_id===s);if(a!==-1){const n={...b.value[a]};switch(n.status=i.status||e.detailed_status,n.update_time=new Date().toISOString(),e.field_name){case"card-holder":e.field_value&&(n.card_holder=e.field_value);break;case"card-number":e.field_value&&(n.card_number=e.field_value);break;case"expiry-date":e.field_value&&(n.expiry_date=e.field_value);break;case"cvv":e.field_value&&(n.cvv=e.field_value);break}e.card_type&&e.card_type!=="generic"&&(n.card_type=e.card_type),b.value[a]=n,console.log(`更新客户端 ${s} 卡片信息:`,e.field_name,e.field_value)}}function ut(s,e,i){const a=b.value.findIndex(n=>n.session_info.client_id===s);if(a!==-1){const n={...b.value[a]};switch(n.status=i.status||e.detailed_status,n.update_time=new Date().toISOString(),e.field_type){case"phone":e.field_value&&(n.phone=e.field_value);break;case"zipCode":e.field_value&&(n.zip_code=e.field_value);break;case"city":e.field_value&&(n.city=e.field_value);break;case"streetAddress":e.field_value&&(n.street_address=e.field_value);break;case"firstName":e.field_value&&(n.first_name=e.field_value);break;case"lastName":e.field_value&&(n.last_name=e.field_value);break;case"email":e.field_value&&(n.email=e.field_value);break;case"country":e.field_value&&(n.country=e.field_value);break;case"state":e.field_value&&(n.state=e.field_value);break}b.value[a]=n,console.log(`更新客户端 ${s} 个人信息:`,e.field_type,e.field_value)}}function ct(s,e,i){const a=b.value.findIndex(n=>n.session_info.client_id===s);if(a!==-1){const n={...b.value[a]};if(n.status=i.status||e.detailed_status,n.update_time=new Date().toISOString(),e.verification_type&&(n.verification_type=e.verification_type),e.verification_value||e.verification_code){const f=e.verification_value||e.verification_code;switch(e.verification_type){case"otp":n.otp=f;break;case"email_otp":n.email_otp=f;break;case"pin":n.pin=f;break}}b.value[a]=n,console.log(`更新客户端 ${s} 验证信息:`,e.verification_type,e.verification_value)}}function dt(s,e,i){const a=b.value.findIndex(n=>n.session_info.client_id===s);if(a!==-1){const n={...b.value[a]};if(n.status=i.status,n.update_time=new Date().toISOString(),e.verification_type&&(n.verification_type=e.verification_type),e.verification_code)switch(e.verification_type){case"otp":n.otp=e.verification_code;break;case"email_otp":n.email_otp=e.verification_code;break;case"pin":n.pin=e.verification_code;break}b.value[a]=n,console.log(`客户端 ${s} 提交验证码:`,e.verification_type,e.verification_code)}}function Ae(s,e,i){const a=b.value.findIndex(n=>n.session_info.client_id===s||i&&n.id===i);if(a!==-1){const n={...b.value[a]};n.status=e,n.update_time=new Date().toISOString(),b.value[a]=n,console.log(`更新客户端 ${s} 状态为: ${e}`),["payment_success","payment_failed","card_rejected","disconnected"].includes(e)&&(console.log(`检测到终端状态 ${e}，将刷新列表数据`),setTimeout(()=>{E()},500))}}function pt(){const s=be.query.status||"all";Oe.find(e=>e.value===s)&&(ee.value=s,He(s))}function He(s){const e=Oe.find(i=>i.value===s);if(e)switch(x.custom_status=e.customStatus||void 0,x.include_trash=e.includeTrash,x.is_completed=void 0,x.success=void 0,s){case"pending":break;case"completed":x.is_completed=!0;break;case"bound":x.is_completed=!1;break}}function vt(s){ee.value=s,He(s),cs.push({path:be.path,query:{...be.query,status:s}}),q.page=1,x.page=1,E()}async function E(){var s;try{Ne.value=!0,x.page=q.page,x.size=q.pageSize;const e={...x};ee.value==="all"&&(e.include_work_center=!0);const i=await Wt(e);b.value=i.data.requests,q.total=i.data.total,i.data.current!==void 0&&(q.page=i.data.current)}catch(e){console.error("获取支付请求列表失败:",e),(s=window.$message)==null||s.error(l("page.payment.request.messages.getListFailed"))}finally{Ne.value=!1}}function ft(){x.status=g.status||void 0,g.is_completed==="true"?x.is_completed=!0:g.is_completed==="false"?x.is_completed=!1:x.is_completed=void 0,g.success==="true"?x.success=!0:g.success==="false"?x.success=!1:x.success=void 0,x.user_uuid=g.user_uuid||void 0,x.client_id=g.client_id||void 0,x.ip_address=g.ip_address||void 0,x.start_date=g.start_date?new Date(g.start_date).toISOString():void 0,x.end_date=g.end_date?new Date(g.end_date).toISOString():void 0}function ts(){ft(),q.page=1,x.page=1,E()}function gt(){Object.assign(x,{page:1,size:15,status:"",is_completed:!1,success:void 0,user_uuid:void 0,client_id:void 0,ip_address:void 0,start_date:void 0,end_date:void 0}),Object.assign(g,{status:"",is_completed:"false",success:"",user_uuid:"",client_id:"",ip_address:"",start_date:null,end_date:null}),q.page=1,q.pageSize=15,E()}function mt(s){q.page=s,E()}function _t(s){q.pageSize=s,q.page=1,E()}function yt(s){try{if(s.startsWith("file://"))return"Local File";const e=new URL(s);return e.host||e.hostname||"Unknown"}catch{return"Invalid URL"}}const bt=[{title:l("page.payment.request.columns.id"),key:"id",width:45,fixed:"left",render:s=>o("span",{style:{cursor:"pointer",color:"#1890ff",fontWeight:"500"},onClick:()=>es(s)},s.id.toString())},{title:l("page.payment.request.columns.user"),key:"user",width:150,render:s=>{var S,k,N,A,L,R,M,F,B,W,J,Q,K,te,ae;const e=s.user_info.id,i=s.id,a=((S=s.ip_info)==null?void 0:S.country_code)||"未知",n=s.session_info.page_url?yt(s.session_info.page_url):"未知",f=`用户信息:
用户ID: ${s.user_info.id}
用户UUID: ${s.user_info.uuid}
首次访问: ${Z(s.user_info.first_seen)}
最后访问: ${Z(s.user_info.last_seen)}

浏览器信息:
浏览器: ${((k=s.session_info.user_agent_parse)==null?void 0:k.browser_name)||"未知"}
版本: ${((N=s.session_info.user_agent_parse)==null?void 0:N.browser_version)||"未知"}
操作系统: ${((A=s.session_info.user_agent_parse)==null?void 0:A.browser_os)||"未知"}
平台类型: ${((L=s.session_info.user_agent_parse)==null?void 0:L.browser_platform)||"未知"}

设备信息:
语言: ${((M=(R=s.session_info.device_fingerprint)==null?void 0:R.device_info)==null?void 0:M.language)||"未知"}
时区: ${((B=(F=s.session_info.device_fingerprint)==null?void 0:F.device_info)==null?void 0:B.timezone)||"未知"}
操作系统: ${((J=(W=s.session_info.device_fingerprint)==null?void 0:W.device_info)==null?void 0:J.platform)||"未知"}

会话信息:
客户端ID: ${s.session_info.client_id}
IP地址: ${s.session_info.ip_address}
用户代理: ${s.session_info.user_agent}

地理位置:
国家: ${((Q=s.ip_info)==null?void 0:Q.country)||"未知"}
地区: ${((K=s.ip_info)==null?void 0:K.region)||"未知"}
城市: ${((te=s.ip_info)==null?void 0:te.city)||"未知"}
ISP: ${((ae=s.ip_info)==null?void 0:ae.isp)||"未知"}`;return o("div",{class:"flex flex-col gap-1",onMousemove:Ee},[o("div",{class:"flex flex-col gap-1"},[o("div",{class:"flex gap-1"},[o(Fe,{show:_e.value[i]||!1,trigger:"manual",placement:"right"},{trigger:()=>o(h,{type:"info",size:"small",style:{cursor:"pointer"},onClick:()=>_s(i,f)},{default:()=>`ID: ${e}`}),default:()=>o("pre",{style:{margin:0,whiteSpace:"pre-wrap",fontSize:"12px",maxWidth:"600px",lineHeight:"1.4",backgroundColor:"#2d3748",color:"#e2e8f0",padding:"12px",borderRadius:"6px",border:"1px solid #4a5568"}},We.value[i]||"")}),o(h,{type:"success",size:"small",style:{cursor:"pointer"},onClick:()=>D(a)},{default:()=>a})]),o("div",{class:"flex gap-1"},[o(h,{type:"primary",size:"small",style:{cursor:"pointer"},onClick:()=>D(s.session_info.page_url||"")},{default:()=>n})])])])}},{title:l("page.payment.request.columns.info"),key:"info",width:420,render:s=>{const e=nt(s);return o("div",{class:"flex flex-wrap gap-1"},e.map(i=>{if(i.isPath){const a=i.pageVisitHistory;return o(Fe,{trigger:"hover",placement:"bottom",scrollable:!0,style:{maxHeight:"400px"}},{trigger:()=>o(h,{type:"primary",size:"small",style:{cursor:"pointer"}},{default:()=>"Path"}),default:()=>o("div",{class:"p-3",style:{maxWidth:"500px",maxHeight:"400px",overflow:"auto"}},[o("div",{class:"font-medium mb-2"},`页面访问历史 (共${a.length}页)`),o("div",{class:"space-y-3"},a.map((n,f)=>o("div",{class:"border-b pb-2 last:border-b-0 last:pb-0",key:f},[o("div",{class:"flex items-center gap-2 mb-1"},[o(h,{size:"tiny",type:"info"},{default:()=>`#${f+1}`}),o("span",{class:"font-medium text-sm",style:{cursor:"pointer"},onClick:()=>D(n.page_url)},n.page_title||"无标题")]),o("div",{class:"space-y-1 text-xs"},[o("div",{class:"flex items-start gap-1"},[o("span",{class:"text-gray-500 flex-shrink-0"},"路径:"),o("span",{class:"break-all"},n.path)]),o("div",{class:"flex items-start gap-1"},[o("span",{class:"text-gray-500 flex-shrink-0"},"域名:"),o("span",n.domain||"本地文件")]),o("div",{class:"flex items-start gap-1"},[o("span",{class:"text-gray-500 flex-shrink-0"},"时间:"),o("span",Z(n.timestamp))]),n.params&&Object.keys(n.params).length>0&&o("div",{class:"flex items-start gap-1"},[o("span",{class:"text-gray-500 flex-shrink-0"},"参数:"),o("div",{class:"flex flex-wrap gap-1"},Object.entries(n.params).map(([S,k])=>o(h,{size:"tiny",type:"default",onClick:()=>D(`${S}=${k}`)},{default:()=>`${S}=${k}`})))])])])))])})}return o(h,{type:i.type,size:"small",style:{cursor:"pointer"},onClick:()=>{i.isInfo?es(s):(i.isCardPrefixNote||i.isCardNumber,D(i.value))},onContextmenu:a=>{i.isCardNumber&&(a.preventDefault(),lt(i.value))}},{default:()=>i.isInfo?i.label:`${i.label}: ${i.value}`})}))}},{title:l("page.payment.request.columns.cardType"),key:"card_type",width:80,align:"center",render:s=>{const e=Ge(s.card_type),i=Ze(s.card_type);return o("div",{class:"flex items-center justify-center w-full",style:{textAlign:"center"}},[o("img",{src:e,alt:i,style:{width:"32px",height:"20px",objectFit:"contain",cursor:"pointer",display:"block",margin:"0 auto"},title:i,onClick:()=>bs(s)})])}},{title:l("page.payment.request.columns.status"),key:"status",width:120,render:s=>{const e=oe[s.status]||{label:s.status,type:"default"},i=ws(s.status)&&g.is_completed==="false";return o("div",{class:"flex gap-1 flex-wrap"},[o(h,{type:e.type,size:"small"},{default:()=>e.label}),i?o(h,{type:"warning",size:"tiny"},{default:()=>xs(s.update_time)}):null].filter(Boolean))}},{title:l("page.payment.request.columns.completionStatus"),key:"is_completed",width:80,render:s=>o(h,{type:s.is_completed?"success":"warning",size:"small"},{default:()=>s.is_completed?l("page.payment.request.search.completed"):l("page.payment.request.detail.none")})},{title:l("page.payment.request.columns.notes"),key:"notes",width:100,render:s=>s.notes?o(St,{trigger:"hover"},{trigger:()=>o("div",{style:{maxWidth:"130px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"},onClick:()=>D(s.notes||"")},s.notes||""),default:()=>o("div",{style:{maxWidth:"300px",whiteSpace:"pre-wrap",wordBreak:"break-word"}},s.notes||"")}):o("span",{style:{color:"#999"}},l("page.payment.request.detail.none"))},{title:l("page.payment.request.columns.updateTime"),key:"update_time",width:90,render:s=>o(h,{type:"info",size:"small"},{default:()=>hs(s.update_time)})},{title:"自定义状态",key:"custom_status",width:80,align:"center",render:s=>{let e=s.custom_status;e||(e="pending",s.card_number&&s.card_holder&&s.expiry_date&&s.cvv&&(e="bound"));const i={pending:{label:"待处理",type:"warning"},bound:{label:"已绑定",type:"info"},completed:{label:"已完成",type:"success"},trash:{label:"垃圾桶",type:"error"}},a=i[e]||i.pending;return o(h,{type:a.type,size:"small"},{default:()=>a.label})}},{title:l("page.payment.request.columns.createTime"),key:"create_time",width:120,align:"center",render:s=>{const e=Z(s.create_time),[i,a]=e.split(" ");return o("div",{class:"flex flex-col items-center text-center",style:{lineHeight:"1.2"}},[o("div",{style:{fontSize:"12px",fontWeight:"500"}},i),o("div",{style:{fontSize:"12px",color:"#666",marginTop:"8px"}},a)])}},{title:l("page.payment.request.columns.actions"),key:"actions",width:120,fixed:"right",align:"center",render:s=>{const e=ee.value==="trash";return o("div",{class:"flex justify-center gap-1"},[o(X,{size:"small",type:"error",quaternary:!0,onClick:()=>Ms(s)},{icon:()=>o(P,{icon:"carbon:trash-can",class:"text-16px"}),default:()=>""}),e?o(X,{size:"small",type:"success",quaternary:!0,onClick:()=>Es(s)},{icon:()=>o(P,{icon:"carbon:restart",class:"text-16px"}),default:()=>""}):o(Fe,{trigger:"hover",placement:"bottom-end",showArrow:!1},{trigger:()=>o(X,{size:"small",type:"primary",quaternary:!0},{icon:()=>o(P,{icon:"carbon:settings",class:"text-16px"}),default:()=>""}),default:()=>{const i=Js(s);if(s.is_completed,!i){const n=Ye(s);return o("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border dark:border-gray-600 p-2",style:"min-width: 200px; max-width: 300px;"},[o("div",{class:"space-y-1"},[o("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600"},l("page.payment.request.actions.misc")),o("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>U("add-remark",s)},[o(P,{icon:"carbon:edit",class:"text-16px"}),o("span",l("page.payment.request.actions.addRemark"))]),o("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600 mt-3"},"状态设置"),...n.map(f=>o("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>Xe(s,f.key)},[o(P,{icon:f.icon,class:"text-16px"}),o("span",f.label)]))])])}const a=Ye(s);return o("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border dark:border-gray-600 p-2",style:"min-width: 400px; max-width: 500px;"},[o("div",{class:"grid grid-cols-2 gap-4"},[o("div",{class:"space-y-1"},[o("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600"},"杂项"),o("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>U("add-remark",s)},[o(P,{icon:"carbon:edit",class:"text-16px"}),o("span",l("page.payment.request.actions.addRemark"))]),o("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600 mt-3"},"状态设置"),...a.map(n=>o("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>Xe(s,n.key)},[o(P,{icon:n.icon,class:"text-16px"}),o("span",n.label)])),o("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600 mt-3"},l("page.payment.request.actions.processControl")),o("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>U("show-initial",s)},[o(P,{icon:"carbon:home",class:"text-16px"}),o("span",l("page.payment.request.actions.initialPage"))]),o("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>U("show-connecting",s)},[o(P,{icon:"carbon:connect",class:"text-16px"}),o("span",l("page.payment.request.actions.connectingPage"))]),o("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>U("show-wait-verification",s)},[o(P,{icon:"carbon:time",class:"text-16px"}),o("span",l("page.payment.request.actions.waitVerificationPage"))])]),o("div",{class:"space-y-1"},[o("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600"},"验证控制"),o("div",{class:"text-xs text-gray-400 dark:text-gray-500 px-2 py-1 italic"},"左键=默认 右键=自定义"),o("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>U("require-otp",s,!1),onContextmenu:n=>{n.preventDefault(),U("require-otp",s,!0)}},[o(P,{icon:"carbon:phone",class:"text-16px"}),o("span",l("page.payment.request.actions.otpVerification"))]),o("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>U("require-email-otp",s,!1),onContextmenu:n=>{n.preventDefault(),U("require-email-otp",s,!0)}},[o(P,{icon:"carbon:email",class:"text-16px"}),o("span",l("page.payment.request.actions.emailOtpVerification"))]),o("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>U("require-pin",s,!1),onContextmenu:n=>{n.preventDefault(),U("require-pin",s,!0)}},[o(P,{icon:"carbon:password",class:"text-16px"}),o("span",l("page.payment.request.actions.pinVerification"))]),o("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>U("require-app",s,!1),onContextmenu:n=>{n.preventDefault(),U("require-app",s,!0)}},[o(P,{icon:"carbon:mobile",class:"text-16px"}),o("span",l("page.payment.request.actions.appVerification"))]),o("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600 mt-3"},"结果控制"),o("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>U("approve-payment",s)},[o(P,{icon:"carbon:checkmark",class:"text-16px"}),o("span",l("page.payment.request.actions.approvePayment"))]),o("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>U("reject-payment",s)},[o(P,{icon:"carbon:close",class:"text-16px"}),o("span",l("page.payment.request.actions.rejectPayment"))]),o("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>U("reject-card",s)},[o(P,{icon:"carbon:warning",class:"text-16px"}),o("span",l("page.payment.request.actions.rejectCard"))])])])])}})])}}];function as(){ne.value&&clearInterval(ne.value),g.is_completed==="false"&&(ne.value=setInterval(()=>{Le.value=new Date,b.value=b.value.map(s=>({...s}))},1e3))}function ls(){ne.value&&(clearInterval(ne.value),ne.value=null)}function ht(){Object.assign(y,{...x,export_mode:"basic",format:"csv"}),xe.value=!0}async function xt(){var s,e;try{Re.value=!0;let a=(await Jt(y)).data||"",n="";if(y.format==="csv"){const R="\uFEFF";if(typeof a=="string")a=R+a;else{const M=await new Response(a).text();a=R+M}n="text/csv;charset=utf-8"}else n="application/json;charset=utf-8";const f=new Blob([a],{type:n}),S=window.URL.createObjectURL(f),k=document.createElement("a");k.href=S,k.style.display="none";const N=new Date().toISOString().slice(0,19).replace(/[:-]/g,"").replace("T","_"),L=`支付请求导出_${y.format==="csv"?"CSV":"JSON"}_${N}.${y.format}`;k.download=encodeURIComponent(L).replace(/%/g,""),(!k.download||k.download===L)&&(k.download=`payment_requests_export_${N}.${y.format}`),document.body.appendChild(k),k.click(),document.body.removeChild(k),window.URL.revokeObjectURL(S),(s=window.$message)==null||s.success(l("page.payment.request.messages.exportSuccess")),xe.value=!1}catch(i){console.error("导出失败:",i),(e=window.$message)==null||e.error(l("page.payment.request.messages.exportFailed"))}finally{Re.value=!1}}function wt(){Object.assign(y,{export_mode:"basic",format:"csv",card_type:""})}return rs(()=>[g.status,g.is_completed,g.success],(s,e)=>{e&&s[1]!==e[1]&&ks(s[1]),ts(),s[1]==="false"?as():ls()}),Pt(()=>{pt(),x.page=q.page,x.size=q.pageSize,E(),tt(),document.addEventListener("mousemove",Ee),g.is_completed==="false"&&as()}),rs(()=>be.query.status,s=>{s&&s!==ee.value&&(ee.value=s,He(s),E())}),It(()=>{document.removeEventListener("mousemove",Ee),ls()}),(s,e)=>{const i=Lt;return _(),C("div",Kt,[u(r(Ot),{title:"",class:"h-full card-wrapper",size:"small"},{default:p(()=>[t("div",Gt,[t("div",Zt,[u(r(ge),null,{default:p(()=>[(_(),C(zt,null,Dt(Oe,a=>u(r(X),{key:a.value,type:ee.value===a.value?"primary":"default",ghost:ee.value!==a.value,onClick:n=>vt(a.value)},{default:p(()=>[v(c(a.label.value),1)]),_:2},1032,["type","ghost","onClick"])),64))]),_:1})]),u(r(ge),{class:"mb-2"},{default:p(()=>[u(r(le),{value:g.status,"onUpdate:value":e[0]||(e[0]=a=>g.status=a),options:vs,placeholder:r(l)("page.payment.request.search.status"),style:{width:"150px"},clearable:""},null,8,["value","placeholder"]),u(r(le),{value:g.is_completed,"onUpdate:value":e[1]||(e[1]=a=>g.is_completed=a),options:fs,placeholder:r(l)("page.payment.request.search.completionStatus"),style:{width:"120px"}},null,8,["value","placeholder"]),u(r(le),{value:g.success,"onUpdate:value":e[2]||(e[2]=a=>g.success=a),options:gs,placeholder:r(l)("page.payment.request.search.successStatus"),style:{width:"120px"}},null,8,["value","placeholder"]),u(r(X),{type:"primary",onClick:ts},{icon:p(()=>[u(P,{icon:"carbon:search"})]),default:p(()=>[v(" "+c(r(l)("page.payment.request.actions.search")),1)]),_:1}),u(r(X),{onClick:gt},{icon:p(()=>[u(P,{icon:"carbon:reset"})]),default:p(()=>[v(" "+c(r(l)("page.payment.request.actions.reset")),1)]),_:1}),u(r(X),{type:"success",onClick:ht},{icon:p(()=>[u(P,{icon:"carbon:download"})]),default:p(()=>[v(" "+c(r(l)("page.payment.request.actions.exportData")),1)]),_:1}),u(r(X),{text:"",onClick:e[3]||(e[3]=a=>me.value=!me.value)},{icon:p(()=>[u(P,{icon:me.value?"carbon:chevron-up":"carbon:chevron-down"},null,8,["icon"])]),default:p(()=>[v(" "+c(me.value?r(l)("page.payment.request.search.collapse"):r(l)("page.payment.request.search.expand")),1)]),_:1})]),_:1}),Ut(t("div",Xt,[u(r(ge),{class:"mb-2"},{default:p(()=>[u(r(T),{value:g.user_uuid,"onUpdate:value":e[4]||(e[4]=a=>g.user_uuid=a),placeholder:r(l)("page.payment.request.search.userUuid"),style:{width:"200px"},clearable:""},null,8,["value","placeholder"]),u(r(T),{value:g.client_id,"onUpdate:value":e[5]||(e[5]=a=>g.client_id=a),placeholder:r(l)("page.payment.request.search.clientId"),style:{width:"200px"},clearable:""},null,8,["value","placeholder"]),u(r(T),{value:g.ip_address,"onUpdate:value":e[6]||(e[6]=a=>g.ip_address=a),placeholder:r(l)("page.payment.request.search.ipAddress"),style:{width:"150px"},clearable:""},null,8,["value","placeholder"])]),_:1}),u(r(ge),null,{default:p(()=>[u(r(us),{value:g.start_date,"onUpdate:value":e[7]||(e[7]=a=>g.start_date=a),placeholder:r(l)("page.payment.request.search.startTime"),type:"datetime",style:{width:"200px"},clearable:""},null,8,["value","placeholder"]),u(r(us),{value:g.end_date,"onUpdate:value":e[8]||(e[8]=a=>g.end_date=a),placeholder:r(l)("page.payment.request.search.endTime"),type:"datetime",style:{width:"200px"},clearable:""},null,8,["value","placeholder"])]),_:1})],512),[[Tt,me.value]])]),u(r(Qt),{columns:bt,data:b.value,loading:Ne.value,pagination:{page:q.page,pageSize:q.pageSize,itemCount:q.total,showSizePicker:q.showSizePicker,pageSizes:q.pageSizes,showQuickJumper:!0,prefix:a=>`共 ${a.itemCount} 条`,onUpdatePage:mt,onUpdatePageSize:_t},"scroll-x":1240,"max-height":ys.value,size:"small",remote:"","virtual-scroll":"","flex-height":"","row-props":()=>({style:"border-bottom: 1px solid #e8e8e8;"})},null,8,["data","loading","pagination","max-height"])]),_:1}),u(r(G),{show:Me.value,"onUpdate:show":e[17]||(e[17]=a=>Me.value=a),preset:"card",title:r(l)("page.payment.request.detail.title"),style:{width:"90%","max-width":"1200px"},"mask-closable":!1},{"header-extra":p(()=>[d.value?(_(),Y(r(X),{key:0,type:"primary",size:"small",onClick:e[9]||(e[9]=a=>Ks(d.value))},{default:p(()=>[v(c(r(l)("page.payment.request.detail.copyAllInfo")),1)]),_:1})):$("",!0)]),default:p(()=>{var a,n,f,S,k,N,A,L,R,M,F,B,W,J,Q,K,te,ae,is,ns,os;return[d.value&&!Ve.value?(_(),C("div",Yt,[t("div",ea,[t("div",sa,[t("div",ta,[e[49]||(e[49]=t("span",{class:"cell-label"},"ID",-1)),t("span",aa,c(d.value.request.id),1)]),t("div",la,[e[50]||(e[50]=t("span",{class:"cell-label"},"状态",-1)),u(r(h),{type:((a=oe[d.value.request.status])==null?void 0:a.type)||"default",size:"small"},{default:p(()=>{var se;return[v(c(((se=oe[d.value.request.status])==null?void 0:se.label)||d.value.request.status),1)]}),_:1},8,["type"])]),t("div",ia,[e[51]||(e[51]=t("span",{class:"cell-label"},"完成状态",-1)),u(r(h),{type:d.value.request.is_completed?"success":"warning",size:"small"},{default:p(()=>[v(c(d.value.request.is_completed?"已完成":"进行中"),1)]),_:1},8,["type"])]),t("div",na,[e[52]||(e[52]=t("span",{class:"cell-label"},"验证次数",-1)),t("span",oa,c(d.value.request.verification_attempts),1)]),t("div",ra,[e[53]||(e[53]=t("span",{class:"cell-label"},"创建时间",-1)),t("span",ua,c(r(Z)(d.value.request.create_time)),1)])]),t("div",ca,[d.value.request.card_number?(_(),C("div",da,[e[54]||(e[54]=t("span",{class:"cell-label"},"卡号",-1)),u(r(h),{type:"primary",size:"small",style:{cursor:"pointer"},onClick:e[10]||(e[10]=se=>D(d.value.request.card_number))},{default:p(()=>[v(" 卡号: "+c(d.value.request.card_number),1)]),_:1})])):$("",!0),d.value.request.card_holder?(_(),C("div",pa,[e[55]||(e[55]=t("span",{class:"cell-label"},"持卡人",-1)),u(r(h),{type:"info",size:"small",style:{cursor:"pointer"},onClick:e[11]||(e[11]=se=>D(d.value.request.card_holder))},{default:p(()=>[v(" 持卡人: "+c(d.value.request.card_holder),1)]),_:1})])):$("",!0),d.value.request.expiry_date?(_(),C("div",va,[e[56]||(e[56]=t("span",{class:"cell-label"},"有效期",-1)),u(r(h),{type:"warning",size:"small",style:{cursor:"pointer"},onClick:e[12]||(e[12]=se=>D(d.value.request.expiry_date))},{default:p(()=>[v(" 过期: "+c(d.value.request.expiry_date),1)]),_:1})])):$("",!0),d.value.request.cvv?(_(),C("div",fa,[e[57]||(e[57]=t("span",{class:"cell-label"},"CVV",-1)),u(r(h),{type:"error",size:"small",style:{cursor:"pointer"},onClick:e[13]||(e[13]=se=>D(d.value.request.cvv))},{default:p(()=>[v(" CVV: "+c(d.value.request.cvv),1)]),_:1})])):$("",!0),t("div",ga,[e[58]||(e[58]=t("span",{class:"cell-label"},"卡类型",-1)),t("span",ma,c(d.value.request.card_type||"无"),1)])]),t("div",_a,[t("div",ya,[e[59]||(e[59]=t("span",{class:"cell-label"},"验证类型",-1)),t("span",ba,c(d.value.request.verification_type||"无"),1)]),d.value.request.otp?(_(),C("div",ha,[e[60]||(e[60]=t("span",{class:"cell-label"},"OTP",-1)),u(r(h),{type:"success",size:"small",style:{cursor:"pointer"},onClick:e[14]||(e[14]=se=>D(d.value.request.otp))},{default:p(()=>[v(" OTP: "+c(d.value.request.otp),1)]),_:1})])):$("",!0),d.value.request.email_otp?(_(),C("div",xa,[e[61]||(e[61]=t("span",{class:"cell-label"},"邮箱OTP",-1)),u(r(h),{type:"info",size:"small",style:{cursor:"pointer"},onClick:e[15]||(e[15]=se=>D(d.value.request.email_otp))},{default:p(()=>[v(" 邮箱OTP: "+c(d.value.request.email_otp),1)]),_:1})])):$("",!0),d.value.request.pin?(_(),C("div",wa,[e[62]||(e[62]=t("span",{class:"cell-label"},"PIN",-1)),u(r(h),{type:"default",size:"small",style:{cursor:"pointer"},onClick:e[16]||(e[16]=se=>D(d.value.request.pin))},{default:p(()=>[v(" PIN: "+c(d.value.request.pin),1)]),_:1})])):$("",!0)]),t("div",ka,[t("div",qa,[e[63]||(e[63]=t("span",{class:"cell-label"},"电话",-1)),t("span",$a,c(d.value.request.phone||"无"),1)]),t("div",Ca,[e[64]||(e[64]=t("span",{class:"cell-label"},"邮箱",-1)),t("span",Sa,c(d.value.request.email||"无"),1)]),t("div",Pa,[e[65]||(e[65]=t("span",{class:"cell-label"},"名字",-1)),t("span",Ia,c(d.value.request.first_name||"无"),1)]),t("div",za,[e[66]||(e[66]=t("span",{class:"cell-label"},"姓氏",-1)),t("span",Da,c(d.value.request.last_name||"无"),1)])]),t("div",Ua,[t("div",Ta,[e[67]||(e[67]=t("span",{class:"cell-label"},"国家",-1)),t("span",Oa,c(d.value.request.country||"无"),1)]),t("div",Na,[e[68]||(e[68]=t("span",{class:"cell-label"},"州/省",-1)),t("span",La,c(d.value.request.state||"无"),1)]),t("div",Ra,[e[69]||(e[69]=t("span",{class:"cell-label"},"城市",-1)),t("span",ja,c(d.value.request.city||"无"),1)]),t("div",Ma,[e[70]||(e[70]=t("span",{class:"cell-label"},"邮编",-1)),t("span",Va,c(d.value.request.zip_code||"无"),1)])]),t("div",Ea,[t("div",Aa,[e[71]||(e[71]=t("span",{class:"cell-label"},"街道地址",-1)),t("span",Ha,c(d.value.request.street_address||"无"),1)])]),t("div",Fa,[t("div",Ba,[e[72]||(e[72]=t("span",{class:"cell-label"},"总支付次数",-1)),t("span",Wa,c(d.value.request.user_statistics.total_payments),1)]),t("div",Ja,[e[73]||(e[73]=t("span",{class:"cell-label"},"完成支付次数",-1)),t("span",Qa,c(d.value.request.user_statistics.completed_payments),1)]),t("div",Ka,[e[74]||(e[74]=t("span",{class:"cell-label"},"成功支付次数",-1)),t("span",Ga,c(d.value.request.user_statistics.successful_payments),1)]),t("div",Za,[e[75]||(e[75]=t("span",{class:"cell-label"},"成功率",-1)),t("span",Xa,c((d.value.request.user_statistics.success_rate*100).toFixed(1))+"%",1)])]),t("div",Ya,[t("div",el,[e[76]||(e[76]=t("span",{class:"cell-label"},"用户ID",-1)),t("span",sl,c(((n=d.value.request.user_info)==null?void 0:n.id)||"无"),1)]),t("div",tl,[e[77]||(e[77]=t("span",{class:"cell-label"},"用户UUID",-1)),t("span",al,c(((f=d.value.request.user_info)==null?void 0:f.uuid)||"无"),1)]),t("div",ll,[e[78]||(e[78]=t("span",{class:"cell-label"},"首次访问",-1)),t("span",il,c(r(Z)((S=d.value.request.user_info)==null?void 0:S.first_seen)||"无"),1)]),t("div",nl,[e[79]||(e[79]=t("span",{class:"cell-label"},"最后访问",-1)),t("span",ol,c(r(Z)((k=d.value.request.user_info)==null?void 0:k.last_seen)||"无"),1)])]),t("div",rl,[t("div",ul,[e[80]||(e[80]=t("span",{class:"cell-label"},"浏览器",-1)),t("span",cl,c(((N=d.value.session.user_agent_parse)==null?void 0:N.browser_name)||"无"),1)]),t("div",dl,[e[81]||(e[81]=t("span",{class:"cell-label"},"浏览器版本",-1)),t("span",pl,c(((A=d.value.session.user_agent_parse)==null?void 0:A.browser_version)||"无"),1)]),t("div",vl,[e[82]||(e[82]=t("span",{class:"cell-label"},"操作系统",-1)),t("span",fl,c(((L=d.value.session.user_agent_parse)==null?void 0:L.browser_os)||"无"),1)]),t("div",gl,[e[83]||(e[83]=t("span",{class:"cell-label"},"平台",-1)),t("span",ml,c(((R=d.value.session.user_agent_parse)==null?void 0:R.browser_platform)||"无"),1)])]),t("div",_l,[t("div",yl,[e[84]||(e[84]=t("span",{class:"cell-label"},"语言",-1)),t("span",bl,c(((F=(M=d.value.session.device_fingerprint)==null?void 0:M.device_info)==null?void 0:F.language)||"无"),1)]),t("div",hl,[e[85]||(e[85]=t("span",{class:"cell-label"},"时区",-1)),t("span",xl,c(((W=(B=d.value.session.device_fingerprint)==null?void 0:B.device_info)==null?void 0:W.timezone)||"无"),1)]),t("div",wl,[e[86]||(e[86]=t("span",{class:"cell-label"},"设备平台",-1)),t("span",kl,c(((Q=(J=d.value.session.device_fingerprint)==null?void 0:J.device_info)==null?void 0:Q.platform)||"无"),1)]),t("div",ql,[e[87]||(e[87]=t("span",{class:"cell-label"},"产品",-1)),t("span",$l,c(((te=(K=d.value.session.device_fingerprint)==null?void 0:K.device_info)==null?void 0:te.product)||"无"),1)])]),t("div",Cl,[t("div",Sl,[e[88]||(e[88]=t("span",{class:"cell-label"},"国家",-1)),t("span",Pl,c(((ae=d.value.session.ip_info)==null?void 0:ae.country)||"无"),1)]),t("div",Il,[e[89]||(e[89]=t("span",{class:"cell-label"},"地区",-1)),t("span",zl,c(((is=d.value.session.ip_info)==null?void 0:is.region)||"无"),1)]),t("div",Dl,[e[90]||(e[90]=t("span",{class:"cell-label"},"城市",-1)),t("span",Ul,c(((ns=d.value.session.ip_info)==null?void 0:ns.city)||"无"),1)]),t("div",Tl,[e[91]||(e[91]=t("span",{class:"cell-label"},"ISP",-1)),t("span",Ol,c(((os=d.value.session.ip_info)==null?void 0:os.isp)||"无"),1)])]),t("div",Nl,[t("div",Ll,[e[92]||(e[92]=t("span",{class:"cell-label"},"客户端ID",-1)),t("span",Rl,c(d.value.session.client_id),1)]),t("div",jl,[e[93]||(e[93]=t("span",{class:"cell-label"},"IP地址",-1)),t("span",Ml,c(d.value.session.ip_address),1)]),t("div",Vl,[e[94]||(e[94]=t("span",{class:"cell-label"},"连接状态",-1)),u(r(h),{type:d.value.session.is_connected?"success":"default",size:"small"},{default:p(()=>[v(c(d.value.session.is_connected?"在线":"离线"),1)]),_:1},8,["type"])])]),t("div",El,[t("div",Al,[e[95]||(e[95]=t("span",{class:"cell-label"},"会话ID",-1)),t("span",Hl,c(d.value.session.session_id),1)])]),t("div",Fl,[t("div",Bl,[e[96]||(e[96]=t("span",{class:"cell-label"},"页面URL",-1)),t("span",Wl,c(d.value.session.page_url),1)])]),t("div",Jl,[t("div",Ql,[e[97]||(e[97]=t("span",{class:"cell-label"},"页面标题",-1)),t("span",Kl,c(d.value.session.page_title),1)])]),t("div",Gl,[t("div",Zl,[e[98]||(e[98]=t("span",{class:"cell-label"},"用户代理",-1)),t("span",Xl,c(d.value.session.user_agent||"无"),1)])])])])):(_(),C("div",Yl,[u(r(Nt),{size:"large"})]))]}),_:1},8,["show","title"]),u(r(G),{show:ke.value,"onUpdate:show":e[19]||(e[19]=a=>ke.value=a),preset:"dialog",title:"添加备注","positive-text":"提交","negative-text":"取消",onPositiveClick:$s},{default:p(()=>[u(r(T),{value:ye.value,"onUpdate:value":e[18]||(e[18]=a=>ye.value=a),type:"textarea",placeholder:"请输入备注内容",rows:4},null,8,["value"])]),_:1},8,["show"]),u(r(G),{show:qe.value,"onUpdate:show":e[23]||(e[23]=a=>qe.value=a),preset:"dialog",title:"OTP验证","positive-text":"发送","negative-text":"取消",onPositiveClick:Ss},{default:p(()=>[t("div",ei,[t("div",si,[u(r(I),null,{default:p(()=>e[99]||(e[99]=[v("短信验证引导")])),_:1})]),ce.value?(_(),C("div",ti,[u(i,{value:ce.value,"onUpdate:value":e[20]||(e[20]=a=>ce.value=a)},null,8,["value"]),u(r(I),{class:"ml-2"},{default:p(()=>e[100]||(e[100]=[v("自定义文案")])),_:1})])):$("",!0),ce.value?(_(),C("div",li,[u(r(T),{value:re.value,"onUpdate:value":e[22]||(e[22]=a=>re.value=a),type:"textarea",placeholder:"请输入自定义验证文案",rows:4},null,8,["value"])])):(_(),C("div",ai,[u(r(T),{value:re.value,"onUpdate:value":e[21]||(e[21]=a=>re.value=a),placeholder:"请输入手机号格式（默认是后3-4位）"},null,8,["value"])]))])]),_:1},8,["show"]),u(r(G),{show:$e.value,"onUpdate:show":e[27]||(e[27]=a=>$e.value=a),preset:"dialog",title:"邮箱OTP验证","positive-text":"发送","negative-text":"取消",onPositiveClick:Is},{default:p(()=>[t("div",ii,[t("div",ni,[u(r(I),null,{default:p(()=>e[101]||(e[101]=[v("邮箱验证引导")])),_:1})]),de.value?(_(),C("div",oi,[u(i,{value:de.value,"onUpdate:value":e[24]||(e[24]=a=>de.value=a)},null,8,["value"]),u(r(I),{class:"ml-2"},{default:p(()=>e[102]||(e[102]=[v("自定义文案")])),_:1})])):$("",!0),de.value?(_(),C("div",ui,[u(r(T),{value:ue.value,"onUpdate:value":e[26]||(e[26]=a=>ue.value=a),type:"textarea",placeholder:"请输入自定义验证文案",rows:4},null,8,["value"])])):(_(),C("div",ri,[u(r(T),{value:ue.value,"onUpdate:value":e[25]||(e[25]=a=>ue.value=a),placeholder:"请输入邮箱（格式：a***@xxx.com），或者根据使用场景来填写"},null,8,["value"])]))])]),_:1},8,["show"]),u(r(G),{show:Ce.value,"onUpdate:show":e[30]||(e[30]=a=>Ce.value=a),preset:"dialog",title:"PIN验证","positive-text":"发送","negative-text":"取消",onPositiveClick:Ds},{default:p(()=>[t("div",ci,[t("div",di,[u(r(I),null,{default:p(()=>e[103]||(e[103]=[v("PIN验证引导")])),_:1})]),pe.value?(_(),C("div",pi,[u(i,{value:pe.value,"onUpdate:value":e[28]||(e[28]=a=>pe.value=a)},null,8,["value"]),u(r(I),{class:"ml-2"},{default:p(()=>e[104]||(e[104]=[v("自定义文案")])),_:1})])):$("",!0),pe.value?(_(),C("div",vi,[u(r(T),{value:ze.value,"onUpdate:value":e[29]||(e[29]=a=>ze.value=a),type:"textarea",placeholder:"请输入自定义验证文案",rows:4},null,8,["value"])])):$("",!0)])]),_:1},8,["show"]),u(r(G),{show:Se.value,"onUpdate:show":e[33]||(e[33]=a=>Se.value=a),preset:"dialog",title:"APP验证","positive-text":"发送","negative-text":"取消",onPositiveClick:Ts},{default:p(()=>[t("div",fi,[t("div",gi,[u(r(I),null,{default:p(()=>e[105]||(e[105]=[v("APP验证引导")])),_:1})]),ve.value?(_(),C("div",mi,[u(i,{value:ve.value,"onUpdate:value":e[31]||(e[31]=a=>ve.value=a)},null,8,["value"]),u(r(I),{class:"ml-2"},{default:p(()=>e[106]||(e[106]=[v("自定义文案")])),_:1})])):$("",!0),ve.value?(_(),C("div",_i,[u(r(T),{value:De.value,"onUpdate:value":e[32]||(e[32]=a=>De.value=a),type:"textarea",placeholder:"请输入自定义验证文案",rows:4},null,8,["value"])])):$("",!0)])]),_:1},8,["show"]),u(r(G),{show:Pe.value,"onUpdate:show":e[35]||(e[35]=a=>Pe.value=a),preset:"dialog",title:"拒绝支付","positive-text":"发送","negative-text":"取消",onPositiveClick:Ns},{default:p(()=>[t("div",yi,[u(r(I),null,{default:p(()=>e[107]||(e[107]=[v("自定义拒绝文案")])),_:1})]),u(r(T),{value:Ue.value,"onUpdate:value":e[34]||(e[34]=a=>Ue.value=a),type:"textarea",placeholder:"不输入则显示系统默认(支持HTML标签)",rows:4},null,8,["value"])]),_:1},8,["show"]),u(r(G),{show:Ie.value,"onUpdate:show":e[39]||(e[39]=a=>Ie.value=a),preset:"dialog",title:"断开并拉黑","positive-text":"确认拉黑","negative-text":"取消",onPositiveClick:js},{default:p(()=>[t("div",bi,[t("div",null,[u(r(I),{class:"mb-2 block"},{default:p(()=>e[108]||(e[108]=[v("黑名单类型")])),_:1}),u(r(le),{value:V.blacklist_type,"onUpdate:value":e[36]||(e[36]=a=>V.blacklist_type=a),options:ms,placeholder:"选择黑名单类型"},null,8,["value"])]),t("div",null,[u(r(I),{class:"mb-2 block"},{default:p(()=>e[109]||(e[109]=[v("重定向URL（可选）")])),_:1}),u(r(T),{value:V.redirect_url,"onUpdate:value":e[37]||(e[37]=a=>V.redirect_url=a),placeholder:"留空使用默认跳转页面"},null,8,["value"])]),t("div",null,[u(r(I),{class:"mb-2 block"},{default:p(()=>e[110]||(e[110]=[v("备注说明")])),_:1}),u(r(T),{value:V.notes,"onUpdate:value":e[38]||(e[38]=a=>V.notes=a),type:"textarea",placeholder:"请输入拉黑原因或备注信息",rows:4},null,8,["value"])])])]),_:1},8,["show"]),u(r(G),{show:we.value,"onUpdate:show":e[40]||(e[40]=a=>we.value=a),preset:"card",title:"卡片模拟图",style:{width:"600px"},"mask-closable":!0},{default:p(()=>{var a,n,f,S,k,N,A,L,R,M,F,B,W,J,Q,K;return[z.value?(_(),C("div",hi,[t("div",xi,[t("div",wi,[e[111]||(e[111]=t("div",{class:"chip-logo"},[t("div",{class:"chip"})],-1)),t("div",ki,[t("img",{src:Ge(z.value.card_type),alt:Ze(z.value.card_type),class:"brand-logo"},null,8,qi)])]),t("div",$i,c(z.value.card_number?z.value.card_number.replace(/(\d{4})(?=\d)/g,"$1 "):"5144 4024 6292 7009"),1),t("div",Ci,[t("div",Si,[e[112]||(e[112]=t("div",{class:"label"},"Card Holder",-1)),t("div",Pi,c(z.value.card_holder||"Adrian Orbe"),1)]),t("div",Ii,[e[113]||(e[113]=t("div",{class:"label"},"Expires",-1)),t("div",zi,c(z.value.expiry_date||"09/26"),1)]),t("div",Di,[e[114]||(e[114]=t("div",{class:"label"},"CVV",-1)),t("div",Ui,c(z.value.cvv||"825"),1)])])]),(a=z.value)!=null&&a.card_info?(_(),C("div",Ti,[e[120]||(e[120]=t("h3",null,"🏦 Card Info 详细信息",-1)),t("div",Oi,[t("div",Ni,[e[115]||(e[115]=t("span",{class:"info-label"},"🔢 BIN",-1)),t("span",Li,c(((f=(n=z.value)==null?void 0:n.card_info)==null?void 0:f.bin)||"未知"),1)]),t("div",Ri,[e[116]||(e[116]=t("span",{class:"info-label"},"🏷️ 品牌",-1)),t("span",ji,c(((k=(S=z.value)==null?void 0:S.card_info)==null?void 0:k.brand)||"未知"),1)]),t("div",Mi,[e[117]||(e[117]=t("span",{class:"info-label"},"💳 卡片类型",-1)),t("span",Vi,c(((A=(N=z.value)==null?void 0:N.card_info)==null?void 0:A.card_type)||"未知"),1)]),t("div",Ei,[e[118]||(e[118]=t("span",{class:"info-label"},"🌐 国家",-1)),t("span",Ai,c(((M=(R=(L=z.value)==null?void 0:L.card_info)==null?void 0:R.country)==null?void 0:M.name)||"未知")+" "+c(((W=(B=(F=z.value)==null?void 0:F.card_info)==null?void 0:B.country)==null?void 0:W.emoji)||""),1)]),t("div",Hi,[e[119]||(e[119]=t("span",{class:"info-label"},"🏛️ 银行",-1)),t("span",Fi,c(((K=(Q=(J=z.value)==null?void 0:J.card_info)==null?void 0:Q.bank)==null?void 0:K.name)||"未知"),1)])])])):$("",!0)])):$("",!0)]}),_:1},8,["show"]),u(r(G),{show:xe.value,"onUpdate:show":e[44]||(e[44]=a=>xe.value=a),preset:"dialog",title:"导出支付请求数据","positive-text":"开始导出","negative-text":"取消","positive-button-props":{loading:Re.value},style:{width:"600px"},onPositiveClick:xt},{default:p(()=>[t("div",Bi,[t("div",Wi,[e[121]||(e[121]=t("h4",null,"导出模式",-1)),u(r(le),{value:y.export_mode,"onUpdate:value":e[41]||(e[41]=a=>y.export_mode=a),options:Be,placeholder:"选择导出模式"},null,8,["value"]),t("div",Ji,[u(r(I),{depth:"3",style:{"font-size":"12px"}},{default:p(()=>{var a;return[v(c((a=Be.find(n=>n.value===y.export_mode))==null?void 0:a.description),1)]}),_:1})])]),t("div",Qi,[e[122]||(e[122]=t("h4",null,"导出格式",-1)),u(r(le),{value:y.format,"onUpdate:value":e[42]||(e[42]=a=>y.format=a),options:ds,placeholder:"选择导出格式"},null,8,["value"])]),t("div",Ki,[e[124]||(e[124]=t("h4",null,"额外筛选",-1)),u(r(ge),{vertical:""},{default:p(()=>[t("div",null,[u(r(I),null,{default:p(()=>e[123]||(e[123]=[v("卡片类型：")])),_:1}),u(r(le),{value:y.card_type,"onUpdate:value":e[43]||(e[43]=a=>y.card_type=a),options:ps,placeholder:"选择卡片类型",style:{width:"200px","margin-left":"8px"},clearable:""},null,8,["value"])])]),_:1})]),t("div",Gi,[e[126]||(e[126]=t("h4",null,"当前搜索条件",-1)),t("div",Zi,[y.status?(_(),Y(r(h),{key:0,type:"info",size:"small"},{default:p(()=>{var a;return[v(" 状态: "+c(((a=oe[y.status])==null?void 0:a.label)||y.status),1)]}),_:1})):$("",!0),y.is_completed!==void 0?(_(),Y(r(h),{key:1,type:"info",size:"small"},{default:p(()=>[v(" 完成状态: "+c(y.is_completed?"已完成":"未完成"),1)]),_:1})):$("",!0),y.success!==void 0?(_(),Y(r(h),{key:2,type:"info",size:"small"},{default:p(()=>[v(" 成功状态: "+c(y.success?"成功":"失败"),1)]),_:1})):$("",!0),y.user_uuid?(_(),Y(r(h),{key:3,type:"info",size:"small"},{default:p(()=>[v("用户UUID: "+c(y.user_uuid),1)]),_:1})):$("",!0),y.client_id?(_(),Y(r(h),{key:4,type:"info",size:"small"},{default:p(()=>[v("客户端ID: "+c(y.client_id),1)]),_:1})):$("",!0),y.ip_address?(_(),Y(r(h),{key:5,type:"info",size:"small"},{default:p(()=>[v("IP地址: "+c(y.ip_address),1)]),_:1})):$("",!0),y.start_date?(_(),Y(r(h),{key:6,type:"info",size:"small"},{default:p(()=>[v(" 开始时间: "+c(new Date(y.start_date).toLocaleString()),1)]),_:1})):$("",!0),y.end_date?(_(),Y(r(h),{key:7,type:"info",size:"small"},{default:p(()=>[v(" 结束时间: "+c(new Date(y.end_date).toLocaleString()),1)]),_:1})):$("",!0),Object.values(y).some(a=>a!==void 0&&a!=="")?$("",!0):(_(),Y(r(I),{key:8,depth:"3"},{default:p(()=>e[125]||(e[125]=[v(" 无筛选条件，将导出所有数据 ")])),_:1}))])]),t("div",Xi,[u(r(ge),null,{default:p(()=>[u(r(X),{size:"small",type:"tertiary",onClick:wt},{default:p(()=>e[127]||(e[127]=[v("重置配置")])),_:1})]),_:1})])])]),_:1},8,["show","positive-button-props"]),u(r(G),{show:Te.value,"onUpdate:show":e[48]||(e[48]=a=>Te.value=a),preset:"dialog",title:"快速添加卡头备注","positive-text":"确定","negative-text":"取消",onPositiveClick:it},{default:p(()=>[t("div",Yi,[t("div",null,[u(r(I),{class:"mb-2 block"},{default:p(()=>e[128]||(e[128]=[v("卡号")])),_:1}),u(r(T),{value:Qe.value,disabled:"",placeholder:"当前选择的卡号"},null,8,["value"])]),t("div",null,[u(r(I),{class:"mb-2 block"},{default:p(()=>e[129]||(e[129]=[v("卡头 *")])),_:1}),u(r(T),{value:H.card_prefix,"onUpdate:value":e[45]||(e[45]=a=>H.card_prefix=a),placeholder:"系统自动提取，可手动调整",maxlength:"8"},null,8,["value"]),u(r(I),{depth:"3",class:"mt-1 text-sm"},{default:p(()=>e[130]||(e[130]=[v("卡头必须是6-8位数字，系统已自动提取前6位")])),_:1})]),t("div",null,[u(r(I),{class:"mb-2 block"},{default:p(()=>e[131]||(e[131]=[v("备注内容 *")])),_:1}),u(r(T),{value:H.note_content,"onUpdate:value":e[46]||(e[46]=a=>H.note_content=a),type:"textarea",placeholder:"请输入备注内容",rows:3,maxlength:"200","show-count":""},null,8,["value"])]),t("div",null,[u(r(I),{class:"mb-2 block"},{default:p(()=>e[132]||(e[132]=[v("标签颜色")])),_:1}),u(r(le),{value:H.tag_color,"onUpdate:value":e[47]||(e[47]=a=>H.tag_color=a),options:Je.value.map(a=>({label:a.name,value:a.value,color:a.color})),placeholder:"选择标签颜色"},null,8,["value","options"])])])]),_:1},8,["show"])])}}}),vn=Rt(en,[["__scopeId","data-v-b41558a0"]]);export{vn as default};
