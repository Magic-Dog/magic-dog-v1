import{r as jn,ar as wt,as as un,ak as dn,a as Wn,i as Gn,at as nt,n as Pn,au as Yn,$ as fn}from"./index-DatkZRbF.js";const Rt="undefined",Y=Promise,kt=e=>Y.resolve(e),Ht=e=>Y.reject(e),Fe=Object,It=RegExp,m=void 0,Bt=null,w=!0,v=!1,we=(e,t,n)=>e.then(t,n),Be=(e,t)=>e.catch(t),Mn=(e,t)=>e.finally(t),zt=(e,t,n)=>JSON.stringify(e,t,n),Qn=e=>JSON.parse(e),lt=(e,t=0)=>setTimeout(e,t),Pt=e=>clearTimeout(e),pe=e=>Fe.keys(e),Mt=e=>Fe.values(e),re=(e,t)=>e.forEach(t),J=(e,...t)=>e.push(...t),ie=(e,t)=>e.map(t),me=(e,t)=>e.filter(t),Xn=e=>e.shift(),Me=(e,t,n=0,...s)=>e.splice(t,n,...s),k=e=>e.length,fe=e=>Array.isArray(e),Ae=(e,t)=>delete e[t],ut=e=>typeof e,st=(e,t)=>e.includes(t),Jn=typeof window===Rt&&(typeof process!==Rt?typeof process.cwd=="function":typeof Deno!==Rt),We="memory",De="restore",X=()=>{},Ge=e=>e,K=e=>ut(e)==="function",de=e=>ut(e)==="number"&&!Number.isNaN(e),Ye=e=>ut(e)==="string",At=e=>e!==Bt&&ut(e)==="object",jt=e=>Fe.prototype.toString.call(e),ve=e=>jt(e)==="[object Object]",se=(e,t)=>e instanceof t,be=e=>e?e.getTime():Date.now(),Ee=e=>e.context,Ue=e=>e.config,An=e=>e.options,Zn=e=>An(Ee(e)),es=e=>{const{params:t,headers:n}=Ue(e);return zt([e.type,e.url,t,e.data,n])},le=e=>e.key,Dn=(e,t,n=[])=>{const s=K(e)?e(...n):e;return t(!!s.key,"hook handler must be a method instance or a function that returns method instance"),s},Wt=e=>{const t=jt(e);return/^\[object (Blob|FormData|ReadableStream|URLSearchParams)\]$/i.test(t)||se(e,ArrayBuffer)},Qe=(e,...t)=>Fe.assign(e,...t),ts=(e,...t)=>{const n={};for(const s in e)t.includes(s)||(n[s]=e[s]);return n};function Un(){let e,t;return{promise:new Promise((s,o)=>{e=s,t=o}),resolve:e,reject:t}}const Xe=e=>{const{cacheFor:t}=Ue(e),n=u=>de(u)?be()+u:be(u||m);let s=We,o=()=>0,r=v,a=m;const l=K(t);if(!l){let u=t;if(ve(t)){const{mode:h=We,expire:c,tag:i}=t||{};s=h,r=h===De,a=i?i.toString():m,u=c}o=h=>n(K(u)?u({method:e,mode:h}):u)}return{f:t,c:l,e:o,m:s,s:r,t:a}},O=(e,...t)=>new e(...t),Gt=(e,t=[])=>K(e)?e(...t):e,ns=(e,t)=>K(e)?e:[v,Bt].includes(e)?X:t,ss=(e=0)=>{let t=m;return n=>{t&&clearTimeout(t),t=lt(n,e)}},os=(e=v)=>{const t=[];let n=m,s=!1;const o=async()=>{for(s=!0;k(t)>0;){const l=Xn(t);l&&await l()}n&&n(),s=!1};return{addQueue:l=>O(Y,(u,h)=>{J(t,()=>we(l(),u,i=>{e?u(m):h(i)})),s||o()}),onComplete:l=>{n=l}}},ot=(e,t,n=w,s,o)=>{const r=()=>{o&&s&&(e=t(e,s,o),e!==o[s]&&(o[s]=e))};if(n&&r(),At(e))for(const a in e)se(e,String)||ot(e[a],t,n,a,e);return!n&&r(),e},as="$a.",dt=(e,t)=>as+e+t,rs=(e,t,n)=>{e=e.endsWith("/")?e.slice(0,-1):e,t!==""&&(t=t.match(/^(\/|https?:\/\/)/)?t:`/${t}`);const s=e+t,o=ie(me(pe(n),r=>n[r]!==m),r=>`${r}=${n[r]}`).join("&");return o?+s.includes("?")?`${s}&${o}`:`${s}?${o}`:s},Dt=e=>{if(fe(e))return ie(e,Dt);if(ve(e)){const t={};return re(pe(e),n=>{t[n]=Dt(e[n])}),t}return e};class On extends Error{constructor(t,n,s){super(n+(s?`

For detailed: https://alova.js.org/error#${s}`:"")),this.name=`[alova${t?`/${t}`:""}]`}}const Ve=(e="")=>(t,n,s)=>{if(!t)throw O(On,e,n,s)},ft=()=>{const e={};return{eventMap:e,on(t,n){const s=e[t]=e[t]||[];return J(s,n),()=>{e[t]=me(s,o=>o!==n)}},off(t,n){const s=e[t];if(s)if(n){const o=s.indexOf(n);o>-1&&s.splice(o,1)}else delete e[t]},emit(t,n){const s=e[t]||[];return ie(s,o=>o(n))}}};class Ie{constructor(t,n,s,o){this.s=t,this.k=n,this.$dhy=s,this.$exp=o}get v(){return this.$dhy(this.s)}get e(){return this.$exp(this.s)}}class hn extends Ie{constructor(t,n,s,o,r){super(t,n,s,o),this.$upd=r}set v(t){this.$upd(this.s,t)}get v(){return super.v}}let ht={autoHitCache:"global",ssr:Jn};const Ze="color: black; font-size: 12px; font-weight: bolder";var cs=(e,t,n,s)=>{const o=console,r=(...d)=>console.log(...d),{url:a}=t,l=n===De,u="\x1B[42m%s\x1B[49m",h="\x1B[32m%s\x1B[39m",c=` [HitCache]${a} `,i=()=>Array(k(c)+1).join("^");ht.ssr?(r(u,c),r(h," Cache ",e),r(h," Mode  ",n),l&&r(h," Tag   ",s),r(h,i())):(o.groupCollapsed?o.groupCollapsed("%cHitCache","padding: 2px 6px; background: #c4fcd3; color: #53b56d;",a):r(u,c),r("%c[Cache]",Ze,e),r("%c[Mode]",Ze,n),l&&r("%c[Tag]",Ze,s),r("%c[Method]",Ze,t),o.groupEnd?o.groupEnd():r(h,i()))};const Ut=e=>`hss.${e}`,Ln="hsr.",Ot=e=>Ln+e,at="$$hsrs",Fn="__$<>$__",Lt=(e,t)=>{e[t]=0},ze=async(e,t,n,s,o,r,a)=>{if(s>be()&&n){const l=dt(e,t);if(await o.set(l,me([n,s===1/0?m:s,a],Boolean)),r){const u={},h=[];re(r,d=>{const f=se(d,It),E=f?d.source+(d.flags?Fn+d.flags:""):d;E&&(f&&!u[E]&&J(h,E),Lt(u,f?Ot(E):Ut(E)))});const c=ie(pe(u),async d=>{const f=await o.get(d)||{};Lt(f,l),await o.set(d,f)}),i=async()=>{if(k(h)){const d=await o.get(at)||[];J(d,...h),await o.set(at,d)}};await Y.all([...c,i()])}}},Ft=async(e,t,n)=>{const s=dt(e,t);await n.remove(s)},Vn=async(e,t,n,s)=>{const o=await n.get(dt(e,t));if(o){const[r,a,l]=o;if(l===s&&(!a||a>be()))return o;await Ft(e,t,n)}},ke=async(e,t,n,s)=>{const o=await Vn(e,t,n,s);return o?o[0]:m},pn=async e=>Y.all(e.map(t=>t.clear())),is=async(e,t,n)=>{const s=`${t}`,o={},r=Ut(e);o[r]=await n.get(r);let a;if(t){const c=Ut(s);o[c]=await n.get(c),a=await n.get(at);const i=[];a&&k(a)&&(re(a,d=>{const[f,E]=d.split(Fn);O(It,f,E).test(s)&&J(i,d)}),await Y.all(ie(i,async d=>{const f=Ot(d);o[f]=await n.get(f)})))}const l=async c=>{try{await n.remove(c);for(const i in o){const d=o[i];d&&Ae(d,c)}}catch{}},u={};await Y.all(ie(pe(o),async c=>{const i=o[c];if(i){const d=[];for(const f in i)u[f]||(Lt(u,f),J(d,l(f)));await Y.all(d)}}));const h=k(a||[]);await Y.all(ie(pe(o),async c=>{const i=o[c];i&&(k(pe(i))?await n.set(c,i):(await n.remove(c),c.includes(Ln)&&a&&(a=me(a,d=>Ot(d)!==c))))})),h!==k(a||[])&&await n.set(at,a)};var ls=e=>{const{data:t,config:n}=e,s={...n},{headers:o={},params:r={}}=s,a=Ee(e);s.headers={...o},s.params={...r};const l=O(ue,e.type,a,e.url,s,t);return Qe(l,{...e,config:s})};const Vt=async(e,{policy:t="all"}={})=>{if(e&&e.key){const{id:n,l1Cache:s,l2Cache:o}=Ee(e),r=le(e),{f:a,c:l,s:u,e:h,t:c}=Xe(e);if(l)return a();let i=t!=="l2"?await ke(n,r,s):m;return t==="l2"?i=await ke(n,r,o,c):t==="all"&&!i&&u&&h(De)>be()&&(i=await ke(n,r,o,c)),i}},_t=async(e,t,{policy:n="all"}={})=>{const o=(fe(e)?e:[e]).map(async r=>{const{hitSource:a}=r,{id:l,l1Cache:u,l2Cache:h}=Ee(r),c=le(r),{e:i,s:d,t:f,c:E}=Xe(r);if(E)return;let T=t;if(K(t)){let P=n!=="l2"?await ke(l,c,u):m;if((n==="l2"||n==="all"&&!P&&d&&i(De)>be())&&(P=await ke(l,c,h,f)),T=t(P),T===m)return}return Y.all([n!=="l2"&&ze(l,c,T,i(We),u,a),n==="l2"||n==="all"&&d?ze(l,c,T,i(De),h,a,f):m])});return Y.all(o)},us=async e=>{if(!e){await Y.all([pn(rt),pn(ct)]);return}const n=(fe(e)?e:[e]).map(s=>{const{id:o,l1Cache:r,l2Cache:a}=Ee(s),{c:l}=Xe(s);if(l)return;const u=le(s);return Y.all([Ft(o,u,r),Ft(o,u,a)])});await Y.all(n)},ds=async e=>{const{autoHitCache:t}=ht,{l1Cache:n,l2Cache:s}=Ee(e),o=le(e),{name:r}=Ue(e),a={global:[...rt,...ct],self:[n,s],close:[]}[t];a&&k(a)&&await Y.all(ie(a,l=>is(o,r,l)))},mn={};function fs(e,t){let n=w,s;const o=O(Y,a=>{s=a});return{abort:()=>{we(o,a=>a&&a.abort())},onDownload:a=>{we(o,l=>l&&l.onDownload&&l.onDownload(a))},onUpload:a=>{we(o,l=>l&&l.onUpload&&l.onUpload(a))},response:async()=>{const{beforeRequest:a=X,responded:l,requestAdapter:u,cacheLogger:h}=Zn(e),c=le(e),{s:i,t:d,m:f,e:E}=Xe(e),{id:T,l1Cache:P,l2Cache:C,snapshots:M}=Ee(e),{cacheFor:L}=Ue(e),{hitSource:F}=e;let j=await(K(L)?L():t?m:ke(T,c,P));if(f===De&&!j){const H=await Vn(T,c,C,d);if(H){const[ae,ce]=H;await ze(T,c,ae,ce,P,F),j=ae}}const V=ls(e);await a(V);const{baseURL:W,url:b,type:D,data:x}=V,{params:S={},headers:G={},transform:A=Ge,shareRequest:Q}=Ue(V),q=mn[T]=mn[T]||{},$=V.data,R=Wt($);let _=R?m:q[c],I=Ge,N=m,te=X;if(K(l))I=l;else if(ve(l)){const{onSuccess:H,onError:ae,onComplete:ce}=l;I=K(H)?H:I,N=K(ae)?ae:N,te=K(ce)?ce:te}if(j!==m)return s(),V.fromCache=w,ns(h,cs)(j,V,f,d),te(V),j;if(n=v,!Q||!_){const H=u({url:rs(W,b,S),type:D,data:x,headers:G},V);_=q[c]=H}s(_);const oe=async(H,ae,ce=w)=>{const Ce=await H,ge=await A(Ce,ae||{});M.save(e);try{await ds(V)}catch{}if((!$||!R)&&ce)try{await Y.all([ze(T,c,ge,E(We),P,F),i&&ze(T,c,ge,E(De),C,F,d)])}catch{}return Dt(ge)};return Mn(we(Y.all([_.response(),_.headers()]),([H,ae])=>(Ae(q,c),oe(I(H,V),ae)),H=>(Ae(q,c),K(N)?oe(N(H,V),m,v):Ht(H))),()=>{te(V)})},fromCache:()=>n}}const gn=(e,t)=>()=>{const n=t.indexOf(e);n>=0&&t.splice(n,1)};class ue{constructor(t,n,s,o,r){this.dhs=[],this.uhs=[],this.fromCache=m;const a=()=>{a.a()};a.a=X;const l=this,u=An(n);l.abort=a,l.baseURL=u.baseURL||"",l.url=s,l.type=t,l.context=n;const h={},c="cacheFor",i=ve(u[c])?u[c][t]:m,d=o&&o.hitSource;re(["timeout","shareRequest"],f=>{u[f]!==m&&(h[f]=u[f])}),i!==m&&(h[c]=i),d&&(l.hitSource=ie(fe(d)?d:[d],f=>se(f,ue)?le(f):f),Ae(o,"hitSource")),l.config={...h,headers:{},params:{},...o||{}},l.data=r,l.meta=o?o.meta:l.meta,l.key=l.generateKey()}onDownload(t){return J(this.dhs,t),gn(t,this.dhs)}onUpload(t){return J(this.uhs,t),gn(t,this.uhs)}send(t=v){const n=this,{response:s,onDownload:o,onUpload:r,abort:a,fromCache:l}=fs(n,t);return k(n.dhs)>0&&o((u,h)=>re(n.dhs,c=>c({loaded:u,total:h}))),k(n.uhs)>0&&r((u,h)=>re(n.uhs,c=>c({loaded:u,total:h}))),n.abort.a=a,n.fromCache=m,n.promise=we(s(),u=>(n.fromCache=l(),u)),n.promise}setName(t){Ue(this).name=t}generateKey(){return es(this)}then(t,n){return we(this.send(),t,n)}catch(t){return Be(this.send(),t)}finally(t){return Mn(this.send(),t)}}const pt=Ve(),Re="success",hs=()=>{let e={};const t=ft();return{set(s,o){e[s]=o,t.emit(Re,{type:"set",key:s,value:o,container:e})},get:s=>{const o=e[s];return t.emit(Re,{type:"get",key:s,value:o,container:e}),o},remove(s){Ae(e,s),t.emit(Re,{type:"remove",key:s,container:e})},clear:()=>{e={},t.emit(Re,{type:"clear",key:"",container:e})},emitter:t}},ye=()=>(pt(typeof localStorage<"u","l2Cache is not defined."),localStorage),ps=()=>{const e=ft();return{set:(n,s)=>{ye().setItem(n,zt(s)),e.emit(Re,{type:"set",key:n,value:s,container:ye()})},get:n=>{const s=ye().getItem(n),o=s&&Qn(s);return e.emit(Re,{type:"get",key:n,value:o,container:ye()}),o},remove:n=>{ye().removeItem(n),e.emit(Re,{type:"remove",key:n,container:ye()})},clear:()=>{ye().clear(),e.emit(Re,{type:"clear",key:"",container:ye()})},emitter:e}},Sn=Set;class ms{constructor(t){this.records={},this.occupy=0,pt(t>=0,"expected snapshots limit to be >= 0"),this.capacity=t}save(t){const{name:n}=Ue(t),{records:s,occupy:o,capacity:r}=this;n&&o<r&&((s[n]=s[n]||O(Sn)).add(t),this.occupy+=1)}match(t,n=!0){let s,o,r,a=t;ve(t)&&(a=t.name,r=t.filter),se(a,It)?o=a:Ye(a)&&(s=a);const{records:l}=this;let u=O(Sn);s?u=l[s]||u:o&&re(me(pe(l),c=>o.test(c)),c=>{l[c].forEach(i=>u.add(i))});const h=K(r)?me([...u],r):[...u];return n?h:h[0]}}const qn="GET",gs="HEAD",Ss="POST",vs="PUT",Es="PATCH",Cs="DELETE",ys="OPTIONS",vn={cacheFor:{[qn]:3e5},shareRequest:w,snapshots:1e3};let ws=0;class Rs{constructor(t){var n,s;const o=this;o.id=(t.id||(ws+=1)).toString(),o.l1Cache=t.l1Cache||hs(),o.l2Cache=t.l2Cache||ps(),o.options={...vn,...t},o.snapshots=O(ms,(s=(n=t.snapshots)!==null&&n!==void 0?n:vn.snapshots)!==null&&s!==void 0?s:0)}Get(t,n){return O(ue,qn,this,t,n)}Post(t,n,s){return O(ue,Ss,this,t,s,n)}Delete(t,n,s){return O(ue,Cs,this,t,s,n)}Put(t,n,s){return O(ue,vs,this,t,s,n)}Head(t,n){return O(ue,gs,this,t,n)}Patch(t,n,s){return O(ue,Es,this,t,s,n)}Options(t,n){return O(ue,ys,this,t,n)}}let je=m;const rt=[],ct=[],_s=e=>{const t=O(Rs,e),n=t.options.statesHook;je&&pt(je===n,"expected to use the same `statesHook`"),je=n;const{l1Cache:s,l2Cache:o}=t;return!rt.includes(s)&&J(rt,s),!ct.includes(o)&&J(ct,o),t},Oe=()=>(pt(!!je,"`statesHook` is not set in alova instance"),je);var Ts={name:"Vue",create:e=>jn(e),dehydrate:e=>e.value,update:(e,t)=>{t.value=e},effectRequest({handler:e,removeStates:t,immediate:n,watchingStates:s}){wt()&&un(t),n&&e(),re(s||[],(o,r)=>{dn(o,()=>{e(r)},{deep:w})})},computed:e=>Wn(e),watch:(e,t)=>{dn(e,t,{deep:w})},onMounted:e=>{wt()?Gn(e):lt(e,10)},onUnmounted:e=>{wt()&&un(e)}};const bs=e=>Ye(e)||Wt(e);function Yt(){return(e,t)=>{const n=t.config,s=n.timeout||0,o=new AbortController,{data:r,headers:a}=e,l=/content-type/i.test(Fe.keys(a).join()),u=r&&r.toString()==="[object FormData]";!l&&!u&&(a["Content-Type"]="application/json;charset=UTF-8");const h=fetch(e.url,{...n,method:e.type,signal:o.signal,body:bs(r)?r:zt(r)});let c,i=v;return s>0&&(c=lt(()=>{i=w,o.abort()},s)),{response:()=>h.then(d=>(Pt(c),d.clone()),d=>Ht(i?O(Error,"fetchError: network timeout"):d)),headers:()=>h.then(({headers:d})=>d,()=>({})),onDownload:async d=>{let f=v;const E=await h.catch(()=>{f=w});if(!E)return;const{headers:T,body:P}=E.clone(),C=P?P.getReader():m,M=Number(T.get("Content-Length")||T.get("content-length")||0);if(M<=0)return;let L=0;if(C){const F=()=>C.read().then(({done:j,value:V=new Uint8Array})=>{if(j||f)f&&d(M,0);else return L+=V.byteLength,d(M,L),F()});F()}},onUpload(){console.error("fetch API does'nt support uploading progress. please consider to change `@alova/adapter-xhr` or `@alova/adapter-axios`")},abort:()=>{o.abort(),Pt(c)}}}}const Tt={authRole:null},et={authRole:"login"},xs={authRole:"logout"},tt={authRole:"refreshToken"},he=({meta:e},t)=>{if(ve(e)){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const s=t[n];if(se(s,RegExp)?s.test(e[n]):e[n]===s)return w}}return v},Nn=(e,t)=>O(Y,n=>{J(t,{method:e,resolve:n})}),En=(e,t,n,s)=>{if(he(e,(t==null?void 0:t.metaMatches)||n))return(K(t)?t:ve(t)&&K(t.handler)?t.handler:X)(s,e)},Cn=async(e,t,n,s,o,r)=>{const a=k(s)>=2;let l=o==null?void 0:o.isExpired(...s);if(se(l,Y)&&(l=await l),l)try{let u=w;if(a&&r&&(u=v,await Nn(e,t)),u&&(n(w),await(o==null?void 0:o.handler(...s)),n(v),re(t,({resolve:h})=>h())),a){const{config:h}=e,c=h.transform;h.transform=m;const i=await e;return h.transform=c,i}}finally{n(v),Me(t,0,k(t))}},Ps=e=>{let t=m,n=m,s=m;if(K(e))t=e;else if(ve(e)){const{onSuccess:o,onError:r,onComplete:a}=e;t=K(o)?o:t,n=K(r)?r:n,s=K(a)?a:s}return{onSuccess:t,onError:n,onComplete:s}},Ms=({visitorMeta:e,login:t,logout:n,refreshTokenOnSuccess:s,refreshTokenOnError:o,assignToken:r=X})=>{let a=v;const l=[];return{waitingList:l,onAuthRequired:c=>async i=>{const d=he(i,e||Tt),f=he(i,(t==null?void 0:t.metaMatches)||et);return!d&&!f&&!he(i,(s==null?void 0:s.metaMatches)||tt)&&!he(i,(o==null?void 0:o.metaMatches)||tt)&&a&&await Nn(i,l),!d&&!f&&await r(i),c==null?void 0:c(i)},onResponseRefreshToken:c=>{const i=Ps(c);return{...i,onSuccess:async(d,f)=>{if(!he(f,e||Tt)&&!he(f,(t==null?void 0:t.metaMatches)||et)&&!he(f,(s==null?void 0:s.metaMatches)||tt)){const E=await Cn(f,l,T=>{a=T},[d,f],s,a);if(E)return E}return await En(f,t,et,d),await En(f,n,xs,d),(i.onSuccess||Ge)(d,f)},onError:async(d,f)=>{if(!he(f,e||Tt)&&!he(f,(t==null?void 0:t.metaMatches)||et)&&!he(f,(o==null?void 0:o.metaMatches)||tt)){const E=await Cn(f,l,T=>{a=T},[d,f],o,a);if(E)return E}return(i.onError||X)(d,f)}}}}},As=(e,t)=>{let n=Bt;return function(...o){const r=e.bind(this,...o),a=de(t)?t:t(...o);n&&Pt(n),a>0?n=lt(r,a):r()}},Ds=(e,t)=>{const n={};for(const s in e)n[s]=t(e[s],s,e);return n};var Se;(function(e){e[e.USE_REQUEST=1]="USE_REQUEST",e[e.USE_WATCHER=2]="USE_WATCHER",e[e.USE_FETCHER=3]="USE_FETCHER"})(Se||(Se={}));function He(e,t={trackedKeys:{},bindError:v}){const n=c=>e.ref?e.ref(c):{current:c};t=n(t).current;const s=c=>(e.export||Ge)(c,t),o=c=>{if(!K(e.memorize))return c;const i=e.memorize(c);return i.memorized=!0,i},{dehydrate:r}=e,a=(c,i,d)=>c!==r(i,d,t)&&t.trackedKeys[d]&&e.update(c,i,d,t),l=c=>ie(c,i=>se(i,Ie)?i.e:i),u=[],h={};return{create:(c,i)=>(J(u,i),O(hn,e.create(c,i,t),i,d=>r(d,i,t),s,(d,f)=>a(f,d,i))),computed:(c,i,d)=>(re(i,f=>{f.k&&(h[f.k]=!0)}),O(Ie,e.computed(c,l(i),d,t),d,f=>r(f,d,t),s)),effectRequest:c=>e.effectRequest(c,t),ref:n,watch:(c,i)=>e.watch(l(c),i,t),onMounted:c=>e.onMounted(c,t),onUnmounted:c=>e.onUnmounted(c,t),memorize:o,__referingObj:t,exposeProvider:c=>{const i={},d={};for(const C in c){const M=c[C];if(K(M)&&!t.trackedKeys[C])i[C]=C.startsWith("on")?(...F)=>(M(...F),P):M.memorized?M:o(M);else{const F=se(M,Ie);F&&(d[C]=M.s),Fe.defineProperty(i,C,{get:()=>(t.trackedKeys[C]=w,F?M.e:M),set:X,enumerable:w,configurable:w})}}const{update:f,__proxyState:E}=i;t.trackedKeys={...h},t.bindError=v;const T={__referingObj:t,update:o(C=>{pe(C).forEach(M=>{st(u,M)?a(C[M],d[M],M):M in i&&K(f)&&f({[M]:C[M]})})}),__proxyState:o(C=>st(u,C)&&se(c[C],Ie)?(t.trackedKeys[C]=w,c[C]):E(C))},P=Qe(i,T);return P},objectify:(c,i)=>c.reduce((d,f)=>(d[f.k]=i?f[i]:f,d),{}),transformState2Proxy:(c,i)=>O(hn,c,i,d=>r(d,i,t),s,(d,f)=>a(f,d,i))}}const Us=Ve("useRequest"),Kn=Ve("useWatcher"),$n=Ve("useFetcher"),kn=e=>({[Se.USE_REQUEST]:Us,[Se.USE_WATCHER]:Kn,[Se.USE_FETCHER]:$n})[e],Hn=(e,t)=>e(se(t,ue),"expected a method instance."),qt="success",Nt="error",Kt="complete";var Os=(e,t,n,s)=>({m,sf:[],rf:[],fs:{},em:n,ht:e,c:t,ro:s,ms:{}});class Le{constructor(t,n){this.method=t,this.args=n}clone(){return{...this}}static spawn(t,n){return new Le(t,n)}}class Ls extends Le{constructor(t,n,s){super(t.method,t.args),this.data=n,this.fromCache=s}}class Fs extends Le{constructor(t,n){super(t.method,t.args),this.error=n}}class yn extends Le{constructor(t,n,s,o,r){super(t.method,t.args),this.status=n,this.data=s,this.fromCache=n==="error"?!1:o,this.error=r}}const Vs=(e,t)=>t(),it={},qs=(e,t)=>(it[e]||{})[t]||{},Ns=(e,t,n,s)=>{const o=it[e]=it[e]||{};o[t]={s:n,h:s}},Ks=(e,t)=>{const n=it[e];n&&Ae(n,t)};function $t(e,t,n=[]){const s=kn(e.ht);let o=Dn(t,s,n);const{fs:r,ht:a,c:l,ms:u}=e,{loading:h,data:c,error:i}=r,d=a===Se.USE_FETCHER,{force:f=v,middleware:E=Vs}=l,T=Ee(o),{id:P}=T,C=le(o),{abortLast:M=w}=l,L=!e.m;return e.m=o,(async()=>{let F=X,j=X,V=v,W=kt(m),b=X,D=X;const x=await Vt(o);let S=()=>!!x,G=v;d||(j=N=>Ns(P,C,N,e),j({...r,...u}),F=()=>Ks(P,C));const A=N=>{V=w;const{force:te=f,method:oe=o}=N||{},H=Gt(te,[O(Le,o,n)]),ae=ge=>({loaded:qe,total:xe})=>{r[ge].v={loaded:qe,total:xe}};o=oe,J(e.sf,j),J(e.rf,F),G||(h.v=!!H||!x);const{downloading:ce,uploading:Ce}=e.ro.trackedKeys;return b=ce?o.onDownload(ae("downloading")):b,D=Ce?o.onUpload(ae("uploading")):D,W=o.send(H),S=()=>o.fromCache||v,W},Q={method:o,cachedResponse:x,config:l,abort:()=>o.abort()},q=()=>a!==Se.USE_WATCHER||!M||e.m===o,$=(N=w)=>{N&&L&&(h.v=v),G=N},R=E(d?{...Q,args:n,fetch:(N,...te)=>(Hn(s,N),$t(e,N,te)),proxyStates:ts(r,"data"),controlLoading:$}:{...Q,args:n,send:(...N)=>$t(e,t,N),proxyStates:r,controlLoading:$},A);let _=m;const I=Le.spawn(o,n);try{const N=await R,te=oe=>{if(!d)q()&&(c.v=oe);else if(e.c.updateState!==v){const H=qs(P,C).s;H&&(H.data.v=oe)}return q()&&(i.v=m,!G&&(h.v=v),e.em.emit(qt,O(Ls,I,oe,S())),e.em.emit(Kt,O(yn,I,qt,oe,S(),m))),oe};_=N!==m?te(N):V?await we(W,te,()=>te(m)):m,!V&&!G&&(h.v=v)}catch(N){throw q()&&(i.v=N,!G&&(h.v=v),e.em.emit(Nt,O(Fs,I,N)),e.em.emit(Kt,O(yn,I,Nt,m,S(),N))),N}return b(),D(),_})()}const wn=e=>e.current;function Qt(e,t,n,s,o=v,r,a=0){var l;n={...n};const{__referingObj:u={trackedKeys:{},bindError:v}}=n;let h=!!o,c=m;if(o)try{const R=Dn(t,kn(e)),_=Ee(R),I=_.l1Cache.get(dt(_.id,le(R)));if(I&&!se(I,Y)){const[te,oe]=I;(!oe||oe>be())&&(c=te)}h=!!Gt((l=n.force)!==null&&l!==void 0?l:v)||!c}catch{}const{create:i,effectRequest:d,ref:f,objectify:E,exposeProvider:T,transformState2Proxy:P}=He(Oe(),u),C={total:0,loaded:0},{managedStates:M={}}=n,L=Ds(M,(R,_)=>P(R,_)),F=i(c??(K(s)?s():s),"data"),j=i(h,"loading"),V=i(m,"error"),W=i({...C},"downloading"),b=i({...C},"uploading"),D=E([F,j,V,W,b]),x=ft(),S=wn(f(Os(e,n,x,u)));S.fs=D,S.em=x,S.c=n,S.ms=L;const G=r!==m,A=(R=t,_)=>$t(S,R,_),Q=wn(f(ss())),q=(R=u,_)=>{Q(()=>{Be(A(_),I=>{if(!R.bindError&&!R.trackedKeys.error)throw I})})},$=f(As((R,_,I)=>q(_,I),R=>de(R)?fe(a)?a[R]:a:0));return ht.ssr||d({handler:G?R=>$.current(R,u,t):()=>q(u),removeStates:()=>re(S.rf,R=>R()),saveStates:R=>re(S.sf,_=>_(R)),frontStates:{...D,...L},watchingStates:r,immediate:o??w}),T({...E([F,j,V,W,b]),abort:()=>S.m&&S.m.abort(),send:(R,_)=>A(_,R),onSuccess(R){x.on(qt,R)},onError(R){u.bindError=w,x.on(Nt,R)},onComplete(R){x.on(Kt,R)}})}function $s(e={}){const t=Qt(Se.USE_FETCHER,X,e),{send:n}=t;return Ae(t,"send"),Qe(t,{fetch:(s,...o)=>(Hn($n,s),n(o,s))})}function Xt(e,t={}){const{immediate:n=w,initialData:s}=t,o=Qt(Se.USE_REQUEST,e,t,s,!!n),{send:r}=o;return Qe(o,{send:(...a)=>r(a)})}function ks(e,t,n={}){Kn(t&&k(t)>0,"expected at least one watching state");const{immediate:s,debounce:o=0,initialData:r}=n,a=Qt(Se.USE_WATCHER,e,n,r,!!s,t,o),{send:l}=a;return Qe(a,{send:(...u)=>l(u)})}var Hs=e=>{let t={};return{snapshots:()=>t,save(n,s=v){const o=le(n);(!t[o]||s)&&(t[o]={entity:n})},get:n=>t[le(se(n,ue)?n:e(n))],remove(n){n?delete t[n]:t={}}}};const $e=Ve("usePagination"),Rn=(e,t)=>$e(de(e)&&e<k(t),"index must be a number that less than list length");var yo=(e,t={})=>{const{create:n,computed:s,ref:o,watch:r,exposeProvider:a,objectify:l,__referingObj:u}=He(Oe()),{preloadPreviousPage:h=w,preloadNextPage:c=w,total:i=g=>g.total,data:d=g=>g.data,append:f=v,initialPage:E=1,initialPageSize:T=10,watchingStates:P=[],initialData:C,immediate:M=w,middleware:L,force:F=X,...j}=t,V=o(e),W=o(v),b=n(E,"page"),D=n(T,"pageSize"),x=n(C?d(C)||[]:[],"data"),S=n(C?i(C):m,"total"),{snapshots:G,get:A,save:Q,remove:q}=o(Hs(g=>V.current(g,D.v))).current,$=g=>d(g)||g,R=$s({__referingObj:u,updateState:v,force:({args:g})=>g[0]}),{loading:_,fetch:I,abort:N,onSuccess:te}=R,oe=o(_),H=(g=b.v)=>{const p=D.v,y=e(g,p);return Q(y),y};r(P,()=>{b.v=E,W.current=w});const ae=o({}),ce=s(()=>{const g=S.v;return g!==m?Math.ceil(g/D.v):m},[D,S],"pageCount"),Ce=g=>(...p)=>ae.current[g](...p),ge=ks(H,[...P,b.e,D.e],{__referingObj:u,immediate:M,initialData:C,managedStates:l([x,b,D,S],"s"),middleware(g,p){return L?L({...g,delegatingActions:{refresh:Ce("refresh"),insert:Ce("insert"),remove:Ce("remove"),replace:Ce("replace"),reload:Ce("reload"),getState:y=>({page:b,pageSize:D,data:x,pageCount:ce,total:S,isLastPage:gt})[y].v}},p):p()},force:g=>g.args[1]||(K(F)?F(g):F),...j}),{send:qe}=ge,xe=ge.__proxyState("data"),Zt=async g=>{const{rawData:p=xe.v,preloadPage:y,fetchMethod:U,forceRequest:B=v,isNextPage:z=v}=g,{e:Z}=Xe(U);if(Z(We)<=be())return v;if(B)return w;if(await Vt(U))return v;const ee=ce.v,ne=ee?y>ee:z?k($(p))<D.v:v;return y>0&&!ne},en=async(g,p=v)=>{const y=b.v+1,U=H(y);c&&await Zt({rawData:g,preloadPage:y,fetchMethod:U,isNextPage:w,forceRequest:p})&&Be(I(U,p),X)},Bn=async g=>{const p=b.v-1,y=H(p);h&&await Zt({rawData:g,preloadPage:p,fetchMethod:y})&&Be(I(y),X)},gt=s(()=>{const g=xe.v;if(!g)return w;const p=$(g),y=b.v,U=ce.v,B=fe(p)?k(p):0;return U?y>=U:B<D.v},[b,ce,xe,D],"isLastPage"),St=async()=>{const g=A(b.v);g&&await _t(g.entity,p=>{if(p){const y=$(p)||[];return Me(y,0,k(y),...x.v),p}})};te(({method:g,data:p})=>{const y=A(b.v);if(y&&le(y.entity)===le(g)){const U=$(p);if(f){const B=x.v,z=D.v,Z=k(B)%z;if(Z>0){const ee=[...x.v];Me(ee,(b.v-1)*z,Z,...U),x.v=ee}}else x.v=U}});const vt=o(m),Et=o(m);ge.onSuccess(({data:g,args:[p,y],method:U})=>{const{total:B}=A(U)||{},z=g;S.v=B!==m?B:i(z),y||(Bn(z),en(z));const Z=D.v,ee=$(z);if($e(fe(ee),"Got wrong array, did you return the correct array of list in `data` function"),f){if(W.current&&(x.v=[]),p===m)x.v=[...x.v,...ee];else if(p){const ne=[...x.v];Me(ne,(p-1)*Z,Z,...ee),x.v=ne}}else x.v=ee}).onSuccess(({data:g})=>{var p;(p=vt.current)===null||p===void 0||p.call(vt,g)}).onError(({error:g})=>{var p;(p=Et.current)===null||p===void 0||p.call(Et,g)}).onComplete(()=>{W.current=v});const Je=g=>{const p=x.v.indexOf(g);return $e(p>=0,"item is not found in list"),p},{addQueue:Ct,onComplete:tn}=o(os()).current,yt=async(g=b.v)=>{let p=g,y=kt();if(f){if(!de(g)){const U=Je(g);p=Math.floor(U/D.v)+1}$e(p<=b.v,"refresh page can't greater than page"),y=qe(p,w)}else $e(de(p),"unable to calculate refresh page by item in pagination mode"),y=p===b.v?qe(m,w):I(e(p,D.v),w);return y},nn=async(g=v)=>{const p=b.v,y=G();let U=Mt(y);if(g)q();else{const B=ie(me([A(p-1),A(p),A(p+1)],Boolean),({entity:z})=>le(z));U=ie(me(pe(y),z=>!st(B,z)),z=>{const Z=y[z];return delete y[z],Z})}await us(ie(U,({entity:B})=>B))},sn=async()=>{oe.current&&N(),await nn();const g=A(b.v+1);if(g){const p=$(await Vt(g.entity)||{})||[];en(m,k(p)<D.v)}},on=g=>{if(g===0)return;const p=S.v;if(de(p)){const y=Math.max(p+g,0);S.v=y;const U=b.v;re([A(U-1),A(U),A(U+1)],B=>{B&&(B.total=y)})}},an=(g,p=0)=>(tn(sn),Ct(async()=>{const y=de(p)?p:Je(p)+1;let U=m;const B=[...x.v];if(k(B)%D.v===0&&(U=B.pop()),Me(B,y,0,g),x.v=B,on(1),await St(),U){const z=A(b.v+1);z&&await _t(z.entity,Z=>{if(Z){const ee=$(Z)||[];return ee.unshift(U),ee.pop(),Z}})}})),rn=(...g)=>(tn(sn),Ct(async()=>{const p=ie(g,ne=>{const Ne=de(ne)?ne:Je(ne);return Rn(Ne,x.v),Ne}),y=b.v,U=y+1,B=A(U),z=[];B&&await _t(B.entity,ne=>{if(ne){const Ne=$(ne);return fe(Ne)&&J(z,...Me(Ne,0,k(p))),ne}});const Z=gt.v,ee=k(z);if(ee>0||Z){const ne=me(x.v,(Ne,zn)=>!st(p,zn));!f&&Z&&k(ne)<=0?b.v=y-1:ee>0&&J(ne,...z),x.v=ne}else ee<=0&&!Z&&yt(y);return on(-k(p)),St()})),cn=(g,p)=>Ct(async()=>{$e(p!==m,"expect specify the replace position");const y=de(p)?p:Je(p);Rn(y,x.v);const U=[...x.v];Me(U,y,1,g),x.v=U,await St()}),ln=async()=>{await nn(w),W.current=w,b.v===E?Be(qe(),X):b.v=E;const{resolve:g,reject:p,promise:y}=Un();return vt.current=g,Et.current=p,y};return ae.current={refresh:yt,insert:an,remove:rn,replace:cn,reload:ln},a({...ge,...l([x,b,ce,D,S,gt]),fetching:R.loading,onFetchSuccess:R.onSuccess,onFetchError:R.onError,onFetchComplete:R.onComplete,refresh:yt,insert:an,remove:rn,replace:cn,reload:ln})},Is={forward:e=>se(e,Date)?e.getTime():m,backward:e=>O(Date,e)},Bs={forward:e=>se(e,RegExp)?e.source:void 0,backward:e=>O(RegExp,e)};const zs=(e={})=>{const t={date:Is,regexp:Bs,...e};return{serialize:o=>(At(o)&&(o=ot(fe(o)?[...o]:{...o},r=>{let a=m;const l=pe(t).reduce((h,c)=>{if(!a){const i=t[c].forward(h);i!==m&&(a=c,h=i)}return h},r);return Fe.prototype.toString.call(r)==="[object Object]"?r={...r}:fe(r)&&(r=[...r]),a!==m?[a,l]:r})),o),deserialize:o=>At(o)?ot(o,r=>{if(fe(r)&&k(r)===2){const a=t[r[0]];r=a?a.backward(r[1]):r}return r},v):o}},_e=(e,t={})=>{let n=w;const{enableFocus:s=w,enableVisibility:o=w,enableNetwork:r=w,pollingTime:a=0,throttle:l=1e3}=t,{onMounted:u,onUnmounted:h,__referingObj:c}=He(Oe()),i=Xt(e,{...t,__referingObj:c}),d=()=>{n&&(i.send(),l>0&&(n=v,setTimeout(()=>{n=w},l)))};let f=X,E=X,T=X,P=X;return u(()=>{ht.ssr||(f=r?_e.onNetwork(d,t):f,E=s?_e.onFocus(d,t):E,T=o?_e.onVisibility(d,t):T,P=a>0?_e.onPolling(d,t):P)}),h(()=>{f(),E(),T(),P()}),i},Jt=(e,t)=>(window.addEventListener(e,t),()=>window.removeEventListener(e,t));_e.onNetwork=e=>Jt("online",e);_e.onFocus=e=>Jt("focus",e);_e.onVisibility=e=>Jt("visibilitychange",()=>document.visibilityState==="visible"&&e());_e.onPolling=(e,t)=>{const n=setInterval(e,t.pollingTime);return()=>clearInterval(n)};const In="useCaptcha",js=Ve(In);var wo=(e,t={})=>{const{initialCountdown:n,middleware:s}=t;js(n===m||n>0,"initialCountdown must be greater than 0");const{create:o,ref:r,objectify:a,exposeProvider:l,__referingObj:u}=He(Oe()),h=o(0,"countdown"),c=Xt(e,{...t,__referingObj:u,immediate:v,managedStates:a([h],"s"),middleware:s?(f,E)=>s({...f,send:d},E):m}),i=r(m),d=(...f)=>O(Y,(E,T)=>{h.v<=0?c.send(...f).then(P=>{h.v=t.initialCountdown||60,i.current=setInterval(()=>{h.v-=1,h.v<=0&&clearInterval(i.current)},1e3),E(P)}).catch(P=>T(P)):T(O(On,In,"the countdown is not over yet"))});return l({...c,send:d,...a([h])})};const _n=Symbol("FormRestore"),Ws=(e,t)=>`alova/form-${t||le(e)}`,Gs={},Tn=e=>{const t=n=>fe(n)?[...n]:ve(n)?{...n}:n;return ot(t(e),t)};var Ro=(e,t={})=>{const n=Gs,{id:s,initialForm:o,store:r,resetAfterSubmiting:a,immediate:l=v,middleware:u}=t;Oe();const{create:h,ref:c,onMounted:i,watch:d,objectify:f,exposeProvider:E,__referingObj:T}=He(Oe()),P=ve(r),C=P?r.enable:r,M=s?n[s]:m,L=h(Tn(o),"form"),F=e,j=ft(),V=c(Gt(F,[L.v])),W=Ee(V.current).l2Cache,b=Ws(V.current,s),D=c(v),x=c(zs(P?r.serializers:m)),S=c(!1),G=Xt((..._)=>F(L.v,..._),{...t,__referingObj:T,middleware:u?(_,I)=>u({..._,delegatingActions:{updateForm:Q,reset:A}},I):m,immediate:C||M?v:l}),A=()=>{D.current=w;const _=Tn(o);_&&(L.v=_),C&&W.remove(b)},Q=_=>{L.v={...L.v,..._}},q=E({...G,...f([L]),updateForm:Q,reset:A,onRestore(_){j.on(_n,_)}});s&&(M||(S.current=w),S.current&&(n[s]={hookProvider:q,config:t}));const{send:$,onSuccess:R}=q;return i(()=>{if(C&&!M){const _=x.current.deserialize(W.get(b));_&&(L.v=_,j.emit(_n,m)),C&&l&&$()}}),d([L],()=>{if(D.current||!C){D.current=v;return}W.set(b,x.current.serialize(L.v))}),R(()=>{a&&A()}),M&&!S.current?M.hookProvider:q},bn;(function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSED=2]="CLOSED"})(bn||(bn={}));let bt=0;const Te={},Ys=e=>!!e.send,Qs=Ve("subscriber"),_o=e=>{const{ref:t,onUnmounted:n}=He(Oe()),s=t(bt+1);return s.current>bt&&(bt+=1),n(()=>{var o;!((o=Te[e])===null||o===void 0)&&o[s.current]&&delete Te[e][s.current]}),(o,r)=>{const{abort:a,proxyStates:l,delegatingActions:u={}}=o,h=d=>{for(const f in d)l[f]&&(l[f].v=d[f])},c=Te[e]=Te[e]||[],i=Ys(o)?{...u,send:o.send,abort:a,update:h}:{...u,fetch:o.fetch,abort:a,update:h};return c[s.current]=i,r()}},To=(e,t,n=!1)=>{const s=[];typeof e=="symbol"||Ye(e)||de(e)?Te[e]&&J(s,...Mt(Te[e])):se(e,RegExp)&&re(me(pe(Te),o=>e.test(o)),o=>{J(s,...Mt(Te[o]))}),s.length===0&&!n&&Qs(!1,`no handler can be matched by using \`${e.toString()}\``),re(me(s,Ge),t)},Xs="BACKEND_ERROR",Js=(e,t)=>{const{tokenRefresher:n}=t,{onAuthRequired:s,onResponseRefreshToken:o}=Ms({refreshTokenOnSuccess:{isExpired:(a,l)=>(n==null?void 0:n.isExpired(a,l))||!1,handler:async(a,l)=>n==null?void 0:n.handler(a,l)},refreshTokenOnError:{isExpired:(a,l)=>(n==null?void 0:n.isExpired(a,l))||!1,handler:async(a,l)=>n==null?void 0:n.handler(a,l)}});return _s({...e,timeout:e.timeout??10*1e3,requestAdapter:e.requestAdapter??Yt(),statesHook:Ts,beforeRequest:s(t.onRequest),responded:o({onSuccess:async(a,l)=>{var c;let u=null,h=null;try{await t.isBackendSuccess(a)?h=await t.transformBackendResponse(a):(u=new Error("the backend request error"),u.code=Xs)}catch(i){u=i}if(u)throw await((c=t.onError)==null?void 0:c.call(t,u,a,l)),u;return h},onComplete:t.onComplete,onError:(a,l)=>{var u;return(u=t.onError)==null?void 0:u.call(t,a,null,l)}})})},Zs="mock",eo="#64bde8",to="#ccefff",no="Realtime",so="#999999",oo="#ededed",ao=(e,t)=>`padding: 2px 6px; background: ${e}; color: ${t};`,Ke="color: black; font-size: 12px; font-weight: bolder",xt=e=>{const t={};for(const n in e)t[n]={value:e[n]};return t},ro=({isMock:e,url:t,method:n,headers:s,query:o,data:r,responseHeaders:a,response:l})=>{const u=console;u.groupCollapsed(`%c${e?Zs:no}`,ao(e?to:oo,e?eo:so),t),u.log("%c[Method]",Ke,n.toUpperCase()),u.log("%c[Request Headers]",Ke),u.table(xt(s)),u.log("%c[Query String Parameters]",Ke),u.table(xt(o)),u.log("%c[Request Body]",Ke,r||""),e&&(Object.keys(a).length>0&&(u.log("%c[Response Headers]",Ke),u.table(xt(a))),u.log("%c[Response Body]",Ke,l||"")),u.groupEnd()},co=({status:e=200,responseHeaders:t,statusText:n="ok",body:s})=>({response:new Response(Wt(s)?s:JSON.stringify(s),{status:e,statusText:n}),headers:new Headers(t)}),io=e=>e,lo=e=>{e=/^[^/]*\/\//.test(e)?e:`//${e}`;const t=e.split("/").slice(3),n={};let s=t.pop(),o="",r="";return s&&(s=s.replace(/\?[^?#]+/,a=>(a.substring(1).split("&").forEach(l=>{const[u,h]=l.split("=");u&&(n[u]=h)}),"")),s=s.replace(/#[^#]*/,a=>(r=a,"")),t.push(s),o=`/${t.join("/")}`),{pathname:o,query:n,hash:r}};function uo({enable:e=w,delay:t=2e3,httpAdapter:n,mockRequestLogger:s=ro,mock:o,onMockResponse:r=co,onMockError:a=io,matchMode:l="pathname"}={mock:{}}){return(u,h)=>{o=e&&o||{};const{url:c,data:i,type:d,headers:f}=u;let E=h.url,T=h.config.params||{};if(l==="pathname"){const S=lo(c);E=S.pathname,T=S.query}const P={},C=E.split("/"),M=Object.keys(o).filter(S=>{if(S.startsWith("-"))return v;let G="GET";if(S=S.replace(/^\[(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS|TRACE|CONNECT)\]/i,(Q,q)=>(G=q.toUpperCase(),"")),G!==d.toUpperCase())return v;const A=S.split("/");if(A.length!==C.length)return v;for(const Q in A){const q=A[Q],$=(q.match(/^\{(.*)\}$/)||["",""])[1];if($)P[$]=C[Q];else if(q!==C[Q])return v}return w});let L=M.find(S=>!/\{.*\}/.test(S));L=L||M.shift();const F=L?o[L]:m;if(F===m){if(n)return K(s)&&s({isMock:v,url:c,method:d,params:P,headers:f,query:T,data:{},responseHeaders:{}}),n(u,h);throw new Error(`cannot find the httpAdapter.
[url]${c}`)}const j=Un(),{resolve:V}=j;let{promise:W,reject:b}=j;const D=h.config.timeout||0;D>0&&setTimeout(()=>{b(new Error("request timeout"))},D);const x=setTimeout(()=>{try{const S=K(F)?F({query:T,params:P,data:Ye(i)||!i?{}:i,headers:f}):F;V(O(Promise,(G,A)=>{b=A,kt(S).then(G).catch(A)}))}catch(S){b(S)}},t);return W=W.then(S=>{let G=200,A="ok",Q={},q=m;return S===m?(G=404,A="api not found"):S&&de(S.status)&&Ye(S.statusText)?(G=S.status,A=S.statusText,Q=S.responseHeaders||Q,q=S.body):q=S,O(Promise,($,R)=>{try{const _=r({status:G,statusText:A,responseHeaders:Q,body:q},{headers:f,query:T,params:P,data:i||{}},h);$(_)}catch(_){R(_)}}).then($=>(K(s)&&s({isMock:w,url:c,method:d,params:P,headers:f,query:T,data:i||{},responseHeaders:Q,response:q}),$))}).catch(S=>Ht(a(S,h))),{response:()=>W.then(({response:S})=>S&&jt(S)==="[object Response]"?S.clone():S),headers:()=>W.then(({headers:S})=>S),abort:()=>{clearTimeout(x),b(new Error("The user abort request"))}}}}function fo(e,t={enable:!0}){let n={};return e.filter(({enable:s})=>s).forEach(({data:s})=>{n={...s,...n}}),uo({...t,mock:n})}var ho=(e,t=!0)=>({enable:t,data:e});const po=ho({"[POST]/systemManage/addUser":()=>({code:"0000",msg:"success",data:null}),"[POST]/systemManage/updateUser":()=>({code:"0000",msg:"success",data:null}),"[DELETE]/systemManage/deleteUser":()=>({code:"0000",msg:"success",data:null}),"[DELETE]/systemManage/batchDeleteUser":()=>({code:"0000",msg:"success",data:null}),"[POST]/auth/sendCaptcha":()=>({code:"0000",msg:"success",data:null}),"[POST]/auth/verifyCaptcha":()=>({code:"0000",msg:"success",data:null}),"/mock/getLastTime":()=>({code:"0000",msg:"success",data:{time:new Date().toLocaleTimeString()}})});function mo(){const e=nt.get("token");return e?`Bearer ${e}`:null}async function go(){const{resetStore:e}=Pn(),t=nt.get("refreshToken")||"",n=Eo(t);n.meta.authRole="refreshToken";try{const s=await n;nt.set("token",s.token),nt.set("refreshToken",s.refreshToken)}catch(s){throw e(),s}}function xn(e,t){var s,o;(s=e.errMsgStack)!=null&&s.length||(e.errMsgStack=[]),e.errMsgStack.includes(t)||(e.errMsgStack.push(t),(o=window.$message)==null||o.error(t,{onLeave:()=>{e.errMsgStack=e.errMsgStack.filter(r=>r!==t),setTimeout(()=>{e.errMsgStack=[]},5e3)}}))}const So={BASE_URL:"./",DEV:!1,MODE:"prod",PROD:!0,SSR:!1,VITE_APP_DESC:"SoybeanAdmin is a fresh and elegant admin template",VITE_APP_TITLE:"SoybeanAdmin",VITE_AUTH_ROUTE_MODE:"dynamic",VITE_AUTOMATICALLY_DETECT_UPDATE:"Y",VITE_BASE_URL:"./",VITE_DROP_CONSOLE:"Y",VITE_ENABLE_OBFUSCATION:"Y",VITE_HTTP_PROXY:"N",VITE_ICON_LOCAL_PREFIX:"icon-local",VITE_ICON_PREFIX:"icon",VITE_MENU_ICON:"mdi:menu",VITE_ROUTER_HISTORY_MODE:"hash",VITE_ROUTE_HOME:"home",VITE_SECRET_KEY:"MagicDog_SecureKey_2024_WebSocket_Payment_System",VITE_SERVICE_BASE_URL:"http://149.88.64.249:8080/api/v1",VITE_SERVICE_EXPIRED_TOKEN_CODES:"9999,9998,4010",VITE_SERVICE_LOGOUT_CODES:"8888,8889,4040",VITE_SERVICE_MODAL_LOGOUT_CODES:"7777,7778",VITE_SERVICE_SUCCESS_CODE:"0000",VITE_SOURCE_MAP:"N",VITE_STATIC_SUPER_ROLE:"R_SUPER",VITE_STORAGE_PREFIX:"SOY_"},{baseURL:vo}=Yn(So),Pe={errMsgStack:[]};fo([po],{httpAdapter:Yt(),delay:1e3,enable:!0,matchMode:"methodurl"});const mt=Js({baseURL:vo,requestAdapter:Yt()},{onRequest({config:e}){const t=mo();e.headers.Authorization=t,e.headers.apifoxToken="XL299LiMEDZ0H5h3A29PxwQXdMJqWyY2"},tokenRefresher:{async isExpired(e){const t="9999,9998,4010".split(",")||[],{code:n}=await e.clone().json();return t.includes(String(n))},async handler(){await go()}},async isBackendSuccess(e){const n=await e.clone().json();return String(n.code)==="0000"},async transformBackendResponse(e){return(await e.clone().json()).data},async onError(e,t){var h,c;const n=Pn();let s=e.message,o="";if(t){const i=await(t==null?void 0:t.clone().json());s=i.msg,o=String(i.code)}function r(){xn(Pe,s),n.resetStore()}function a(){r(),window.removeEventListener("beforeunload",r),Pe.errMsgStack=Pe.errMsgStack.filter(i=>i!==s)}throw("8888,8889,4040".split(",")||[]).includes(o)?(r(),e):("7777,7778".split(",")||[]).includes(o)&&!((h=Pe.errMsgStack)!=null&&h.includes(s))?(Pe.errMsgStack=[...Pe.errMsgStack||[],s],window.addEventListener("beforeunload",r),(c=window.$dialog)==null||c.error({title:fn("common.error"),content:s,positiveText:fn("common.confirm"),maskClosable:!1,closeOnEsc:!1,onPositiveClick(){a()},onClose(){a()}}),e):(xn(Pe,s),e)}});function bo(e){return mt.Post("/auth/sendCaptcha",{phone:e})}function xo(e,t){return mt.Post("/auth/verifyCaptcha",{phone:e,code:t})}function Eo(e){return mt.Post("/auth/refreshToken",{refreshToken:e},{meta:{authRole:"refreshToken"}})}function Po(e,t){return mt.Get("/auth/error",{params:{code:e,msg:t},shareRequest:!1})}export{_o as a,Ro as b,mt as c,_e as d,To as e,Po as f,ks as g,yo as h,bo as s,wo as u,xo as v};
