import{d as B,v as S,r,a as T,i as z,o as u,b as i,e,f as x,w as f,h as m,N as C,B as D,g as L,cu as V,t as g,ae as y,H,dK as F,dL as U,cy as E}from"./index-BQSxQzVO.js";const K={class:"min-h-500px bg-gray-50 p-6 dark:bg-gray-900"},M={class:"mx-auto max-w-4xl"},P={class:"grid grid-cols-1 gap-6 lg:grid-cols-1"},j={class:"space-y-6"},q={class:"flex gap-3"},G={key:0,class:"border border-gray-200 rounded-lg bg-gray-50 p-4 dark:border-gray-700 dark:bg-[rgb(31,41,55)]"},J={class:"mb-2 flex items-center"},O={class:"text-sm text-gray-900 dark:text-gray-100"},Q={key:0,class:"text-xs text-gray-600 dark:text-gray-400"},R={key:1,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},W={key:2,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},X=B({name:"system-auth",__name:"index",setup(Y){const{startLoading:I,endLoading:N}=S(),l=r(""),o=r(""),v=r(!1),s=r(""),b=r(0),k=r(0),p=r(""),c=r(""),$=T(()=>{switch(s.value){case"active":return"系统授权有效";case"unbound":return"设备未绑定授权码";case"expired":return"系统授权已过期";case"inactive":return"系统授权无效";default:return"未知状态"}});async function w(){var d,t,n,h,_;I();try{const{data:a}=await F();a?(l.value=a.expireTime||"未设置",s.value=a.status||"unbound",b.value=a.remainingDays||0,k.value=a.remainingHours||0,p.value=a.deviceId||"",c.value=a.licenseCode||"",a.status==="active"?(d=window.$message)==null||d.success("授权信息加载成功"):a.status==="unbound"?(t=window.$message)==null||t.info("设备未绑定授权码"):a.status==="expired"?(n=window.$message)==null||n.warning("系统授权已过期"):a.status==="inactive"&&((h=window.$message)==null||h.error("系统授权无效"))):(l.value="未授权",s.value="unbound")}catch(a){console.error("Failed to fetch auth info:",a),(_=window.$message)==null||_.error("获取授权信息失败"),l.value="获取失败",s.value="unbound"}finally{N()}}async function A(){var d;if(!o.value.trim()){(d=window.$message)==null||d.warning("请输入授权码");return}v.value=!0;try{const t=await U({authCode:o.value});l.value=t.data.expireTime||"",s.value="active",o.value="",await w()}catch(t){console.error("Failed to submit auth code:",t)}finally{v.value=!1}}return z(()=>{w()}),(d,t)=>(u(),i("div",K,[e("div",M,[t[10]||(t[10]=e("div",{class:"mb-6"},[e("h1",{class:"mb-2 text-2xl text-gray-900 font-bold dark:text-gray-100"},"系统授权"),e("p",{class:"text-gray-600 dark:text-gray-400"},"管理系统授权码和查看授权状态")],-1)),e("div",P,[x(m(H),{class:"border-0 shadow-sm transition-shadow hover:shadow-md"},{header:f(()=>t[2]||(t[2]=[e("div",{class:"flex items-center"},[e("div",{class:"mr-3 h-8 w-2 rounded-full bg-green-500"}),e("div",null,[e("h3",{class:"text-lg text-gray-900 font-semibold dark:text-gray-100"},"系统授权管理"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"输入授权码激活系统或查看当前授权状态")])],-1)])),default:f(()=>[e("div",j,[e("div",null,[t[3]||(t[3]=e("label",{class:"mb-2 block text-sm text-gray-700 font-medium dark:text-gray-300"},"当前授权到期时间",-1)),x(m(C),{value:l.value,"onUpdate:value":t[0]||(t[0]=n=>l.value=n),placeholder:"未授权",size:"large",disabled:"",readonly:""},null,8,["value"]),t[4]||(t[4]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"显示当前系统的授权到期时间",-1))]),e("div",null,[t[6]||(t[6]=e("label",{class:"mb-2 block text-sm text-gray-700 font-medium dark:text-gray-300"},"授权码",-1)),e("div",q,[x(m(C),{value:o.value,"onUpdate:value":t[1]||(t[1]=n=>o.value=n),placeholder:"请输入授权码",size:"large",type:"password","show-password-on":"click",style:{flex:"1"},loading:v.value},null,8,["value","loading"]),x(m(D),{type:"primary",size:"large",loading:v.value,onClick:A},{default:f(()=>t[5]||(t[5]=[L("激活授权")])),_:1},8,["loading"])]),t[7]||(t[7]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"输入有效的授权码来激活或延长系统授权",-1))]),t[9]||(t[9]=e("div",{class:"border border-blue-200 rounded-lg bg-blue-50 p-4 dark:border-gray-700 dark:bg-[rgb(31,41,55)]"},[e("h4",{class:"mb-3 text-sm text-blue-800 font-medium dark:text-blue-400"},"授权说明"),e("div",{class:"text-xs text-blue-700 space-y-2 dark:text-gray-300"},[e("p",null,"• 如果授权码提示无效，则说明激活码已过期"),e("p",null,"• 如果短时间多次激活，该IP以及授权码将被列入黑名单"),e("p",null,"• 如果当前授权码还未到期，但是用新授权码激活了，那么之前的到期时间会累加到新授权码上面"),e("p",null,"• 如果当前授权码在其他服务器上使用后，那么当前服务器将失效"),e("p",null,"• 在成功使用授权码后，同一授权码在30分钟内不能再次被使用")])],-1)),s.value?(u(),i("div",G,[t[8]||(t[8]=e("h4",{class:"mb-2 text-sm text-gray-700 font-medium dark:text-gray-300"},"授权状态",-1)),e("div",J,[e("div",{class:V(["mr-2 h-3 w-3 rounded-full",{"bg-green-500":s.value==="active","bg-red-500":s.value==="expired","bg-orange-500":s.value==="inactive","bg-gray-500":s.value==="unbound"}])},null,2),e("span",O,g($.value),1)]),s.value==="active"&&b.value>0?(u(),i("div",Q," 剩余时间："+g(b.value)+"天 "+g(k.value)+"小时 ",1)):y("",!0),p.value?(u(),i("div",R,"设备ID："+g(p.value),1)):y("",!0),c.value&&c.value!=="****"?(u(),i("div",W," 授权码："+g(c.value),1)):y("",!0)])):y("",!0)])]),_:1})])])]))}}),ee=E(X,[["__scopeId","data-v-58d96e8d"]]);export{ee as default};
