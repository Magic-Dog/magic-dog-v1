import{d as ft,r as g,p as le,$ as l,a as gt,cA as mt,a2 as i,cx as G,cs as He,K as b,cB as _t,B as te,_ as $,ak as as,i as yt,as as bt,o as _,b as C,f as u,w as p,e as t,h as n,al as ae,g as v,t as c,b1 as xt,bw as ht,N as T,H as wt,c as Z,ae as w,af as kt,bT as K,cw as qt,cy as $t}from"./index-UyGIsgrM.js";import{s as Ct,i as St,a as Pt,c as It,t as Dt,v as zt}from"./session-B6E-48fm.js";import{N as be}from"./Space-sSsMuOHt.js";import{N as ls}from"./DatePicker-BmtTedKq.js";import{N as Ut}from"./DataTable-Ctoc5GeF.js";import{N as I}from"./text-BzkzQO8Z.js";import"./get-slot-Bk_rJcZu.js";import"./Pagination-CWXxq3CH.js";const Tt={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden bg-gray-50 lt-sm:overflow-auto dark:bg-gray-900"},Ot={class:"mb-4"},Nt={class:"advanced-search"},Lt={key:0,class:"detail-content"},jt={class:"flat-info-container"},Mt={class:"info-row"},Rt={class:"info-cell"},Vt={class:"cell-value"},At={class:"info-cell"},Et={class:"info-cell"},Ht={class:"info-cell"},Bt={class:"cell-value"},Ft={class:"info-cell"},Wt={class:"cell-value"},Qt={class:"info-row"},Jt={key:0,class:"info-cell"},Kt={key:1,class:"info-cell"},Gt={key:2,class:"info-cell"},Zt={key:3,class:"info-cell"},Xt={class:"info-cell"},Yt={class:"cell-value"},ea={class:"info-row"},sa={class:"info-cell"},ta={class:"cell-value"},aa={key:0,class:"info-cell"},la={key:1,class:"info-cell"},ia={key:2,class:"info-cell"},na={class:"info-row"},oa={class:"info-cell"},ra={class:"cell-value"},ua={class:"info-cell"},ca={class:"cell-value"},da={class:"info-cell"},pa={class:"cell-value"},va={class:"info-cell"},fa={class:"cell-value"},ga={class:"info-row"},ma={class:"info-cell"},_a={class:"cell-value"},ya={class:"info-cell"},ba={class:"cell-value"},xa={class:"info-cell"},ha={class:"cell-value"},wa={class:"info-cell"},ka={class:"cell-value"},qa={class:"info-row"},$a={class:"info-cell full-width"},Ca={class:"cell-value"},Sa={class:"info-row"},Pa={class:"info-cell"},Ia={class:"cell-value"},Da={class:"info-cell"},za={class:"cell-value"},Ua={class:"info-cell"},Ta={class:"cell-value"},Oa={class:"info-cell"},Na={class:"cell-value"},La={class:"info-row"},ja={class:"info-cell"},Ma={class:"cell-value"},Ra={class:"info-cell"},Va={class:"cell-value"},Aa={class:"info-cell"},Ea={class:"cell-value"},Ha={class:"info-cell"},Ba={class:"cell-value"},Fa={class:"info-row"},Wa={class:"info-cell"},Qa={class:"cell-value"},Ja={class:"info-cell"},Ka={class:"cell-value"},Ga={class:"info-cell"},Za={class:"cell-value"},Xa={class:"info-cell"},Ya={class:"cell-value"},el={class:"info-row"},sl={class:"info-cell"},tl={class:"cell-value"},al={class:"info-cell"},ll={class:"cell-value"},il={class:"info-cell"},nl={class:"cell-value"},ol={class:"info-cell"},rl={class:"cell-value"},ul={class:"info-row"},cl={class:"info-cell"},dl={class:"cell-value"},pl={class:"info-cell"},vl={class:"cell-value"},fl={class:"info-cell"},gl={class:"cell-value"},ml={class:"info-cell"},_l={class:"cell-value"},yl={class:"info-row"},bl={class:"info-cell wide"},xl={class:"cell-value"},hl={class:"info-cell"},wl={class:"cell-value"},kl={class:"info-cell"},ql={class:"info-row"},$l={class:"info-cell full-width"},Cl={class:"cell-value"},Sl={class:"info-row"},Pl={class:"info-cell full-width"},Il={class:"cell-value"},Dl={class:"info-row"},zl={class:"info-cell full-width"},Ul={class:"cell-value"},Tl={class:"info-row"},Ol={class:"info-cell full-width"},Nl={class:"cell-value"},Ll={key:1,class:"py-8 text-center"},jl={class:"space-y-4"},Ml={class:"mb-4"},Rl={key:0},Vl={key:1},Al={key:2},El={class:"space-y-4"},Hl={class:"mb-4"},Bl={key:0},Fl={key:1},Wl={key:2},Ql={class:"space-y-4"},Jl={class:"mb-4"},Kl={key:0},Gl={key:1},Zl={class:"space-y-4"},Xl={class:"mb-4"},Yl={key:0},ei={key:1},si={class:"mb-4"},ti={class:"space-y-4"},ai={key:0,class:"card-simulation"},li={class:"credit-card"},ii={class:"card-top"},ni={class:"card-brand-logo"},oi=["src","alt"],ri={class:"card-number"},ui={class:"card-bottom"},ci={class:"card-info-item"},di={class:"value"},pi={class:"card-info-item"},vi={class:"value"},fi={class:"card-info-item"},gi={class:"value"},mi={key:0,class:"card-info"},_i={class:"info-grid"},yi={class:"info-item"},bi={class:"info-value"},xi={class:"info-item"},hi={class:"info-value"},wi={class:"info-item"},ki={class:"info-value"},qi={class:"info-item"},$i={class:"info-value"},Ci={class:"info-item"},Si={class:"info-value"},Pi={class:"export-config"},Ii={class:"config-section"},Di={class:"mode-description"},zi={class:"config-section"},Ui={class:"config-section"},Ti={class:"config-section"},Oi={class:"current-filters"},Ni={class:"config-section"},Li={class:"space-y-4"},ji=ft({name:"work-center",__name:"index",setup(Mi){const Oe=g(!1),k=g([]),S=le({page:1,pageSize:100,total:0,showSizePicker:!0,pageSizes:[15,20,50,100]}),xe=le({completed:{page:1,pageSize:100},uncompleted:{page:1,pageSize:100},all:{page:1,pageSize:100}}),ie=g(null),ne=g(null),Ne=g(new Date),q=le({page:1,size:100,status:"",is_completed:"",success:void 0,user_uuid:void 0,client_id:void 0,ip_address:void 0,start_date:void 0,end_date:void 0,custom_status:void 0,recent_data:!1}),f=le({status:q.status,is_completed:"",success:"",user_uuid:"",client_id:"",ip_address:"",start_date:null,end_date:null,recent_data:!1}),fe=g(!1),he=g(!1),Le=g(!1),m=le({export_mode:"basic",format:"csv"}),Be=[{label:l("page.payment.request.export.modes.basic"),value:"basic",description:l("page.payment.request.export.modes.basicDescription")},{label:l("page.payment.request.export.modes.personalInfo"),value:"personal_info",description:l("page.payment.request.export.modes.personalInfoDescription")},{label:l("page.payment.request.export.modes.cardAnalysis"),value:"card_analysis",description:l("page.payment.request.export.modes.cardAnalysisDescription")},{label:l("page.payment.request.export.modes.sessionContext"),value:"session_context",description:l("page.payment.request.export.modes.sessionContextDescription")},{label:l("page.payment.request.export.modes.full"),value:"full",description:l("page.payment.request.export.modes.fullDescription")}],is=[{label:l("page.payment.request.export.formats.csv"),value:"csv"},{label:l("page.payment.request.export.formats.json"),value:"json"}],ns=[{label:l("page.payment.request.cardTypes.all"),value:""},{label:l("page.payment.request.cardTypes.visa"),value:"visa"},{label:l("page.payment.request.cardTypes.mastercard"),value:"mastercard"},{label:l("page.payment.request.cardTypes.amex"),value:"amex"},{label:l("page.payment.request.cardTypes.unionpay"),value:"unionpay"},{label:l("page.payment.request.cardTypes.other"),value:"generic"}],oe={connected:{label:l("page.payment.request.statusLabels.connected"),type:"success"},filling_card:{label:l("page.payment.request.statusLabels.fillingCard"),type:"warning"},filling_card_holder:{label:l("page.payment.request.statusLabels.fillingCardHolder"),type:"warning"},filling_card_number:{label:l("page.payment.request.statusLabels.fillingCardNumber"),type:"warning"},filling_expiry_date:{label:l("page.payment.request.statusLabels.fillingExpiryDate"),type:"warning"},filling_cvv:{label:l("page.payment.request.statusLabels.fillingCvv"),type:"warning"},filling_personal_info:{label:l("page.payment.request.statusLabels.fillingPersonalInfo"),type:"warning"},filling_phone:{label:l("page.payment.request.statusLabels.fillingPhone"),type:"warning"},filling_zip_code:{label:l("page.payment.request.statusLabels.fillingZipCode"),type:"warning"},filling_city:{label:l("page.payment.request.statusLabels.fillingCity"),type:"warning"},filling_street_address:{label:l("page.payment.request.statusLabels.fillingStreetAddress"),type:"warning"},filling_first_name:{label:l("page.payment.request.statusLabels.fillingFirstName"),type:"warning"},filling_last_name:{label:l("page.payment.request.statusLabels.fillingLastName"),type:"warning"},filling_email:{label:l("page.payment.request.statusLabels.fillingEmail"),type:"warning"},filling_country:{label:l("page.payment.request.statusLabels.fillingCountry"),type:"warning"},filling_state:{label:l("page.payment.request.statusLabels.fillingState"),type:"warning"},filling_verification:{label:l("page.payment.request.statusLabels.fillingVerification"),type:"warning"},filling_otp:{label:l("page.payment.request.statusLabels.fillingOtp"),type:"warning"},filling_email_otp:{label:l("page.payment.request.statusLabels.fillingEmailOtp"),type:"warning"},filling_pin:{label:l("page.payment.request.statusLabels.fillingPin"),type:"warning"},filling_app_verification:{label:l("page.payment.request.statusLabels.fillingAppVerification"),type:"warning"},card_submitted:{label:l("page.payment.request.statusLabels.cardSubmitted"),type:"info"},cvv_submitted:{label:l("page.payment.request.statusLabels.cvvSubmitted"),type:"info"},verification_required:{label:l("page.payment.request.statusLabels.verificationRequired"),type:"warning"},verification_submitted:{label:l("page.payment.request.statusLabels.verificationSubmitted"),type:"info"},payment_success:{label:l("page.payment.request.statusLabels.paymentSuccess"),type:"success"},payment_failed:{label:l("page.payment.request.statusLabels.paymentFailed"),type:"error"},card_rejected:{label:l("page.payment.request.statusLabels.cardRejected"),type:"error"},disconnected:{label:l("page.payment.request.statusLabels.disconnected"),type:"default"},otp_resending:{label:"OTP重发",type:"warning"},email_otp_resending:{label:"邮箱OTP重发",type:"warning"}},os=[{label:l("page.payment.request.search.allStatus"),value:""},...Object.entries(oe).map(([s,e])=>({label:e.label,value:s}))],rs=[{label:l("page.payment.request.search.uncompleted"),value:"false"},{label:l("page.payment.request.search.completed"),value:"true"},{label:l("page.payment.request.search.all"),value:""}],us=[{label:l("page.payment.request.search.all"),value:""},{label:l("page.payment.request.search.success"),value:"true"},{label:l("page.payment.request.search.failed"),value:"false"}],cs=[{label:l("page.payment.request.blacklistTypes.payWrong"),value:"pay_wrong"},{label:l("page.payment.request.blacklistTypes.userBlack"),value:"user_black"}],je={alipay:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/alipay.svg",amex:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/amex.svg",diners:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/diners.svg",discover:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/discover.svg",elo:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/elo.svg",hiper:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/hiper.svg",hipercard:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/hipercard.svg",jcb:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/jcb.svg",maestro:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/maestro.svg",mastercard:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/mastercard.svg",mir:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/mir.svg",paypal:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/paypal.svg",unionpay:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/unionpay.svg",visa:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/visa.svg",generic:"https://raw.githubusercontent.com/aaronfagan/svg-credit-card-payment-icons/refs/heads/main/logo/generic.svg"},Me=g(!1),d=g(null),Re=g(!1),ge=g({}),Fe=g({}),we=g(!1),z=g(null),ke=g(!1),qe=g(!1),$e=g(!1),Ce=g(!1),Se=g(!1),Pe=g(!1),Ie=g(!1),x=g(null),me=g(""),re=g(""),ue=g(""),De=g(""),ze=g(""),Ue=g(""),ce=g(!1),de=g(!1),pe=g(!1),ve=g(!1),V=le({blacklist_type:"user_black",redirect_url:"",notes:""}),O=g(new Set),Te=g(!1),E=le({card_prefix:"",note_content:"",tag_color:"info"}),We=g([]),Qe=g("");function ds(s,e){Fe.value[s]=e,ge.value[s]=!0}const ps=gt(()=>{const s=window.innerHeight;return Math.max(300,s-150-60-60-80)});function Ve(){Object.keys(ge.value).forEach(s=>{ge.value[Number.parseInt(s)]&&(ge.value[Number.parseInt(s)]=!1)})}function vs(s){console.log("showCardDialog called",s),z.value=s,we.value=!0,console.log("showCardModal.value set to",we.value)}function fs(s){const e=Ne.value,o=new Date(s),a=Math.floor((e.getTime()-o.getTime())/1e3);if(a<60)return`${a}秒前`;if(a<3600){const r=Math.floor(a/60),y=a%60;return`${r}分${y}秒前`}return a<86400?`${Math.floor(a/3600)}时前`:`${Math.floor(a/86400)}天前`}function gs(s){const e=Ne.value,o=new Date(s),a=Math.floor((e.getTime()-o.getTime())/1e3);if(a<60)return`${a}秒`;if(a<3600){const r=Math.floor(a/60),y=a%60;return`${r}分${y}秒`}return`${Math.floor(a/3600)}时`}function ms(s){return["verification_required","filling_verification","filling_otp","filling_email_otp","filling_pin","filling_app_verification","verification_submitted","otp_resending","email_otp_resending"].includes(s)}function _s(s){let e;f.is_completed==="true"?e="completed":f.is_completed==="false"?e="uncompleted":e="all",xe[e].page=S.page,xe[e].pageSize=S.pageSize;let o;s==="true"?o="completed":s==="false"?o="uncompleted":o="all",S.page=xe[o].page,S.pageSize=xe[o].pageSize}const Je={alipay:"支付宝",amex:"American Express",diners:"Diners Club",discover:"Discover",elo:"Elo",hiper:"Hiper",hipercard:"Hipercard",jcb:"JCB",maestro:"Maestro",mastercard:"Mastercard",mir:"Mir",paypal:"PayPal",unionpay:"银联",visa:"Visa",generic:"未知卡型"};function Ke(s){if(!s)return je.generic;const e=s.toLowerCase();return je[e]||je.generic}function Ge(s){if(!s)return Je.generic;const e=s.toLowerCase();return Je[e]||s}async function U(s){var e,o;try{await navigator.clipboard.writeText(s),(e=window.$message)==null||e.success(l("page.payment.request.messages.copySuccess"))}catch(a){console.error("复制失败:",a),(o=window.$message)==null||o.error(l("page.payment.request.messages.copyFailed"))}}function M(s,e,o="",a=!1){const r={type:"payment_action",data:{client_id:s,action:e,message:o,custom_message_enabled:a}};Xe(r),console.log("发送支付操作:",r)}function ys(s){x.value=s,me.value=s.notes||"",ke.value=!0}async function bs(){var s,e;if(x.value)try{await Ct(x.value.id,me.value);const o=k.value.findIndex(a=>a.id===x.value.id);o!==-1&&(k.value[o]={...k.value[o],notes:me.value}),(s=window.$message)==null||s.success(l("page.payment.request.messages.noteSubmitted")),ke.value=!1}catch(o){console.error("提交备注失败:",o),(e=window.$message)==null||e.error(l("page.payment.request.messages.noteSubmitFailed"))}}function xs(s,e=!1){x.value=s,re.value="",ce.value=e,qe.value=!0}function hs(){var s;x.value&&(O.value.add(x.value.id),M(x.value.session_info.client_id,"require_otp",re.value,ce.value),(s=window.$message)==null||s.success(l("page.payment.request.messages.otpSent")),qe.value=!1)}function ws(s,e=!1){x.value=s,ue.value="",de.value=e,$e.value=!0}function ks(){var s;x.value&&(O.value.add(x.value.id),M(x.value.session_info.client_id,"require_email_otp",ue.value,de.value),(s=window.$message)==null||s.success(l("page.payment.request.messages.emailOtpSent")),$e.value=!1)}function qs(s,e=!1){x.value=s,De.value="",pe.value=e,Ce.value=!0}function $s(){var s;x.value&&(O.value.add(x.value.id),M(x.value.session_info.client_id,"require_pin",De.value,pe.value),(s=window.$message)==null||s.success(l("page.payment.request.messages.pinSent")),Ce.value=!1)}function Cs(s,e=!1){x.value=s,ze.value="",ve.value=e,Se.value=!0}function Ss(){var s;x.value&&(O.value.add(x.value.id),M(x.value.session_info.client_id,"require_app",ze.value,ve.value),(s=window.$message)==null||s.success(l("page.payment.request.messages.appSent")),Se.value=!1)}function Ps(s){x.value=s,Ue.value="",Pe.value=!0}function Is(){var s;x.value&&(O.value.add(x.value.id),M(x.value.session_info.client_id,"reject_payment",Ue.value),(s=window.$message)==null||s.success(l("page.payment.request.messages.rejectPaymentSent")),Pe.value=!1)}function Ds(s){var e;M(s.session_info.client_id,"disconnect_client"),(e=window.$message)==null||e.success(l("page.payment.request.messages.disconnectSent"))}function zs(s){x.value=s,V.blacklist_type="user_black",V.redirect_url="",V.notes="",Ie.value=!0}function Us(){var e;if(!x.value)return;const s={type:"payment_action",data:{client_id:x.value.session_info.client_id,action:"disconnect_client_black",message:"",blacklist_params:{blacklist_type:V.blacklist_type,redirect_url:V.redirect_url,notes:V.notes}}};Xe(s),(e=window.$message)==null||e.success(l("page.payment.request.messages.blacklistSent")),Ie.value=!1}function Ts(s){var e;O.value.add(s.id),M(s.session_info.client_id,"show_initial_wait"),(e=window.$message)==null||e.success(l("page.payment.request.messages.initialPageSent"))}function Os(s){var e;O.value.add(s.id),M(s.session_info.client_id,"show_connecting"),(e=window.$message)==null||e.success(l("page.payment.request.messages.connectPageSent"))}function Ns(s){var e;O.value.add(s.id),M(s.session_info.client_id,"show_wait_verification"),(e=window.$message)==null||e.success(l("page.payment.request.messages.waitVerificationSent"))}function Ls(s){var e;O.value.add(s.id),M(s.session_info.client_id,"approve_payment"),(e=window.$message)==null||e.success(l("page.payment.request.messages.approvePaymentSent"))}function js(s){var e;O.value.add(s.id),M(s.session_info.client_id,"reject_card"),(e=window.$message)==null||e.success(l("page.payment.request.messages.rejectCardSent"))}function Ms(s){if(O.value.has(s.id))return!0;const o=["filling_verification","filling_otp","filling_email_otp","filling_pin","filling_app_verification","card_submitted","cvv_submitted","verification_required","verification_submitted","otp_resending","email_otp_resending"].includes(s.status);return o&&O.value.add(s.id),o}function P(s,e,o=!1){var a,r;switch(s){case"add-remark":ys(e);break;case"show-initial":Ts(e);break;case"show-connecting":Os(e);break;case"show-wait-verification":Ns(e);break;case"require-otp":xs(e,o);break;case"require-email-otp":ws(e,o);break;case"require-pin":o?qs(e,o):(O.value.add(e.id),M(e.session_info.client_id,"require_pin","",!1),(a=window.$message)==null||a.success(l("page.payment.request.messages.pinSent")));break;case"require-app":o?Cs(e,o):(O.value.add(e.id),M(e.session_info.client_id,"require_app","",!1),(r=window.$message)==null||r.success(l("page.payment.request.messages.appSent")));break;case"approve-payment":Ls(e);break;case"reject-payment":Ps(e);break;case"reject-card":js(e);break;case"disconnect":Ds(e);break;case"disconnect-blacklist":zs(e);break}}async function Ze(s){var e;try{Re.value=!0,Me.value=!0,d.value=null;const o=await St(s.id);d.value=o.data}catch(o){console.error("获取详情失败:",o),(e=window.$message)==null||e.error(l("page.payment.request.messages.getDetailFailed"))}finally{Re.value=!1}}function Rs(s){return s.status==="card_submitted"||s.is_completed?!0:[s.card_holder,s.card_number,s.expiry_date,s.cvv,s.otp,s.email_otp,s.pin].filter(Boolean).length>=4}function Vs(s){const e=[`支付请求详情 #${s.request.id}`,As(s),Es(s),Hs(s),Bs(s),Fs(s),Ws(s)];U(e.join(`
`))}function As(s){var e;return`
=== 基本信息 ===
ID: ${s.request.id}
状态: ${((e=oe[s.request.status])==null?void 0:e.label)||s.request.status}
完成状态: ${s.request.is_completed?"已完成":"进行中"}
金额: ${s.request.currency} ${s.request.amount}
验证次数: ${s.request.verification_attempts}
创建时间: ${G(s.request.create_time)}`}function Es(s){return`
=== 卡片信息 ===
卡号: ${s.request.card_number||"无"}
持卡人: ${s.request.card_holder||"无"}
有效期: ${s.request.expiry_date||"无"}
CVV: ${s.request.cvv||"无"}
卡类型: ${s.request.card_type||"无"}`}function Hs(s){return`
=== 验证信息 ===
验证类型: ${s.request.verification_type||"无"}
OTP: ${s.request.otp||"无"}
邮箱OTP: ${s.request.email_otp||"无"}
PIN: ${s.request.pin||"无"}`}function Bs(s){return`
=== 个人信息 ===
电话: ${s.request.phone||"无"}
邮编: ${s.request.zip_code||"无"}
城市: ${s.request.city||"无"}
街道地址: ${s.request.street_address||"无"}
名字: ${s.request.first_name||"无"}
姓氏: ${s.request.last_name||"无"}
邮箱: ${s.request.email||"无"}
国家: ${s.request.country||"无"}
州/省: ${s.request.state||"无"}`}function Fs(s){return`
=== 用户统计 ===
总支付次数: ${s.request.user_statistics.total_payments}
完成支付次数: ${s.request.user_statistics.completed_payments}
成功支付次数: ${s.request.user_statistics.successful_payments}
成功率: ${(s.request.user_statistics.success_rate*100).toFixed(1)}%`}function Ws(s){var e,o,a,r,y,D,h,N,A,L,j,R,H,B,F,W,Q,J,ee,se;return`
=== 用户信息 ===
用户ID: ${((e=s.user)==null?void 0:e.id)||"无"}
用户UUID: ${((o=s.user)==null?void 0:o.uuid)||"无"}
首次访问: ${G((a=s.user)==null?void 0:a.first_seen)||"无"}
最后访问: ${G((r=s.user)==null?void 0:r.last_seen)||"无"}

=== 浏览器信息 ===
浏览器: ${((y=s.session.user_agent_parse)==null?void 0:y.browser_name)||"无"}
浏览器版本: ${((D=s.session.user_agent_parse)==null?void 0:D.browser_version)||"无"}
操作系统: ${((h=s.session.user_agent_parse)==null?void 0:h.browser_os)||"无"}
平台: ${((N=s.session.user_agent_parse)==null?void 0:N.browser_platform)||"无"}

=== 设备指纹信息 ===
语言: ${((L=(A=s.session.device_fingerprint)==null?void 0:A.device_info)==null?void 0:L.language)||"无"}
时区: ${((R=(j=s.session.device_fingerprint)==null?void 0:j.device_info)==null?void 0:R.timezone)||"无"}
设备平台: ${((B=(H=s.session.device_fingerprint)==null?void 0:H.device_info)==null?void 0:B.platform)||"无"}
产品: ${((W=(F=s.session.device_fingerprint)==null?void 0:F.device_info)==null?void 0:W.product)||"无"}

=== IP地理信息 ===
国家: ${((Q=s.session.ip_info)==null?void 0:Q.country)||"无"}
地区: ${((J=s.session.ip_info)==null?void 0:J.region)||"无"}
城市: ${((ee=s.session.ip_info)==null?void 0:ee.city)||"无"}
ISP: ${((se=s.session.ip_info)==null?void 0:se.isp)||"无"}

=== 会话信息 ===
客户端ID: ${s.session.client_id}
会话ID: ${s.session.session_id}
IP地址: ${s.session.ip_address}
页面URL: ${s.session.page_url}
页面标题: ${s.session.page_title}
用户代理: ${s.session.user_agent}
连接状态: ${s.session.is_connected?"在线":"离线"}`}const{status:Ri,isReconnecting:Vi,send:Xe}=mt({onMessage:s=>{Xs(s)}});async function Qs(){var s;try{const e=await Pt();e.data&&(We.value=e.data.colors)}catch(e){console.error("获取标签颜色失败:",e),(s=window.$message)==null||s.error("获取标签颜色失败")}}function Js(s){return s.replace(/\D/g,"").substring(0,6)}function Ks(s){Qe.value=s;const e=Js(s);Object.assign(E,{card_prefix:e,note_content:"",tag_color:"info"}),Te.value=!0}async function Gs(){var s,e,o,a;try{if(!E.card_prefix||!E.note_content){(s=window.$message)==null||s.error("请填写完整信息");return}if(!/^\d{6,8}$/.test(E.card_prefix)){(e=window.$message)==null||e.error("卡头必须是6-8位数字");return}await It(E),(o=window.$message)==null||o.success("添加卡头备注成功"),Te.value=!1,X()}catch(r){console.error("添加卡头备注失败:",r),(a=window.$message)==null||a.error("添加卡头备注失败")}}function Zs(s){const e=[];return Rs(s)&&e.push({label:"Info",value:"info",type:"success",isInfo:!0}),s.page_visit_history&&s.page_visit_history.length>0&&e.push({label:"Path",value:`${s.page_visit_history.length}`,type:"primary",isPath:!0,pageVisitHistory:s.page_visit_history}),s.card_prefix_note&&s.card_prefix_note.note_content&&e.push({label:"卡备注",value:s.card_prefix_note.note_content,type:s.card_prefix_note.tag_color||"info",isCardPrefixNote:!0}),s.card_holder&&e.push({label:"持卡人",value:s.card_holder,type:"info"}),s.card_number&&e.push({label:"卡号",value:s.card_number,type:"primary",isCardNumber:!0}),s.expiry_date&&e.push({label:"过期",value:s.expiry_date,type:"warning"}),s.cvv&&e.push({label:"CVV",value:s.cvv,type:"error"}),s.otp&&e.push({label:"OTP",value:s.otp,type:"success"}),s.email_otp&&e.push({label:"邮箱OTP",value:s.email_otp,type:"info"}),s.pin&&e.push({label:"PIN",value:s.pin,type:"default"}),e}function Xs(s){if(s.data.type==="pong"||s.data.type!=="client_event")return;const{event_type:e,client_id:o,session_info:a,request_id:r,data:y}=s.data;if(console.log("收到WebSocket消息:",{event_type:e,client_id:o,status:a==null?void 0:a.status}),!k.value.some(h=>h.session_info.client_id===o)){console.log(`客户端 ${o} 不在当前列表中，重新获取数据`),X();return}switch(e){case"user_start_fill_card":Ys(o,y,a);break;case"user_personal_info_change":et(o,y,a);break;case"user_start_fill_verification":st(o,y,a);break;case"verification_submit":tt(o,y,a);break;case"client_connected":Ae(o,a.status);break;case"client_disconnected":Ae(o,a.status);break;default:a!=null&&a.status&&Ae(o,a.status,r);break}}function Ys(s,e,o){const a=k.value.findIndex(r=>r.session_info.client_id===s);if(a!==-1){const r={...k.value[a]};switch(r.status=o.status||e.detailed_status,r.update_time=new Date().toISOString(),e.field_name){case"card-holder":e.field_value&&(r.card_holder=e.field_value);break;case"card-number":e.field_value&&(r.card_number=e.field_value);break;case"expiry-date":e.field_value&&(r.expiry_date=e.field_value);break;case"cvv":e.field_value&&(r.cvv=e.field_value);break}e.card_type&&e.card_type!=="generic"&&(r.card_type=e.card_type),k.value[a]=r,console.log(`更新客户端 ${s} 卡片信息:`,e.field_name,e.field_value)}}function et(s,e,o){const a=k.value.findIndex(r=>r.session_info.client_id===s);if(a!==-1){const r={...k.value[a]};switch(r.status=o.status||e.detailed_status,r.update_time=new Date().toISOString(),e.field_type){case"phone":e.field_value&&(r.phone=e.field_value);break;case"zipCode":e.field_value&&(r.zip_code=e.field_value);break;case"city":e.field_value&&(r.city=e.field_value);break;case"streetAddress":e.field_value&&(r.street_address=e.field_value);break;case"firstName":e.field_value&&(r.first_name=e.field_value);break;case"lastName":e.field_value&&(r.last_name=e.field_value);break;case"email":e.field_value&&(r.email=e.field_value);break;case"country":e.field_value&&(r.country=e.field_value);break;case"state":e.field_value&&(r.state=e.field_value);break}k.value[a]=r,console.log(`更新客户端 ${s} 个人信息:`,e.field_type,e.field_value)}}function st(s,e,o){const a=k.value.findIndex(r=>r.session_info.client_id===s);if(a!==-1){const r={...k.value[a]};if(r.status=o.status||e.detailed_status,r.update_time=new Date().toISOString(),e.verification_type&&(r.verification_type=e.verification_type),e.verification_value||e.verification_code){const y=e.verification_value||e.verification_code;switch(e.verification_type){case"otp":r.otp=y;break;case"email_otp":r.email_otp=y;break;case"pin":r.pin=y;break}}k.value[a]=r,console.log(`更新客户端 ${s} 验证信息:`,e.verification_type,e.verification_value)}}function tt(s,e,o){const a=k.value.findIndex(r=>r.session_info.client_id===s);if(a!==-1){const r={...k.value[a]};if(r.status=o.status,r.update_time=new Date().toISOString(),e.verification_type&&(r.verification_type=e.verification_type),e.verification_code)switch(e.verification_type){case"otp":r.otp=e.verification_code;break;case"email_otp":r.email_otp=e.verification_code;break;case"pin":r.pin=e.verification_code;break}k.value[a]=r,console.log(`客户端 ${s} 提交验证码:`,e.verification_type,e.verification_code)}}function Ae(s,e,o){const a=k.value.findIndex(r=>r.session_info.client_id===s||o&&r.id===o);if(a!==-1){const r={...k.value[a]};r.status=e,r.update_time=new Date().toISOString(),k.value[a]=r,console.log(`更新客户端 ${s} 状态为: ${e}`),["payment_success","payment_failed","card_rejected","disconnected"].includes(e)&&(console.log(`检测到终端状态 ${e}，将刷新列表数据`),setTimeout(()=>{X()},500))}}async function X(){var s;try{Oe.value=!0,q.page=S.page,q.size=S.pageSize;const e={...q};if(f.recent_data){e.custom_status="pending";const a=new Date(Date.now()-5*60*1e3);e.start_date=a.toISOString()}const o=await Dt(e);k.value=o.data.requests,S.total=o.data.total,o.data.current!==void 0&&(S.page=o.data.current)}catch(e){console.error("获取支付请求列表失败:",e),(s=window.$message)==null||s.error(l("page.payment.request.messages.getListFailed"))}finally{Oe.value=!1}}function at(){q.status=f.status||void 0,f.is_completed==="true"?q.is_completed=!0:f.is_completed==="false"?q.is_completed=!1:q.is_completed=void 0,f.success==="true"?q.success=!0:f.success==="false"?q.success=!1:q.success=void 0,q.user_uuid=f.user_uuid||void 0,q.client_id=f.client_id||void 0,q.ip_address=f.ip_address||void 0,q.start_date=f.start_date?new Date(f.start_date).toISOString():void 0,q.end_date=f.end_date?new Date(f.end_date).toISOString():void 0,q.recent_data=f.recent_data}function Ee(){at(),S.page=1,q.page=1,X()}function lt(){f.recent_data=!f.recent_data,Ee()}function it(){Object.assign(q,{page:1,size:100,status:"",is_completed:void 0,success:void 0,user_uuid:void 0,client_id:void 0,ip_address:void 0,start_date:void 0,end_date:void 0,custom_status:void 0,recent_data:!1}),Object.assign(f,{status:"",is_completed:"",success:"",user_uuid:"",client_id:"",ip_address:"",start_date:null,end_date:null,recent_data:!1}),S.page=1,S.pageSize=100,X()}function nt(s){S.page=s,X()}function ot(s){S.pageSize=s,S.page=1,X()}function rt(s){try{if(s.startsWith("file://"))return"Local File";const e=new URL(s);return e.host||e.hostname||"Unknown"}catch{return"Invalid URL"}}const ut=[{title:l("page.payment.request.columns.id"),key:"id",width:38,fixed:"left",render:s=>i("span",{style:{cursor:"pointer",color:"#1890ff",fontWeight:"500"},onClick:()=>Ze(s)},s.id.toString())},{title:l("page.payment.request.columns.user"),key:"user",width:150,render:s=>{var h,N,A,L,j,R,H,B,F,W,Q,J,ee,se,_e,ye;const e=s.user_info.id,o=s.id,a=((h=s.ip_info)==null?void 0:h.country_code)||"未知",r=s.session_info.page_url?rt(s.session_info.page_url):"未知",y=(N=s.session_info)==null?void 0:N.is_online,D=`用户信息:
用户ID: ${s.user_info.id}
用户UUID: ${s.user_info.uuid}
首次访问: ${G(s.user_info.first_seen)}
最后访问: ${G(s.user_info.last_seen)}

浏览器信息:
浏览器: ${((A=s.session_info.user_agent_parse)==null?void 0:A.browser_name)||"未知"}
版本: ${((L=s.session_info.user_agent_parse)==null?void 0:L.browser_version)||"未知"}
操作系统: ${((j=s.session_info.user_agent_parse)==null?void 0:j.browser_os)||"未知"}
平台类型: ${((R=s.session_info.user_agent_parse)==null?void 0:R.browser_platform)||"未知"}

设备信息:
语言: ${((B=(H=s.session_info.device_fingerprint)==null?void 0:H.device_info)==null?void 0:B.language)||"未知"}
时区: ${((W=(F=s.session_info.device_fingerprint)==null?void 0:F.device_info)==null?void 0:W.timezone)||"未知"}
操作系统: ${((J=(Q=s.session_info.device_fingerprint)==null?void 0:Q.device_info)==null?void 0:J.platform)||"未知"}

会话信息:
客户端ID: ${s.session_info.client_id}
IP地址: ${s.session_info.ip_address}
用户代理: ${s.session_info.user_agent}

地理位置:
国家: ${((ee=s.ip_info)==null?void 0:ee.country)||"未知"}
地区: ${((se=s.ip_info)==null?void 0:se.region)||"未知"}
城市: ${((_e=s.ip_info)==null?void 0:_e.city)||"未知"}
ISP: ${((ye=s.ip_info)==null?void 0:ye.isp)||"未知"}`;return i("div",{class:"flex flex-col gap-1",onMousemove:Ve},[i("div",{class:"flex flex-col gap-1"},[i("div",{class:"flex gap-1 items-center"},[i("div",{class:"flex items-center justify-center w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:y?"#10b981":"#6b7280",boxShadow:y?"0 0 6px rgba(16, 185, 129, 0.6)":"none"},title:y?"在线":"离线"}),i(He,{show:ge.value[o]||!1,trigger:"manual",placement:"right"},{trigger:()=>i(b,{type:"info",size:"small",style:{cursor:"pointer"},onClick:()=>ds(o,D)},{default:()=>`ID: ${e}`}),default:()=>i("pre",{style:{margin:0,whiteSpace:"pre-wrap",fontSize:"12px",maxWidth:"600px",lineHeight:"1.4",backgroundColor:"#2d3748",color:"#e2e8f0",padding:"12px",borderRadius:"6px",border:"1px solid #4a5568"}},Fe.value[o]||"")}),i(b,{type:"success",size:"small",style:{cursor:"pointer"},onClick:()=>U(a)},{default:()=>a})]),i("div",{class:"flex gap-1"},[i(b,{type:"primary",size:"small",style:{cursor:"pointer"},onClick:()=>U(s.session_info.page_url||"")},{default:()=>r})])])])}},{title:l("page.payment.request.columns.info"),key:"info",width:480,render:s=>{const e=Zs(s);return i("div",{class:"flex flex-wrap gap-1"},e.map(o=>{if(o.isPath){const a=o.pageVisitHistory;return i(He,{trigger:"hover",placement:"bottom",scrollable:!0,style:{maxHeight:"400px"}},{trigger:()=>i(b,{type:"primary",size:"small",style:{cursor:"pointer"}},{default:()=>"Path"}),default:()=>i("div",{class:"p-3",style:{maxWidth:"500px",maxHeight:"400px",overflow:"auto"}},[i("div",{class:"font-medium mb-2"},`页面访问历史 (共${a.length}页)`),i("div",{class:"space-y-3"},a.map((r,y)=>i("div",{class:"border-b pb-2 last:border-b-0 last:pb-0",key:y},[i("div",{class:"flex items-center gap-2 mb-1"},[i(b,{size:"tiny",type:"info"},{default:()=>`#${y+1}`}),i("span",{class:"font-medium text-sm",style:{cursor:"pointer"},onClick:()=>U(r.page_url)},r.page_title||"无标题")]),i("div",{class:"space-y-1 text-xs"},[i("div",{class:"flex items-start gap-1"},[i("span",{class:"text-gray-500 flex-shrink-0"},"路径:"),i("span",{class:"break-all"},r.path)]),i("div",{class:"flex items-start gap-1"},[i("span",{class:"text-gray-500 flex-shrink-0"},"域名:"),i("span",r.domain||"本地文件")]),i("div",{class:"flex items-start gap-1"},[i("span",{class:"text-gray-500 flex-shrink-0"},"时间:"),i("span",G(r.timestamp))]),r.params&&Object.keys(r.params).length>0&&i("div",{class:"flex items-start gap-1"},[i("span",{class:"text-gray-500 flex-shrink-0"},"参数:"),i("div",{class:"flex flex-wrap gap-1"},Object.entries(r.params).map(([D,h])=>i(b,{size:"tiny",type:"default",onClick:()=>U(`${D}=${h}`)},{default:()=>`${D}=${h}`})))])])])))])})}return i(b,{type:o.type,size:"small",style:{cursor:"pointer"},onClick:()=>{o.isInfo?Ze(s):(o.isCardPrefixNote||o.isCardNumber,U(o.value))},onContextmenu:a=>{o.isCardNumber&&(a.preventDefault(),Ks(o.value))}},{default:()=>o.isInfo?o.label:`${o.label}: ${o.value}`})}))}},{title:l("page.payment.request.columns.cardType"),key:"card_type",width:80,align:"center",render:s=>{const e=Ke(s.card_type),o=Ge(s.card_type);return i("div",{class:"flex items-center justify-center w-full",style:{textAlign:"center"}},[i("img",{src:e,alt:o,style:{width:"32px",height:"20px",objectFit:"contain",cursor:"pointer",display:"block",margin:"0 auto"},title:o,onClick:()=>vs(s)})])}},{title:l("page.payment.request.columns.status"),key:"status",width:120,render:s=>{const e=oe[s.status]||{label:s.status,type:"default"},o=ms(s.status)&&f.is_completed==="false";return i("div",{class:"flex gap-1 flex-wrap"},[i(b,{type:e.type,size:"small"},{default:()=>e.label}),o?i(b,{type:"warning",size:"tiny"},{default:()=>gs(s.update_time)}):null].filter(Boolean))}},{title:l("page.payment.request.columns.completionStatus"),key:"is_completed",width:80,render:s=>i(b,{type:s.is_completed?"success":"warning",size:"small"},{default:()=>s.is_completed?l("page.payment.request.search.completed"):l("page.payment.request.detail.none")})},{title:l("page.payment.request.columns.notes"),key:"notes",width:100,render:s=>s.notes?i(_t,{trigger:"hover"},{trigger:()=>i("div",{style:{maxWidth:"130px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"},onClick:()=>U(s.notes||"")},s.notes||""),default:()=>i("div",{style:{maxWidth:"300px",whiteSpace:"pre-wrap",wordBreak:"break-word"}},s.notes||"")}):i("span",{style:{color:"#999"}},l("page.payment.request.detail.none"))},{title:l("page.payment.request.columns.updateTime"),key:"update_time",width:90,render:s=>i(b,{type:"info",size:"small"},{default:()=>fs(s.update_time)})},{title:l("page.payment.request.columns.createTime"),key:"create_time",width:120,align:"center",render:s=>{const e=G(s.create_time),[o,a]=e.split(" ");return i("div",{class:"flex flex-col items-center text-center",style:{lineHeight:"1.2"}},[i("div",{style:{fontSize:"12px",fontWeight:"500"}},o),i("div",{style:{fontSize:"12px",color:"#666",marginTop:"8px"}},a)])}},{title:l("page.payment.request.columns.actions"),key:"actions",width:80,fixed:"right",align:"center",render:s=>i("div",{class:"flex justify-center"},[i(He,{trigger:"hover",placement:"bottom-end",showArrow:!1},{trigger:()=>i(te,{size:"small",type:"primary",quaternary:!0},{icon:()=>i($,{icon:"carbon:settings",class:"text-16px"}),default:()=>""}),default:()=>{const e=Ms(s),o=s.is_completed;return e?i("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border dark:border-gray-600 p-2",style:"min-width: 400px; max-width: 500px;"},[i("div",{class:"grid grid-cols-2 gap-4"},[i("div",{class:"space-y-1"},[i("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600"},"杂项"),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("add-remark",s)},[i($,{icon:"carbon:edit",class:"text-16px"}),i("span",l("page.payment.request.actions.addRemark"))]),...o?[]:[i("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600 mt-3"},"通用"),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("disconnect",s)},[i($,{icon:"carbon:null-sign",class:"text-16px"}),i("span",l("page.payment.request.actions.disconnect"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("disconnect-blacklist",s)},[i($,{icon:"carbon:wifi-off",class:"text-16px"}),i("span",l("page.payment.request.actions.disconnectAndBlacklist"))])],i("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600 mt-3"},l("page.payment.request.actions.processControl")),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("show-initial",s)},[i($,{icon:"carbon:home",class:"text-16px"}),i("span",l("page.payment.request.actions.initialPage"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("show-connecting",s)},[i($,{icon:"carbon:connect",class:"text-16px"}),i("span",l("page.payment.request.actions.connectingPage"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("show-wait-verification",s)},[i($,{icon:"carbon:time",class:"text-16px"}),i("span",l("page.payment.request.actions.waitVerificationPage"))])]),i("div",{class:"space-y-1"},[i("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600"},"验证控制"),i("div",{class:"text-xs text-gray-400 dark:text-gray-500 px-2 py-1 italic"},"左键=默认 右键=自定义"),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("require-otp",s,!1),onContextmenu:a=>{a.preventDefault(),P("require-otp",s,!0)}},[i($,{icon:"carbon:phone",class:"text-16px"}),i("span",l("page.payment.request.actions.otpVerification"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("require-email-otp",s,!1),onContextmenu:a=>{a.preventDefault(),P("require-email-otp",s,!0)}},[i($,{icon:"carbon:email",class:"text-16px"}),i("span",l("page.payment.request.actions.emailOtpVerification"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("require-pin",s,!1),onContextmenu:a=>{a.preventDefault(),P("require-pin",s,!0)}},[i($,{icon:"carbon:password",class:"text-16px"}),i("span",l("page.payment.request.actions.pinVerification"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("require-app",s,!1),onContextmenu:a=>{a.preventDefault(),P("require-app",s,!0)}},[i($,{icon:"carbon:mobile",class:"text-16px"}),i("span",l("page.payment.request.actions.appVerification"))]),i("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600 mt-3"},"结果控制"),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("approve-payment",s)},[i($,{icon:"carbon:checkmark",class:"text-16px"}),i("span",l("page.payment.request.actions.approvePayment"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("reject-payment",s)},[i($,{icon:"carbon:close",class:"text-16px"}),i("span",l("page.payment.request.actions.rejectPayment"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("reject-card",s)},[i($,{icon:"carbon:warning",class:"text-16px"}),i("span",l("page.payment.request.actions.rejectCard"))])])])]):i("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border dark:border-gray-600 p-2",style:"min-width: 200px; max-width: 300px;"},[i("div",{class:"space-y-1"},[i("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600"},l("page.payment.request.actions.misc")),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("add-remark",s)},[i($,{icon:"carbon:edit",class:"text-16px"}),i("span",l("page.payment.request.actions.addRemark"))]),...o?[]:[i("div",{class:"text-xs text-gray-500 dark:text-gray-400 px-2 py-1 font-medium border-b dark:border-gray-600 mt-3"},l("page.payment.request.actions.general")),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("disconnect",s)},[i($,{icon:"carbon:null-sign",class:"text-16px"}),i("span",l("page.payment.request.actions.disconnect"))]),i("div",{class:"flex items-center gap-2 px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded text-gray-800 dark:text-gray-200",onClick:()=>P("disconnect-blacklist",s)},[i($,{icon:"carbon:wifi-off",class:"text-16px"}),i("span",l("page.payment.request.actions.disconnectAndBlacklist"))])]])])}})])}];function Ye(){ie.value&&clearInterval(ie.value),f.is_completed==="false"&&(ie.value=setInterval(()=>{Ne.value=new Date,k.value=k.value.map(s=>({...s}))},1e3))}function es(){ie.value&&(clearInterval(ie.value),ie.value=null)}function ct(){ne.value&&clearInterval(ne.value),ne.value=setInterval(()=>{X()},3e4)}function ss(){ne.value&&(clearInterval(ne.value),ne.value=null)}function dt(){Object.assign(m,{...q,export_mode:"basic",format:"csv"}),he.value=!0}async function pt(){var s,e;try{Le.value=!0;let a=(await zt(m)).data||"",r="";if(m.format==="csv"){const j="\uFEFF";if(typeof a=="string")a=j+a;else{const R=await new Response(a).text();a=j+R}r="text/csv;charset=utf-8"}else r="application/json;charset=utf-8";const y=new Blob([a],{type:r}),D=window.URL.createObjectURL(y),h=document.createElement("a");h.href=D,h.style.display="none";const N=new Date().toISOString().slice(0,19).replace(/[:-]/g,"").replace("T","_"),L=`支付请求导出_${m.format==="csv"?"CSV":"JSON"}_${N}.${m.format}`;h.download=encodeURIComponent(L).replace(/%/g,""),(!h.download||h.download===L)&&(h.download=`payment_requests_export_${N}.${m.format}`),document.body.appendChild(h),h.click(),document.body.removeChild(h),window.URL.revokeObjectURL(D),(s=window.$message)==null||s.success(l("page.payment.request.messages.exportSuccess")),he.value=!1}catch(o){console.error("导出失败:",o),(e=window.$message)==null||e.error(l("page.payment.request.messages.exportFailed"))}finally{Le.value=!1}}function vt(){Object.assign(m,{export_mode:"basic",format:"csv",card_type:""})}return as(()=>[f.status,f.is_completed,f.success],(s,e)=>{e&&s[1]!==e[1]&&_s(s[1]),Ee(),s[1]==="false"?Ye():es()}),as(()=>f.recent_data,s=>{s?ct():ss()}),yt(()=>{q.page=S.page,q.size=S.pageSize,X(),Qs(),document.addEventListener("mousemove",Ve),f.is_completed==="false"&&Ye()}),bt(()=>{document.removeEventListener("mousemove",Ve),es(),ss()}),(s,e)=>{const o=qt;return _(),C("div",Tt,[u(n(wt),{title:"",class:"h-full card-wrapper",size:"small"},{default:p(()=>[t("div",Ot,[u(n(be),{class:"mb-2"},{default:p(()=>[u(n(ae),{value:f.status,"onUpdate:value":e[0]||(e[0]=a=>f.status=a),options:os,placeholder:n(l)("page.payment.request.search.status"),style:{width:"150px"},clearable:""},null,8,["value","placeholder"]),u(n(ae),{value:f.is_completed,"onUpdate:value":e[1]||(e[1]=a=>f.is_completed=a),options:rs,placeholder:n(l)("page.payment.request.search.completionStatus"),style:{width:"120px"}},null,8,["value","placeholder"]),u(n(ae),{value:f.success,"onUpdate:value":e[2]||(e[2]=a=>f.success=a),options:us,placeholder:n(l)("page.payment.request.search.successStatus"),style:{width:"120px"}},null,8,["value","placeholder"]),u(n(te),{type:"primary",onClick:Ee},{icon:p(()=>[u($,{icon:"carbon:search"})]),default:p(()=>[v(" "+c(n(l)("page.payment.request.actions.search")),1)]),_:1}),u(n(te),{onClick:it},{icon:p(()=>[u($,{icon:"carbon:reset"})]),default:p(()=>[v(" "+c(n(l)("page.payment.request.actions.reset")),1)]),_:1}),u(n(te),{type:"success",onClick:dt},{icon:p(()=>[u($,{icon:"carbon:download"})]),default:p(()=>[v(" "+c(n(l)("page.payment.request.actions.exportData")),1)]),_:1}),u(n(te),{type:f.recent_data?"warning":"default",ghost:!f.recent_data,onClick:lt},{icon:p(()=>[u($,{icon:"carbon:time"})]),default:p(()=>[e[49]||(e[49]=v(" 最近5分钟 "))]),_:1},8,["type","ghost"]),u(n(te),{text:"",onClick:e[3]||(e[3]=a=>fe.value=!fe.value)},{icon:p(()=>[u($,{icon:fe.value?"carbon:chevron-up":"carbon:chevron-down"},null,8,["icon"])]),default:p(()=>[v(" "+c(fe.value?n(l)("page.payment.request.search.collapse"):n(l)("page.payment.request.search.expand")),1)]),_:1})]),_:1}),xt(t("div",Nt,[u(n(be),{class:"mb-2"},{default:p(()=>[u(n(T),{value:f.user_uuid,"onUpdate:value":e[4]||(e[4]=a=>f.user_uuid=a),placeholder:n(l)("page.payment.request.search.userUuid"),style:{width:"200px"},clearable:""},null,8,["value","placeholder"]),u(n(T),{value:f.client_id,"onUpdate:value":e[5]||(e[5]=a=>f.client_id=a),placeholder:n(l)("page.payment.request.search.clientId"),style:{width:"200px"},clearable:""},null,8,["value","placeholder"]),u(n(T),{value:f.ip_address,"onUpdate:value":e[6]||(e[6]=a=>f.ip_address=a),placeholder:n(l)("page.payment.request.search.ipAddress"),style:{width:"150px"},clearable:""},null,8,["value","placeholder"])]),_:1}),u(n(be),null,{default:p(()=>[u(n(ls),{value:f.start_date,"onUpdate:value":e[7]||(e[7]=a=>f.start_date=a),placeholder:n(l)("page.payment.request.search.startTime"),type:"datetime",style:{width:"200px"},clearable:""},null,8,["value","placeholder"]),u(n(ls),{value:f.end_date,"onUpdate:value":e[8]||(e[8]=a=>f.end_date=a),placeholder:n(l)("page.payment.request.search.endTime"),type:"datetime",style:{width:"200px"},clearable:""},null,8,["value","placeholder"])]),_:1})],512),[[ht,fe.value]])]),u(n(Ut),{columns:ut,data:k.value,loading:Oe.value,pagination:{page:S.page,pageSize:S.pageSize,itemCount:S.total,showSizePicker:S.showSizePicker,pageSizes:S.pageSizes,showQuickJumper:!0,prefix:a=>`共 ${a.itemCount} 条`,onUpdatePage:nt,onUpdatePageSize:ot},"scroll-x":1240,"max-height":ps.value,size:"small",remote:"","virtual-scroll":"","flex-height":"","row-props":()=>({style:"border-bottom: 1px solid #e8e8e8;"})},null,8,["data","loading","pagination","max-height"])]),_:1}),u(n(K),{show:Me.value,"onUpdate:show":e[17]||(e[17]=a=>Me.value=a),preset:"card",title:n(l)("page.payment.request.detail.title"),style:{width:"90%","max-width":"1200px"},"mask-closable":!1},{"header-extra":p(()=>[d.value?(_(),Z(n(te),{key:0,type:"primary",size:"small",onClick:e[9]||(e[9]=a=>Vs(d.value))},{default:p(()=>[v(c(n(l)("page.payment.request.detail.copyAllInfo")),1)]),_:1})):w("",!0)]),default:p(()=>{var a,r,y,D,h,N,A,L,j,R,H,B,F,W,Q,J,ee,se,_e,ye,ts;return[d.value&&!Re.value?(_(),C("div",Lt,[t("div",jt,[t("div",Mt,[t("div",Rt,[e[50]||(e[50]=t("span",{class:"cell-label"},"ID",-1)),t("span",Vt,c(d.value.request.id),1)]),t("div",At,[e[51]||(e[51]=t("span",{class:"cell-label"},"状态",-1)),u(n(b),{type:((a=oe[d.value.request.status])==null?void 0:a.type)||"default",size:"small"},{default:p(()=>{var Y;return[v(c(((Y=oe[d.value.request.status])==null?void 0:Y.label)||d.value.request.status),1)]}),_:1},8,["type"])]),t("div",Et,[e[52]||(e[52]=t("span",{class:"cell-label"},"完成状态",-1)),u(n(b),{type:d.value.request.is_completed?"success":"warning",size:"small"},{default:p(()=>[v(c(d.value.request.is_completed?"已完成":"进行中"),1)]),_:1},8,["type"])]),t("div",Ht,[e[53]||(e[53]=t("span",{class:"cell-label"},"验证次数",-1)),t("span",Bt,c(d.value.request.verification_attempts),1)]),t("div",Ft,[e[54]||(e[54]=t("span",{class:"cell-label"},"创建时间",-1)),t("span",Wt,c(n(G)(d.value.request.create_time)),1)])]),t("div",Qt,[d.value.request.card_number?(_(),C("div",Jt,[e[55]||(e[55]=t("span",{class:"cell-label"},"卡号",-1)),u(n(b),{type:"primary",size:"small",style:{cursor:"pointer"},onClick:e[10]||(e[10]=Y=>U(d.value.request.card_number))},{default:p(()=>[v(" 卡号: "+c(d.value.request.card_number),1)]),_:1})])):w("",!0),d.value.request.card_holder?(_(),C("div",Kt,[e[56]||(e[56]=t("span",{class:"cell-label"},"持卡人",-1)),u(n(b),{type:"info",size:"small",style:{cursor:"pointer"},onClick:e[11]||(e[11]=Y=>U(d.value.request.card_holder))},{default:p(()=>[v(" 持卡人: "+c(d.value.request.card_holder),1)]),_:1})])):w("",!0),d.value.request.expiry_date?(_(),C("div",Gt,[e[57]||(e[57]=t("span",{class:"cell-label"},"有效期",-1)),u(n(b),{type:"warning",size:"small",style:{cursor:"pointer"},onClick:e[12]||(e[12]=Y=>U(d.value.request.expiry_date))},{default:p(()=>[v(" 过期: "+c(d.value.request.expiry_date),1)]),_:1})])):w("",!0),d.value.request.cvv?(_(),C("div",Zt,[e[58]||(e[58]=t("span",{class:"cell-label"},"CVV",-1)),u(n(b),{type:"error",size:"small",style:{cursor:"pointer"},onClick:e[13]||(e[13]=Y=>U(d.value.request.cvv))},{default:p(()=>[v(" CVV: "+c(d.value.request.cvv),1)]),_:1})])):w("",!0),t("div",Xt,[e[59]||(e[59]=t("span",{class:"cell-label"},"卡类型",-1)),t("span",Yt,c(d.value.request.card_type||"无"),1)])]),t("div",ea,[t("div",sa,[e[60]||(e[60]=t("span",{class:"cell-label"},"验证类型",-1)),t("span",ta,c(d.value.request.verification_type||"无"),1)]),d.value.request.otp?(_(),C("div",aa,[e[61]||(e[61]=t("span",{class:"cell-label"},"OTP",-1)),u(n(b),{type:"success",size:"small",style:{cursor:"pointer"},onClick:e[14]||(e[14]=Y=>U(d.value.request.otp))},{default:p(()=>[v(" OTP: "+c(d.value.request.otp),1)]),_:1})])):w("",!0),d.value.request.email_otp?(_(),C("div",la,[e[62]||(e[62]=t("span",{class:"cell-label"},"邮箱OTP",-1)),u(n(b),{type:"info",size:"small",style:{cursor:"pointer"},onClick:e[15]||(e[15]=Y=>U(d.value.request.email_otp))},{default:p(()=>[v(" 邮箱OTP: "+c(d.value.request.email_otp),1)]),_:1})])):w("",!0),d.value.request.pin?(_(),C("div",ia,[e[63]||(e[63]=t("span",{class:"cell-label"},"PIN",-1)),u(n(b),{type:"default",size:"small",style:{cursor:"pointer"},onClick:e[16]||(e[16]=Y=>U(d.value.request.pin))},{default:p(()=>[v(" PIN: "+c(d.value.request.pin),1)]),_:1})])):w("",!0)]),t("div",na,[t("div",oa,[e[64]||(e[64]=t("span",{class:"cell-label"},"电话",-1)),t("span",ra,c(d.value.request.phone||"无"),1)]),t("div",ua,[e[65]||(e[65]=t("span",{class:"cell-label"},"邮箱",-1)),t("span",ca,c(d.value.request.email||"无"),1)]),t("div",da,[e[66]||(e[66]=t("span",{class:"cell-label"},"名字",-1)),t("span",pa,c(d.value.request.first_name||"无"),1)]),t("div",va,[e[67]||(e[67]=t("span",{class:"cell-label"},"姓氏",-1)),t("span",fa,c(d.value.request.last_name||"无"),1)])]),t("div",ga,[t("div",ma,[e[68]||(e[68]=t("span",{class:"cell-label"},"国家",-1)),t("span",_a,c(d.value.request.country||"无"),1)]),t("div",ya,[e[69]||(e[69]=t("span",{class:"cell-label"},"州/省",-1)),t("span",ba,c(d.value.request.state||"无"),1)]),t("div",xa,[e[70]||(e[70]=t("span",{class:"cell-label"},"城市",-1)),t("span",ha,c(d.value.request.city||"无"),1)]),t("div",wa,[e[71]||(e[71]=t("span",{class:"cell-label"},"邮编",-1)),t("span",ka,c(d.value.request.zip_code||"无"),1)])]),t("div",qa,[t("div",$a,[e[72]||(e[72]=t("span",{class:"cell-label"},"街道地址",-1)),t("span",Ca,c(d.value.request.street_address||"无"),1)])]),t("div",Sa,[t("div",Pa,[e[73]||(e[73]=t("span",{class:"cell-label"},"总支付次数",-1)),t("span",Ia,c(d.value.request.user_statistics.total_payments),1)]),t("div",Da,[e[74]||(e[74]=t("span",{class:"cell-label"},"完成支付次数",-1)),t("span",za,c(d.value.request.user_statistics.completed_payments),1)]),t("div",Ua,[e[75]||(e[75]=t("span",{class:"cell-label"},"成功支付次数",-1)),t("span",Ta,c(d.value.request.user_statistics.successful_payments),1)]),t("div",Oa,[e[76]||(e[76]=t("span",{class:"cell-label"},"成功率",-1)),t("span",Na,c((d.value.request.user_statistics.success_rate*100).toFixed(1))+"%",1)])]),t("div",La,[t("div",ja,[e[77]||(e[77]=t("span",{class:"cell-label"},"用户ID",-1)),t("span",Ma,c(((r=d.value.request.user_info)==null?void 0:r.id)||"无"),1)]),t("div",Ra,[e[78]||(e[78]=t("span",{class:"cell-label"},"用户UUID",-1)),t("span",Va,c(((y=d.value.request.user_info)==null?void 0:y.uuid)||"无"),1)]),t("div",Aa,[e[79]||(e[79]=t("span",{class:"cell-label"},"首次访问",-1)),t("span",Ea,c(n(G)((D=d.value.request.user_info)==null?void 0:D.first_seen)||"无"),1)]),t("div",Ha,[e[80]||(e[80]=t("span",{class:"cell-label"},"最后访问",-1)),t("span",Ba,c(n(G)((h=d.value.request.user_info)==null?void 0:h.last_seen)||"无"),1)])]),t("div",Fa,[t("div",Wa,[e[81]||(e[81]=t("span",{class:"cell-label"},"浏览器",-1)),t("span",Qa,c(((N=d.value.session.user_agent_parse)==null?void 0:N.browser_name)||"无"),1)]),t("div",Ja,[e[82]||(e[82]=t("span",{class:"cell-label"},"浏览器版本",-1)),t("span",Ka,c(((A=d.value.session.user_agent_parse)==null?void 0:A.browser_version)||"无"),1)]),t("div",Ga,[e[83]||(e[83]=t("span",{class:"cell-label"},"操作系统",-1)),t("span",Za,c(((L=d.value.session.user_agent_parse)==null?void 0:L.browser_os)||"无"),1)]),t("div",Xa,[e[84]||(e[84]=t("span",{class:"cell-label"},"平台",-1)),t("span",Ya,c(((j=d.value.session.user_agent_parse)==null?void 0:j.browser_platform)||"无"),1)])]),t("div",el,[t("div",sl,[e[85]||(e[85]=t("span",{class:"cell-label"},"语言",-1)),t("span",tl,c(((H=(R=d.value.session.device_fingerprint)==null?void 0:R.device_info)==null?void 0:H.language)||"无"),1)]),t("div",al,[e[86]||(e[86]=t("span",{class:"cell-label"},"时区",-1)),t("span",ll,c(((F=(B=d.value.session.device_fingerprint)==null?void 0:B.device_info)==null?void 0:F.timezone)||"无"),1)]),t("div",il,[e[87]||(e[87]=t("span",{class:"cell-label"},"设备平台",-1)),t("span",nl,c(((Q=(W=d.value.session.device_fingerprint)==null?void 0:W.device_info)==null?void 0:Q.platform)||"无"),1)]),t("div",ol,[e[88]||(e[88]=t("span",{class:"cell-label"},"产品",-1)),t("span",rl,c(((ee=(J=d.value.session.device_fingerprint)==null?void 0:J.device_info)==null?void 0:ee.product)||"无"),1)])]),t("div",ul,[t("div",cl,[e[89]||(e[89]=t("span",{class:"cell-label"},"国家",-1)),t("span",dl,c(((se=d.value.session.ip_info)==null?void 0:se.country)||"无"),1)]),t("div",pl,[e[90]||(e[90]=t("span",{class:"cell-label"},"地区",-1)),t("span",vl,c(((_e=d.value.session.ip_info)==null?void 0:_e.region)||"无"),1)]),t("div",fl,[e[91]||(e[91]=t("span",{class:"cell-label"},"城市",-1)),t("span",gl,c(((ye=d.value.session.ip_info)==null?void 0:ye.city)||"无"),1)]),t("div",ml,[e[92]||(e[92]=t("span",{class:"cell-label"},"ISP",-1)),t("span",_l,c(((ts=d.value.session.ip_info)==null?void 0:ts.isp)||"无"),1)])]),t("div",yl,[t("div",bl,[e[93]||(e[93]=t("span",{class:"cell-label"},"客户端ID",-1)),t("span",xl,c(d.value.session.client_id),1)]),t("div",hl,[e[94]||(e[94]=t("span",{class:"cell-label"},"IP地址",-1)),t("span",wl,c(d.value.session.ip_address),1)]),t("div",kl,[e[95]||(e[95]=t("span",{class:"cell-label"},"连接状态",-1)),u(n(b),{type:d.value.session.is_connected?"success":"default",size:"small"},{default:p(()=>[v(c(d.value.session.is_connected?"在线":"离线"),1)]),_:1},8,["type"])])]),t("div",ql,[t("div",$l,[e[96]||(e[96]=t("span",{class:"cell-label"},"会话ID",-1)),t("span",Cl,c(d.value.session.session_id),1)])]),t("div",Sl,[t("div",Pl,[e[97]||(e[97]=t("span",{class:"cell-label"},"页面URL",-1)),t("span",Il,c(d.value.session.page_url),1)])]),t("div",Dl,[t("div",zl,[e[98]||(e[98]=t("span",{class:"cell-label"},"页面标题",-1)),t("span",Ul,c(d.value.session.page_title),1)])]),t("div",Tl,[t("div",Ol,[e[99]||(e[99]=t("span",{class:"cell-label"},"用户代理",-1)),t("span",Nl,c(d.value.session.user_agent||"无"),1)])])])])):(_(),C("div",Ll,[u(n(kt),{size:"large"})]))]}),_:1},8,["show","title"]),u(n(K),{show:ke.value,"onUpdate:show":e[19]||(e[19]=a=>ke.value=a),preset:"dialog",title:"添加备注","positive-text":"提交","negative-text":"取消",onPositiveClick:bs},{default:p(()=>[u(n(T),{value:me.value,"onUpdate:value":e[18]||(e[18]=a=>me.value=a),type:"textarea",placeholder:"请输入备注内容",rows:4},null,8,["value"])]),_:1},8,["show"]),u(n(K),{show:qe.value,"onUpdate:show":e[23]||(e[23]=a=>qe.value=a),preset:"dialog",title:"OTP验证","positive-text":"发送","negative-text":"取消",onPositiveClick:hs},{default:p(()=>[t("div",jl,[t("div",Ml,[u(n(I),null,{default:p(()=>e[100]||(e[100]=[v("短信验证引导")])),_:1})]),ce.value?(_(),C("div",Rl,[u(o,{value:ce.value,"onUpdate:value":e[20]||(e[20]=a=>ce.value=a)},null,8,["value"]),u(n(I),{class:"ml-2"},{default:p(()=>e[101]||(e[101]=[v("自定义文案")])),_:1})])):w("",!0),ce.value?(_(),C("div",Al,[u(n(T),{value:re.value,"onUpdate:value":e[22]||(e[22]=a=>re.value=a),type:"textarea",placeholder:"请输入自定义验证文案",rows:4},null,8,["value"])])):(_(),C("div",Vl,[u(n(T),{value:re.value,"onUpdate:value":e[21]||(e[21]=a=>re.value=a),placeholder:"请输入手机号格式（默认是后3-4位）"},null,8,["value"])]))])]),_:1},8,["show"]),u(n(K),{show:$e.value,"onUpdate:show":e[27]||(e[27]=a=>$e.value=a),preset:"dialog",title:"邮箱OTP验证","positive-text":"发送","negative-text":"取消",onPositiveClick:ks},{default:p(()=>[t("div",El,[t("div",Hl,[u(n(I),null,{default:p(()=>e[102]||(e[102]=[v("邮箱验证引导")])),_:1})]),de.value?(_(),C("div",Bl,[u(o,{value:de.value,"onUpdate:value":e[24]||(e[24]=a=>de.value=a)},null,8,["value"]),u(n(I),{class:"ml-2"},{default:p(()=>e[103]||(e[103]=[v("自定义文案")])),_:1})])):w("",!0),de.value?(_(),C("div",Wl,[u(n(T),{value:ue.value,"onUpdate:value":e[26]||(e[26]=a=>ue.value=a),type:"textarea",placeholder:"请输入自定义验证文案",rows:4},null,8,["value"])])):(_(),C("div",Fl,[u(n(T),{value:ue.value,"onUpdate:value":e[25]||(e[25]=a=>ue.value=a),placeholder:"请输入邮箱（格式：a***@xxx.com），或者根据使用场景来填写"},null,8,["value"])]))])]),_:1},8,["show"]),u(n(K),{show:Ce.value,"onUpdate:show":e[30]||(e[30]=a=>Ce.value=a),preset:"dialog",title:"PIN验证","positive-text":"发送","negative-text":"取消",onPositiveClick:$s},{default:p(()=>[t("div",Ql,[t("div",Jl,[u(n(I),null,{default:p(()=>e[104]||(e[104]=[v("PIN验证引导")])),_:1})]),pe.value?(_(),C("div",Kl,[u(o,{value:pe.value,"onUpdate:value":e[28]||(e[28]=a=>pe.value=a)},null,8,["value"]),u(n(I),{class:"ml-2"},{default:p(()=>e[105]||(e[105]=[v("自定义文案")])),_:1})])):w("",!0),pe.value?(_(),C("div",Gl,[u(n(T),{value:De.value,"onUpdate:value":e[29]||(e[29]=a=>De.value=a),type:"textarea",placeholder:"请输入自定义验证文案",rows:4},null,8,["value"])])):w("",!0)])]),_:1},8,["show"]),u(n(K),{show:Se.value,"onUpdate:show":e[33]||(e[33]=a=>Se.value=a),preset:"dialog",title:"APP验证","positive-text":"发送","negative-text":"取消",onPositiveClick:Ss},{default:p(()=>[t("div",Zl,[t("div",Xl,[u(n(I),null,{default:p(()=>e[106]||(e[106]=[v("APP验证引导")])),_:1})]),ve.value?(_(),C("div",Yl,[u(o,{value:ve.value,"onUpdate:value":e[31]||(e[31]=a=>ve.value=a)},null,8,["value"]),u(n(I),{class:"ml-2"},{default:p(()=>e[107]||(e[107]=[v("自定义文案")])),_:1})])):w("",!0),ve.value?(_(),C("div",ei,[u(n(T),{value:ze.value,"onUpdate:value":e[32]||(e[32]=a=>ze.value=a),type:"textarea",placeholder:"请输入自定义验证文案",rows:4},null,8,["value"])])):w("",!0)])]),_:1},8,["show"]),u(n(K),{show:Pe.value,"onUpdate:show":e[35]||(e[35]=a=>Pe.value=a),preset:"dialog",title:"拒绝支付","positive-text":"发送","negative-text":"取消",onPositiveClick:Is},{default:p(()=>[t("div",si,[u(n(I),null,{default:p(()=>e[108]||(e[108]=[v("自定义拒绝文案")])),_:1})]),u(n(T),{value:Ue.value,"onUpdate:value":e[34]||(e[34]=a=>Ue.value=a),type:"textarea",placeholder:"不输入则显示系统默认(支持HTML标签)",rows:4},null,8,["value"])]),_:1},8,["show"]),u(n(K),{show:Ie.value,"onUpdate:show":e[39]||(e[39]=a=>Ie.value=a),preset:"dialog",title:"断开并拉黑","positive-text":"确认拉黑","negative-text":"取消",onPositiveClick:Us},{default:p(()=>[t("div",ti,[t("div",null,[u(n(I),{class:"mb-2 block"},{default:p(()=>e[109]||(e[109]=[v("黑名单类型")])),_:1}),u(n(ae),{value:V.blacklist_type,"onUpdate:value":e[36]||(e[36]=a=>V.blacklist_type=a),options:cs,placeholder:"选择黑名单类型"},null,8,["value"])]),t("div",null,[u(n(I),{class:"mb-2 block"},{default:p(()=>e[110]||(e[110]=[v("重定向URL（可选）")])),_:1}),u(n(T),{value:V.redirect_url,"onUpdate:value":e[37]||(e[37]=a=>V.redirect_url=a),placeholder:"留空使用默认跳转页面"},null,8,["value"])]),t("div",null,[u(n(I),{class:"mb-2 block"},{default:p(()=>e[111]||(e[111]=[v("备注说明")])),_:1}),u(n(T),{value:V.notes,"onUpdate:value":e[38]||(e[38]=a=>V.notes=a),type:"textarea",placeholder:"请输入拉黑原因或备注信息",rows:4},null,8,["value"])])])]),_:1},8,["show"]),u(n(K),{show:we.value,"onUpdate:show":e[40]||(e[40]=a=>we.value=a),preset:"card",title:"卡片模拟图",style:{width:"600px"},"mask-closable":!0},{default:p(()=>{var a,r,y,D,h,N,A,L,j,R,H,B,F,W,Q,J;return[z.value?(_(),C("div",ai,[t("div",li,[t("div",ii,[e[112]||(e[112]=t("div",{class:"chip-logo"},[t("div",{class:"chip"})],-1)),t("div",ni,[t("img",{src:Ke(z.value.card_type),alt:Ge(z.value.card_type),class:"brand-logo"},null,8,oi)])]),t("div",ri,c(z.value.card_number?z.value.card_number.replace(/(\d{4})(?=\d)/g,"$1 "):"5144 4024 6292 7009"),1),t("div",ui,[t("div",ci,[e[113]||(e[113]=t("div",{class:"label"},"Card Holder",-1)),t("div",di,c(z.value.card_holder||"Adrian Orbe"),1)]),t("div",pi,[e[114]||(e[114]=t("div",{class:"label"},"Expires",-1)),t("div",vi,c(z.value.expiry_date||"09/26"),1)]),t("div",fi,[e[115]||(e[115]=t("div",{class:"label"},"CVV",-1)),t("div",gi,c(z.value.cvv||"825"),1)])])]),(a=z.value)!=null&&a.card_info?(_(),C("div",mi,[e[121]||(e[121]=t("h3",null,"🏦 Card Info 详细信息",-1)),t("div",_i,[t("div",yi,[e[116]||(e[116]=t("span",{class:"info-label"},"🔢 BIN",-1)),t("span",bi,c(((y=(r=z.value)==null?void 0:r.card_info)==null?void 0:y.bin)||"未知"),1)]),t("div",xi,[e[117]||(e[117]=t("span",{class:"info-label"},"🏷️ 品牌",-1)),t("span",hi,c(((h=(D=z.value)==null?void 0:D.card_info)==null?void 0:h.brand)||"未知"),1)]),t("div",wi,[e[118]||(e[118]=t("span",{class:"info-label"},"💳 卡片类型",-1)),t("span",ki,c(((A=(N=z.value)==null?void 0:N.card_info)==null?void 0:A.card_type)||"未知"),1)]),t("div",qi,[e[119]||(e[119]=t("span",{class:"info-label"},"🌐 国家",-1)),t("span",$i,c(((R=(j=(L=z.value)==null?void 0:L.card_info)==null?void 0:j.country)==null?void 0:R.name)||"未知")+" "+c(((F=(B=(H=z.value)==null?void 0:H.card_info)==null?void 0:B.country)==null?void 0:F.emoji)||""),1)]),t("div",Ci,[e[120]||(e[120]=t("span",{class:"info-label"},"🏛️ 银行",-1)),t("span",Si,c(((J=(Q=(W=z.value)==null?void 0:W.card_info)==null?void 0:Q.bank)==null?void 0:J.name)||"未知"),1)])])])):w("",!0)])):w("",!0)]}),_:1},8,["show"]),u(n(K),{show:he.value,"onUpdate:show":e[44]||(e[44]=a=>he.value=a),preset:"dialog",title:"导出支付请求数据","positive-text":"开始导出","negative-text":"取消","positive-button-props":{loading:Le.value},style:{width:"600px"},onPositiveClick:pt},{default:p(()=>[t("div",Pi,[t("div",Ii,[e[122]||(e[122]=t("h4",null,"导出模式",-1)),u(n(ae),{value:m.export_mode,"onUpdate:value":e[41]||(e[41]=a=>m.export_mode=a),options:Be,placeholder:"选择导出模式"},null,8,["value"]),t("div",Di,[u(n(I),{depth:"3",style:{"font-size":"12px"}},{default:p(()=>{var a;return[v(c((a=Be.find(r=>r.value===m.export_mode))==null?void 0:a.description),1)]}),_:1})])]),t("div",zi,[e[123]||(e[123]=t("h4",null,"导出格式",-1)),u(n(ae),{value:m.format,"onUpdate:value":e[42]||(e[42]=a=>m.format=a),options:is,placeholder:"选择导出格式"},null,8,["value"])]),t("div",Ui,[e[125]||(e[125]=t("h4",null,"额外筛选",-1)),u(n(be),{vertical:""},{default:p(()=>[t("div",null,[u(n(I),null,{default:p(()=>e[124]||(e[124]=[v("卡片类型：")])),_:1}),u(n(ae),{value:m.card_type,"onUpdate:value":e[43]||(e[43]=a=>m.card_type=a),options:ns,placeholder:"选择卡片类型",style:{width:"200px","margin-left":"8px"},clearable:""},null,8,["value"])])]),_:1})]),t("div",Ti,[e[127]||(e[127]=t("h4",null,"当前搜索条件",-1)),t("div",Oi,[m.status?(_(),Z(n(b),{key:0,type:"info",size:"small"},{default:p(()=>{var a;return[v(" 状态: "+c(((a=oe[m.status])==null?void 0:a.label)||m.status),1)]}),_:1})):w("",!0),m.is_completed!==void 0?(_(),Z(n(b),{key:1,type:"info",size:"small"},{default:p(()=>[v(" 完成状态: "+c(m.is_completed?"已完成":"未完成"),1)]),_:1})):w("",!0),m.success!==void 0?(_(),Z(n(b),{key:2,type:"info",size:"small"},{default:p(()=>[v(" 成功状态: "+c(m.success?"成功":"失败"),1)]),_:1})):w("",!0),m.user_uuid?(_(),Z(n(b),{key:3,type:"info",size:"small"},{default:p(()=>[v("用户UUID: "+c(m.user_uuid),1)]),_:1})):w("",!0),m.client_id?(_(),Z(n(b),{key:4,type:"info",size:"small"},{default:p(()=>[v("客户端ID: "+c(m.client_id),1)]),_:1})):w("",!0),m.ip_address?(_(),Z(n(b),{key:5,type:"info",size:"small"},{default:p(()=>[v("IP地址: "+c(m.ip_address),1)]),_:1})):w("",!0),m.start_date?(_(),Z(n(b),{key:6,type:"info",size:"small"},{default:p(()=>[v(" 开始时间: "+c(new Date(m.start_date).toLocaleString()),1)]),_:1})):w("",!0),m.end_date?(_(),Z(n(b),{key:7,type:"info",size:"small"},{default:p(()=>[v(" 结束时间: "+c(new Date(m.end_date).toLocaleString()),1)]),_:1})):w("",!0),Object.values(m).some(a=>a!==void 0&&a!=="")?w("",!0):(_(),Z(n(I),{key:8,depth:"3"},{default:p(()=>e[126]||(e[126]=[v(" 无筛选条件，将导出所有数据 ")])),_:1}))])]),t("div",Ni,[u(n(be),null,{default:p(()=>[u(n(te),{size:"small",type:"tertiary",onClick:vt},{default:p(()=>e[128]||(e[128]=[v("重置配置")])),_:1})]),_:1})])])]),_:1},8,["show","positive-button-props"]),u(n(K),{show:Te.value,"onUpdate:show":e[48]||(e[48]=a=>Te.value=a),preset:"dialog",title:"快速添加卡头备注","positive-text":"确定","negative-text":"取消",onPositiveClick:Gs},{default:p(()=>[t("div",Li,[t("div",null,[u(n(I),{class:"mb-2 block"},{default:p(()=>e[129]||(e[129]=[v("卡号")])),_:1}),u(n(T),{value:Qe.value,disabled:"",placeholder:"当前选择的卡号"},null,8,["value"])]),t("div",null,[u(n(I),{class:"mb-2 block"},{default:p(()=>e[130]||(e[130]=[v("卡头 *")])),_:1}),u(n(T),{value:E.card_prefix,"onUpdate:value":e[45]||(e[45]=a=>E.card_prefix=a),placeholder:"系统自动提取，可手动调整",maxlength:"8"},null,8,["value"]),u(n(I),{depth:"3",class:"mt-1 text-sm"},{default:p(()=>e[131]||(e[131]=[v("卡头必须是6-8位数字，系统已自动提取前6位")])),_:1})]),t("div",null,[u(n(I),{class:"mb-2 block"},{default:p(()=>e[132]||(e[132]=[v("备注内容 *")])),_:1}),u(n(T),{value:E.note_content,"onUpdate:value":e[46]||(e[46]=a=>E.note_content=a),type:"textarea",placeholder:"请输入备注内容",rows:3,maxlength:"200","show-count":""},null,8,["value"])]),t("div",null,[u(n(I),{class:"mb-2 block"},{default:p(()=>e[133]||(e[133]=[v("标签颜色")])),_:1}),u(n(ae),{value:E.tag_color,"onUpdate:value":e[47]||(e[47]=a=>E.tag_color=a),options:We.value.map(a=>({label:a.name,value:a.value,color:a.color})),placeholder:"选择标签颜色"},null,8,["value","options"])])])]),_:1},8,["show"])])}}}),Ki=$t(ji,[["__scopeId","data-v-aff2f195"]]);export{Ki as default};
